{"pageData":["course code, comp1521","course title, computer systems fundamentals","convenor, john shepherd","admin, wael alghamdi","classes, lectures tue 2-4 science th wed 4-6 mathews a timetable for all classes","consultations, tba","units of credit, 6","workload, in class lectures 3 hours/week tute/lab 3 hours/week outside class tute/lab 2 hours/week assignments 40 hours quizzes 5 hours ...","course website, http //cse.unsw.edu.au/ cs1521/","handbook entry, http //www.handbook.unsw.edu.au/undergraduate/courses/current/comp1521.html","graduate capability, acquired in","scholars capable of independent and collaborative enquiry rigorous in their analysis critique and reflection and able to innovate by applying their knowledge and skills to the solution of novel as well as routine problems, 1-9","entrepreneurial leaders capable of initiating and embracing innovation and change as well as engaging and enabling others to contribute to change, -","professionals capable of ethical self- directed practice and independent lifelong learning, -","global citizens who are culturally adept and capable of respecting diversity and acting in a socially just and responsible way, -","","a, outstanding effort must complete any challenges and go beyond the standard exercises","a, complete correct and clear solution to standard lab exercises worth full marks","b, most of the standard lab exercises completed or all completed but with one or more major bugs","c, partial solution only much of lab not completed or has many glaring errors","d, submitted something but it's completely hopeless",", ","item, topics, due, marks, los","quizzes, all topics, end of weeks 1 2 4 6 8 10, 10, 1-9","assignment 1, assembly programming, week 6, 9, 4","assignment 2, c programming, week 10, 11, 2 5","labs, most topics, all weeks, 10, 1-5 9","final exam, all topics, exam period, 60, 1-9","courseworkmark, , quizmark labmark ass1mark ass2mark, out of 40","exampracmark, , marks for prac questions on final exam, out of 30","examtheorymark, , marks for written questions on final exam, out of 30","exammark, , exampracmark examtheorymark, out of 60","examok, , exammark 24/60, true/false","finalmark, , courseworkmark exammark, out of 100","finalgrade, , uf if examok finalmark 50 fl if finalmark 50/100 ps if 50/100 finalmark 65/100 cr if 65/100 finalmark 75/100 dn if 75/100 finalmark 85/100 hd if finalmark 85/100, ","week, lectures, tutes, labs, assigns, quizzes","1, course intro computer systems queues stacks memory data representation, welcome c revision stacks queues bits, input/output, -, quiz 1","2, data representation cont, data representation i, bit manipulation, -, quiz 2","3, instruction set architecture assembly language programming, data representation ii, data representation floats, -, -","4, assembly language programming cont compilation mapping c to assembler, assembly language, assembly programming i, -, quiz 3","5, computer systems architecture layers operating systems system calls, mapping c to mips assembler, assembly programming ii, -, -","6, file systems memory management, oss system calls, system calls, ass1 due, quiz 4","7, virtual memory processes interrupts i/o, file system functions, file system functions, -, -","8, parallelism synchronisation coordination communication, virtual memory processes, signals, -, quiz 5","9, network architecture, parallelism concurrency, concurrent processes, -, -","mid -sem, -, -, -, -, -","10, spare, networks, sockets, ass2 due, quiz 6","11, spare, revision, practice prac exam, -, -","12, spare, revision, revision, -, -","comp9321","comp3900","comp9321\ncomp3900","profile settings logout","profile","settings","logout","profile settings logout\nprofile\nsettings\nlogout","profile","settings","logout","profile\nsettings\nlogout","home","q and a","course outline","course work","course notes","lectures","tutorials","lab classes","assignments","documentation","sample exams","videos","activities","help sessions","timetable","forums","groups","staff","john shepherd lecturer","jashank jeremy course admin","wael alghamdi course admin","jingling xue course admin","salil kanhere lecturer","michael yoo tutor","dylan brotherston tutor","james ye tutor","james o'brien tutor","ethan jones lab assistant","jason chu lab assistant","junjie lei lab assistant","minjie shen lab assistant","mitchell shelton lab assistant","aydin itil tutor","anna zhang tutor","gal aharon tutor","jesse colville tutor","nicholas hiebl tutor","harrison scott tutor","shanush prema thasarathan tutor","emmet murray tutor","joel nasrallah tutor","ellen oates tutor","simon shields tutor","oliver richards tutor","daniel li tutor","adam tanana lab assistant","austin tankiang lab assistant","caspian baska lab assistant","lance young lab assistant","kris choy lab assistant","nhat nguyen lab assistant","michael kedar lab assistant","marlene baquiran tutor","hayden le tutor","adam stucci tutor","carey li lab assistant","jake fitzgerald tutor","benjamin close lab assistant","vincent chen lab assistant","dean wunder lab assistant","connor o'shea lab assistant","kevin luxa lab assistant","zachary partridge lab assistant","heather cox lab assistant","tammy zhong lab assistant","angela finlayson tutor","benjamen lee tutor","addo wondo tutor","rimmal nadeem tutor","curtis millar tutor","tutors' weekly","tutors","tutor's page","w11b class info","f13b class info","course members","group types","roll generation","edit marks","view submissions","home\nq and a\ncourse outline\ncourse work\ncourse notes\nlectures\ntutorials\nlab classes\nassignments\ndocumentation\nsample exams\nvideos\nactivities\nhelp sessions\ntimetable\nforums\ngroups\nstaff\njohn shepherd lecturer\njashank jeremy course admin\nwael alghamdi course admin\njingling xue course admin\nsalil kanhere lecturer\nmichael yoo tutor\ndylan brotherston tutor\njames ye tutor\njames o'brien tutor\nethan jones lab assistant\njason chu lab assistant\njunjie lei lab assistant\nminjie shen lab assistant\nmitchell shelton lab assistant\naydin itil tutor\nanna zhang tutor\ngal aharon tutor\njesse colville tutor\nnicholas hiebl tutor\nharrison scott tutor\nshanush prema thasarathan tutor\nemmet murray tutor\njoel nasrallah tutor\nellen oates tutor\nsimon shields tutor\noliver richards tutor\ndaniel li tutor\nadam tanana lab assistant\naustin tankiang lab assistant\ncaspian baska lab assistant\nlance young lab assistant\nkris choy lab assistant\nnhat nguyen lab assistant\nmichael kedar lab assistant\nmarlene baquiran tutor\nhayden le tutor\nadam stucci tutor\ncarey li lab assistant\njake fitzgerald tutor\nbenjamin close lab assistant\nvincent chen lab assistant\ndean wunder lab assistant\nconnor o'shea lab assistant\nkevin luxa lab assistant\nzachary partridge lab assistant\nheather cox lab assistant\ntammy zhong lab assistant\nangela finlayson tutor\nbenjamen lee tutor\naddo wondo tutor\nrimmal nadeem tutor\ncurtis millar tutor\ntutors' weekly\ntutors\ntutor's page\nw11b class info\nf13b class info\ncourse members\ngroup types\nroll generation\nedit marks\nview submissions","course notes","lectures","tutorials","lab classes","assignments","documentation","sample exams","course notes\nlectures\ntutorials\nlab classes\nassignments\ndocumentation\nsample exams","john shepherd lecturer","jashank jeremy course admin","wael alghamdi course admin","jingling xue course admin","salil kanhere lecturer","michael yoo tutor","dylan brotherston tutor","james ye tutor","james o'brien tutor","ethan jones lab assistant","jason chu lab assistant","junjie lei lab assistant","minjie shen lab assistant","mitchell shelton lab assistant","aydin itil tutor","anna zhang tutor","gal aharon tutor","jesse colville tutor","nicholas hiebl tutor","harrison scott tutor","shanush prema thasarathan tutor","emmet murray tutor","joel nasrallah tutor","ellen oates tutor","simon shields tutor","oliver richards tutor","daniel li tutor","adam tanana lab assistant","austin tankiang lab assistant","caspian baska lab assistant","lance young lab assistant","kris choy lab assistant","nhat nguyen lab assistant","michael kedar lab assistant","marlene baquiran tutor","hayden le tutor","adam stucci tutor","carey li lab assistant","jake fitzgerald tutor","benjamin close lab assistant","vincent chen lab assistant","dean wunder lab assistant","connor o'shea lab assistant","kevin luxa lab assistant","zachary partridge lab assistant","heather cox lab assistant","tammy zhong lab assistant","angela finlayson tutor","benjamen lee tutor","addo wondo tutor","rimmal nadeem tutor","curtis millar tutor","john shepherd lecturer\njashank jeremy course admin\nwael alghamdi course admin\njingling xue course admin\nsalil kanhere lecturer\nmichael yoo tutor\ndylan brotherston tutor\njames ye tutor\njames o'brien tutor\nethan jones lab assistant\njason chu lab assistant\njunjie lei lab assistant\nminjie shen lab assistant\nmitchell shelton lab assistant\naydin itil tutor\nanna zhang tutor\ngal aharon tutor\njesse colville tutor\nnicholas hiebl tutor\nharrison scott tutor\nshanush prema thasarathan tutor\nemmet murray tutor\njoel nasrallah tutor\nellen oates tutor\nsimon shields tutor\noliver richards tutor\ndaniel li tutor\nadam tanana lab assistant\naustin tankiang lab assistant\ncaspian baska lab assistant\nlance young lab assistant\nkris choy lab assistant\nnhat nguyen lab assistant\nmichael kedar lab assistant\nmarlene baquiran tutor\nhayden le tutor\nadam stucci tutor\ncarey li lab assistant\njake fitzgerald tutor\nbenjamin close lab assistant\nvincent chen lab assistant\ndean wunder lab assistant\nconnor o'shea lab assistant\nkevin luxa lab assistant\nzachary partridge lab assistant\nheather cox lab assistant\ntammy zhong lab assistant\nangela finlayson tutor\nbenjamen lee tutor\naddo wondo tutor\nrimmal nadeem tutor\ncurtis millar tutor","tutor's page","w11b class info","f13b class info","course members","group types","roll generation","edit marks","view submissions","tutor's page\nw11b class info\nf13b class info\ncourse members\ngroup types\nroll generation\nedit marks\nview submissions","course details","course summary","assumed knowledge","learning outcomes","teaching strategies and rationale","student conduct","assessment","course schedule","resources for students","course evaluation and development","course details\ncourse summary\nassumed knowledge\nlearning outcomes\nteaching strategies and rationale\nstudent conduct\nassessment\ncourse schedule\nresources for students\ncourse evaluation and development","write simple programs in the c programming language","define and invoke functions and return results in c","define and manipulate structured data in c","use pointers to access data objects","write simple programs in the c programming language\ndefine and invoke functions and return results in c\ndefine and manipulate structured data in c\nuse pointers to access data objects","lectures ... introduce concepts show examples","tutorials ... reinforce concepts and provide additional examples","lab work ... provide examples of using various technologies","assignments .. allow you to solve larger problems","lectures ... introduce concepts show examples\ntutorials ... reinforce concepts and provide additional examples\nlab work ... provide examples of using various technologies\nassignments .. allow you to solve larger problems","submit your lab work by the following sunday 11 59pm","demonstrate your work to your tutor in the week x lab class or demonstrate your work at the start of the lab in week x 1","submit your lab work by the following sunday 11 59pm\ndemonstrate your work to your tutor in the week x lab class or demonstrate your work at the start of the lab in week x 1","assignment 1 submission week 6 worth 9","assignment 2 submission week 10 worth 11","assignment 1 submission week 6 worth 9\nassignment 2 submission week 10 worth 11","plagiarism and academic integrity","unsw plagiarism procedure","plagiarism and academic integrity\nunsw plagiarism procedure","unsw's policy regarding academic honesty and plagiarism","unsw's policy regarding academic honesty and plagiarism","student code policy","student misconduct procedure","plagiarism policy statement","plagiarism procedure","student code policy\nstudent misconduct procedure\nplagiarism policy statement\nplagiarism procedure","essential advice for cse students","essential advice for cse students","for an assignment you may be granted an extension","for a practice prac exam you may be granted an opportunity to take the exam later","for the final exam you may be offered a supplementary exam","for an assignment you may be granted an extension\nfor a practice prac exam you may be granted an opportunity to take the exam later\nfor the final exam you may be offered a supplementary exam","they cannot attend the final exam due to illness or misadventure or","their final mark is in the range 47 finalmark 50 or in this case finalmark is limited to 50","20 exammark 24 and finalmark 50 in this case finalmark is limited to 50","they cannot attend the final exam due to illness or misadventure or\ntheir final mark is in the range 47 finalmark 50 or in this case finalmark is limited to 50\n20 exammark 24 and finalmark 50 in this case finalmark is limited to 50","computer systems a programmer's perspective by randal e. bryant and david r. o'hallaron prentice-hall web site","computer systems a programmer's perspective by randal e. bryant and david r. o'hallaron prentice-hall web site","introduction to computer systems from bits and gates to c and beyond by yale n. patt and sanjay j. patel mcgraw hill","nand2tetris the elements of computing systems building a modern computer from first principles by noam nisan and shimon schocken mit press web site including lecture slides","introduction to computer systems from bits and gates to c and beyond by yale n. patt and sanjay j. patel mcgraw hill\nnand2tetris the elements of computing systems building a modern computer from first principles by noam nisan and shimon schocken mit press web site including lecture slides","toggle menu","this course introduces students to how computer systems are structured in terms of basic electronic components how they are used to implement procedural programs and how they are structured as a collection of software layers. it introduces students to low-level software layers such as operating systems and network infrastructure and introduces concurrency concepts. the goal is to give students a solid understanding of what happens when high-level programs are executed as a basis for further study in important areas of computing such as computer architecture operating systems and networks.","before commencing this course students should be able to ...","these are assumed to have been acquired in comp1511 or comp1911.","after completing this course students will be able to ...","this course contributes to the development of the following graduate capabilities","this course uses the standard set of practice-focussed teaching strategies employed by most cse foundational courses","having said that the second half of the course is discursive than other cse foundational courses.","this course is taught the way it is because it aims to give a broad view of many topics in computer systems to provide a foundation for further study in later systems-related courses. at the same time it provides further practice in developing software but at a level closer to the machine than other foundational courses.","lectures will be used to present the theory and practice of the techniques and tools in this course. the lectures will include practical demonstrations of various technologies. lecture notes will be available on the course web pages before each lecture.","from week 1 you will also be expected to attend a one-hour tutorial session to clarify ideas from lectures and work through exercises based on the lecture material. you should make sure that you use them effectively by examining in advance the material to be covered in each week's tutorial by asking questions by offering suggestions and by generally participating. the tutorial questions will be posted on the web in the week before each tutorial. there are no marks for tutorial attendance.","following the tutorial class each week there will be a two-hour laboratory class during which you will work on a variety of small practical problems involving the tools introduced in lectures. because this course is has a significant practical component laboratory classes are important . if you do not put a good amount of effort into the lab classes you risk failing the final exam.","each week there will be one or more exercises to work on. these exercises will be released in the week preceding the lab class. labs will be done in pairs and you and your lab partner should discuss the exercises before going to the lab to maximise the usefulness of the class. the exercises will need to be submitted and will be assessed by your tutor. during the lab your tutor will provide feedback on your approach to the problem and on the style of your solution.","tutors will facilitate you forming pairs in your week 1 lab. the pairs will change several times during the semester.","starting in week 2 pairs will also be asked to do code reviews in the tutorials to explain how they tackled a particular problem and describe interesting features of their solution.","to obtain a mark for a lab exercise you should as a pair demonstrate the completed lab exercise to your tutor during a lab class and both members of the pair should separately submit it using give .","you should normally get your lab work assessed during the week for which it is scheduled i.e. you must complete the week 3 lab exercise during the week 3 lab . if you don't finish it during the lab you may continue working on it during the week but you both must submit it using give by the following sunday 11 59pm in order to get any marks for it. you must then as a pair also demonstrate your work to your tutor during the first hour of the following week's lab. the code that you submit by sunday is what will be assessed.","summary to obtain any lab marks for the week x lab you must do 2 things","you cannot obtain marks by e-mailing lab work to tutors.","one of the labs will be used for a practice prac exam where you will use the exam environment to individually solve two small programming tasks one mips one c . you must complete the practice prac exam in the lab in the scheduled week.","lab exercises will be assessed using the following grade system","challenge exercises may be specified for some labs.","there will be more lab marks available than necessary to obtain full marks for the 10 lab component. in other words the total lab mark will be capped with a small bonus available for consistently outstanding work.","we expect all students to maintain a reflective blog during the semester starting week 1. this is useful for us to keep up with what you're doing but more importantly it is helpful for you to think about the improvement of your skills as the semester progresses and to think about how you'll do it better in the future.","up to 1 bonus mark is available for students who keep a regular insightful blog.","there are two assessable programming assignments. assignments give you the chance to practice what you have learnt on relatively large problems compared to the small exercises in the labs . assignments are a very important part of this course therefore it is essential that you attempt them yourself.","late assignments submissions will be penalized. the exact penalty will be specified in the assignment specification - around 1 reduction in maximum achievable mark for every hour late.","there will be a three-hour exam to be held in the cse labs during the exam period. this will be centrally timetabled and appear in your unsw exam timetable.","it will contain a mixture of implementation tasks which will require you to write c and assembler programs and theory questions which require analysis and written answers . during this exam you will be able to execute debug and test your answers. the implementation tasks will be similar to those encountered in lab exercises.","there is a hurdle requirement on the final exam. if you do not score at least 40 24/60 on the exam after scaling you cannot pass this course. if your overall course score exceeds 50 despite scoring very poorly 40 on the exam the hurdle will be enforced via a grade of uf.","if you cannot attend the final exam because of illness or misadventure then you must submit a special consideration request with documentation through myunsw within 48 hours of the exam. if your request is reasonable then you will be awarded a supplementary exam . there are two other conditions for being awarded a supplementary exam see below under assessment.","the student code of conduct information policy sets out what the university expects from students as members of the unsw community. as well as the learning teaching and research environment the university aims to provide an environment that enables students to achieve their full potential and to provide an experience consistent with the university s values and guiding principles. a condition of enrolment is that students inform themselves of the university s rules and policies affecting them and conduct themselves accordingly.","in particular students have the responsibility to observe standards of equity and respect in dealing with every member of the university community. this applies to all activities on unsw premises and all external activities related to study and research. this includes behaviour in person as well as behaviour on social media for example facebook groups set up for the purpose of discussing unsw courses or course work. behaviour that is considered in breach of the student code policy as discriminatory sexually inappropriate bullying harassing invading another s privacy or causing any person to fear for their personal safety is serious misconduct and can lead to severe penalties including suspension or exclusion from unsw.","if you have any concerns you may raise them with your lecturer or approach the school ethics officer grievance officer or one of the student representatives .","plagiarism is defined as using the words or ideas of others and presenting them as your own. unsw and cse treat plagiarism as academic misconduct which means that it carries penalties as severe as being excluded from further study at unsw. there are several on-line sources to help you understand what plagiarism is and how it is dealt with at unsw","make sure that you read and understand these. ignorance is not accepted as an excuse for plagiarism. in particular you are also responsible that your assignment files are not accessible by anyone but you by setting the correct permissions in your cse directory and code repository if using. note also that plagiarism includes paying or asking another person to do a piece of work for you and then submitting it as your own work.","unsw has an ongoing commitment to fostering a culture of learning informed by academic integrity. all unsw staff and students have a responsibility to adhere to this principle of academic integrity. plagiarism undermines academic integrity and is not tolerated at unsw. plagiarism at unsw is defined as using the words or ideas of others and passing them off as your own.","if you haven't done so yet please take the time to read the full text of","the pages below describe the policies and procedures in more detail","you should also read the following page which describes your rights and responsibilities in the cse context","if your work in this course is affected by unforseen adverse circumstances you should apply for special consideration through myunsw including documentation on how your have been affected. if your request is reasonable and your work has clearly been impacted then","note the use of the word may . none of the above is guaranteed. it depends on you making a convincing case that the circumstances have clearly impacted your ability to work.","if you are registered with disability services please forward your documentation to john shepherd within the first two weeks of semester.","each quiz is worth 2 marks. your total quiz mark is computed as a sum of your best 5 individual quiz marks.","lab marks vary. your total lab mark is computed by summing all of your lab marks and mapping into a mark out of 10. it is possible for your total lab mark to be 10/10 even if you miss one lab.","most labs are done in pairs but the practice prac exam is done individually.","your final mark for this course will be computed using the above assessments as follows","students are eligible for a supplementary exam if and only if","a supplementary exam will not be awarded for any other reason.","the following is a rough schedule of when topics will be covered. this will most likely change over the semester as topics take more or less time to cover.","there is no single text book that covers all of the material in this course at the right level of detail and using the same technology base as we are. the lecture notes should provide sufficient detail to introduce topics and you will then study them in further depth in the tutes labs and assignments.","there are also many online resources available and we will provide links to the most useful ones. some are listed below. if you find others please post links in the comments section on the course outline page.","the following is a recommended reading for this course","there are copies in the unsw bookstore and in the library. it covers many of the topics in the course but uses a different machine language i.e. not mips .","some suggestions for other books that cover at least some of the topics in this course","documentation for the various systems used in the course is linked from the course website.","this course ran for the first time in 17s2 and then ran in 18s1. the feedback from both offerings was generally positive. however the initial material on adts and linked structures proved challenging for students from comp1911. since linked structures do not feature prominently in systems-level code we will not discuss them.","the 18s1 offering ran in a 10-week unsw3 mode and there were no complaints about the pace of the course. we will trial a 10-week mode again in 18s2.","the course will be evaluated at the end of the semester using the myexperience system. however you are encouraged to provide feedback during the semester so that we can address any problems asap.","resource created thursday 19 july 2018 09 05 04 pm last modified thursday 09 august 2018 08 16 56 pm.","back to top","comp1521 18s2, assignment 1 scrolling text, computer system fundamentals","marks, 9 towards total course mark","group, this assignment is completed individually","due, by 11 59 59pm on sunday 2nd september","submit, give cs1521 assign1 scroll.s or via webcms","latepenalty, 0.08 marks per hour late approx 1.9 marks per day off the ceiling e.g. if you are 36 hours late your maximum possible mark is 6.1","assessment, for a guide to style use the code in the lectures and tute solutions and the supplied code. 5 marks for auto-testing on a range of input strings 2 marks for commenting the code you don't need a comment on every line but roughly one comment on each block of mips instructions that corresponds to a c statement 2 marks for readable code sensible names lining up the opcodes and the args consistently if your assembly code has syntax errors according to spim or run-time errors on all test cases your auto-testing mark is capped at 3/7 depending on an assessment by your tutor., 5 marks, for auto-testing on a range of input strings, 2 marks, for commenting the code you don't need a comment on every line but roughly one comment on each block of mips instructions that corresponds to a c statement, 2 marks, for readable code sensible names lining up the opcodes and the args consistently","5 marks, for auto-testing on a range of input strings","2 marks, for commenting the code you don't need a comment on every line but roughly one comment on each block of mips instructions that corresponds to a c statement","2 marks, for readable code sensible names lining up the opcodes and the args consistently","5 marks, for auto-testing on a range of input strings","2 marks, for commenting the code you don't need a comment on every line but roughly one comment on each block of mips instructions that corresponds to a c statement","2 marks, for readable code sensible names lining up the opcodes and the args consistently","main, partly complete including the epilogue and prologue and the command-line argument checking.","setupdisplay, function prologue and epilogue ok. todo function body.","showdisplay, function prologue and epilogue ok. todo function body.","delay, already complete but you can tweak the numbers if you want to speed up or slow down the animation.","isupper, todo function prologue and epilogue and function body.","islower, already complete and makes isupper very easy .","to give you experience writing mips assembly code","to give you experience with functions in mips","to give you experience with data and control structures in mips","to give you experience writing mips assembly code\nto give you experience with functions in mips\nto give you experience with data and control structures in mips","check the command-line argument 100 chars only letters and spaces","create a buffer containing big versions of the characters in argv 1","add part of the content of the big-char buffer into the display buffer starting at starting_pos","write the contents of the display buffer to standard output","repeat moving one column to the left each time until the message scrolls of the left of the display","check the command-line argument 100 chars only letters and spaces\ncreate a buffer containing big versions of the characters in argv 1\nadd part of the content of the big-char buffer into the display buffer starting at starting_pos\nwrite the contents of the display buffer to standard output\nrepeat moving one column to the left each time until the message scrolls of the left of the display","thestring 100 holds a copy of the string from argv 1","bigstring 9 1000 holds a copy of thestring in big characters and with one column of space between adjacent big characters","display 9 80 is where characters are placed before being written out to the screen","all_chars 52 9 9 array containing representation of 'a'-'z' and 'a'-'z' as big chars not shown in the diagram defined in the chars.s file","thestring 100 holds a copy of the string from argv 1\nbigstring 9 1000 holds a copy of thestring in big characters and with one column of space between adjacent big characters\ndisplay 9 80 is where characters are placed before being written out to the screen\nall_chars 52 9 9 array containing representation of 'a'-'z' and 'a'-'z' as big chars not shown in the diagram defined in the chars.s file","indicate which registers the function uses","indicate which registers the function overwrites clobbers","give a mapping between local variables in the c code and registers in mips","indicate which registers the function uses\nindicate which registers the function overwrites clobbers\ngive a mapping between local variables in the c code and registers in mips","2018-08-19 14 30 revision 1.5 in revision 1.3 one instance of ch was not moved. in all epilogues except delay $sp was reloaded with lw not la.","in revision 1.3 one instance of ch was not moved.","in all epilogues except delay $sp was reloaded with lw not la.","2018-08-18 18 50 revision 1.4 in main translation of break directive was incorrect at main_ch_ok 3 blt used instead of bge.","in main translation of break directive was incorrect at main_ch_ok 3 blt used instead of bge.","2018-08-18 17 20 revision 1.3 in main variable ch moved from register $t0 to $s2 with corresponding changes to stack frame. in main logic of calls to isupper islower and comparison with space was corrected.","in main variable ch moved from register $t0 to $s2 with corresponding changes to stack frame.","in main logic of calls to isupper islower and comparison with space was corrected.","2018-08-18 08 50 revision 1.2 in main argument load was done with la not lw.","in main argument load was done with la not lw.","2018-08-19 14 30 revision 1.5 in revision 1.3 one instance of ch was not moved. in all epilogues except delay $sp was reloaded with lw not la.\nin revision 1.3 one instance of ch was not moved.\nin all epilogues except delay $sp was reloaded with lw not la.\n2018-08-18 18 50 revision 1.4 in main translation of break directive was incorrect at main_ch_ok 3 blt used instead of bge.\nin main translation of break directive was incorrect at main_ch_ok 3 blt used instead of bge.\n2018-08-18 17 20 revision 1.3 in main variable ch moved from register $t0 to $s2 with corresponding changes to stack frame. in main logic of calls to isupper islower and comparison with space was corrected.\nin main variable ch moved from register $t0 to $s2 with corresponding changes to stack frame.\nin main logic of calls to isupper islower and comparison with space was corrected.\n2018-08-18 08 50 revision 1.2 in main argument load was done with la not lw.\nin main argument load was done with la not lw.","in revision 1.3 one instance of ch was not moved.","in all epilogues except delay $sp was reloaded with lw not la.","in revision 1.3 one instance of ch was not moved.\nin all epilogues except delay $sp was reloaded with lw not la.","in main translation of break directive was incorrect at main_ch_ok 3 blt used instead of bge.","in main translation of break directive was incorrect at main_ch_ok 3 blt used instead of bge.","in main variable ch moved from register $t0 to $s2 with corresponding changes to stack frame.","in main logic of calls to isupper islower and comparison with space was corrected.","in main variable ch moved from register $t0 to $s2 with corresponding changes to stack frame.\nin main logic of calls to isupper islower and comparison with space was corrected.","in main argument load was done with la not lw.","in main argument load was done with la not lw.","make the scroll repeat. if you wait until the whole message scrolls off the left hand end this is easy. make it do a continuous scroll where the message starts repeating from the right before when the end of the right-hand end of the message has moved 10 columns from the right-hand end of the display.","change the colours of the ' ' characters as they scroll. make the colour change as aesthetically pleasing as possible.","make the scroll repeat. if you wait until the whole message scrolls off the left hand end this is easy. make it do a continuous scroll where the message starts repeating from the right before when the end of the right-hand end of the message has moved 10 columns from the right-hand end of the display.\nchange the colours of the ' ' characters as they scroll. make the colour change as aesthetically pleasing as possible.","a common sight in shops is a grid of leds where text scrolls across the grid something like ...","the aim of this assignment is to complete a mips program that can scroll alphabetic text strings like the above video.","create a private directory for doing the assignment and put the assignment files in it by running the following command","if you're working on this at home download the zip file and create the files on your home machine. it's fine to work on your own machine but remember to always test your code on the cse machines before submitting.","the above command will create the following files","a file to control compilation of scroll.c. it is not critical for the mips assembler part it creates the executable c program to give you an exemplar and can produce the exe.s file.","a complete solution written in c. your goal is to write a mips assembler program to copy the behaviour of this program.","the array of big characters used in producing the scrolling text. this is include'd in scroll.c.","a partly complete solution to the assignment written in mips assembler.","a mips version of the array of big characters used in producing the scrolling text. this file requires no modification.","initially it would be worth compiling the c program and running it on some examples to get a feel for its behaviour. the compiled c program called scroll expects a single command-line argument the text string to be scrolled.","you can compile and run the c program scroll as follows","what the scrolling program should do whether implemented in mips or c","both the c and the mips programs are structured the same with a main function to handle the command-line arguments and then run the scrolling. the programs also have the same set of lower-level functions. in scroll.c there are comments describing the purpose of each function and the code is hopefully clear enough that you can understand how each function works.","the diagram below shows the major data structures used by the programs","the aim of this exercise is to complete the supplied mips program skeleton in the file scroll.s to behave exactly like the c program in scroll.c . you should not change the chars.s file treat its contents as a read-only data structure.","in scroll.s each function has comments to","note that these are suggestions only you can use whatever registers you like provided that you save and restore any $s registers that you overwrite in the function code. and of course provided that the code behaves the same as the c code.","to save you some time we have included function prologues and epilogues in some functions. these save and restore registers $fp $ra and any $s registers that the function happens to use and also maintain the stack. you can use these as templates for how to implement the prologue and epilogue in the functions that do not provide them.","some of the functions from scroll.s are already implemented but others require you to write mips assembler for them. here's a rundown of the functions in scroll.s and their status","note that scroll.s is not stand-alone mips program it requires access to the all_chars array in the file chars.s. in order to run the program either via spim or qtspim you'll need to combine the two files. here's an example of you might run the program using spim","the file exe.s is a complete program that can be loaded into qtspim as well. you will need to do the cat step each time you change the scroll.s file and want to test it. the makefile knows how to create this file too.","worth kudos but no marks","make the scroll repeat. if you wait until the whole message scrolls off the left hand end this is easy. make it do a continuous scroll where the message starts repeating from the right before when the end of the right-hand end of the message has moved 10 columns from the right-hand end of the display.","change the colours of the ' ' characters as they scroll. make the colour change as aesthetically pleasing as possible.","you just need to submit the scroll.s file. you can do this either through webcms3 or using give. you must submit your work before midnight on sunday 2nd september.","have fun jas","comp1521 18s2, assignment 2 my very own shell, computer system fundamentals","marks, 11 towards total course mark","group, this assignment is completed individually","due, by 11 59 59pm on sunday 7th october","submit, give cs1521 assign2 mymysh.c history.h history.c or via webcms","latepenalty, 0.09 marks per hour late approx 2.2 marks per day off the ceiling e.g. if you are 36 hours late your maximum possible mark is 7.8/11","assessment, for a guide to style use the code in the lectures and tute solutions and the supplied code. 9 marks for correct performance measured by auto-testing on a range of test cases some of which will be provided for you to test your code as you write it 1 mark for commenting the code you don't need a comment on every line but roughly one comment on each block of c statements that does a meaningful task 1 mark for readable code sensible names consistent use of indentation to highlight control structures if your submitted code won't compile your maximum possible performance mark is 3/9. the solution make sure your code compiles and runs under gcc before submitting. if your submitted code fails all the performance tests your maximum possible performance mark is 5/9. in both cases the actual mark will be determined by a tutor's assessment on how close your code is to working., 9 marks, for correct performance measured by auto-testing on a range of test cases some of which will be provided for you to test your code as you write it, 1 mark, for commenting the code you don't need a comment on every line but roughly one comment on each block of c statements that does a meaningful task, 1 mark, for readable code sensible names consistent use of indentation to highlight control structures","9 marks, for correct performance measured by auto-testing on a range of test cases some of which will be provided for you to test your code as you write it","1 mark, for commenting the code you don't need a comment on every line but roughly one comment on each block of c statements that does a meaningful task","1 mark, for readable code sensible names consistent use of indentation to highlight control structures","9 marks, for correct performance measured by auto-testing on a range of test cases some of which will be provided for you to test your code as you write it","1 mark, for commenting the code you don't need a comment on every line but roughly one comment on each block of c statements that does a meaningful task","1 mark, for readable code sensible names consistent use of indentation to highlight control structures","to give you experience writing c code to manipulate processes","to give you experience with interprocess communication pipes","to give you further experience with data structures in c","to give you experience writing c code to manipulate processes\nto give you experience with interprocess communication pipes\nto give you further experience with data structures in c","an executable for the command first token actually exists","stdin is redirected but without giveng a filename to read from","stdin is redirected but with a filename that is nonexistent or not readable","stdout is redirected but without giving a filename to write to","stdout is redirected but with a filename that is not writeable","using seqno but with an invalid sequence number","an executable for the command first token actually exists\nstdin is redirected but without giveng a filename to read from\nstdin is redirected but with a filename that is nonexistent or not readable\nstdout is redirected but without giving a filename to write to\nstdout is redirected but with a filename that is not writeable\nusing seqno but with an invalid sequence number","get normal commands running properly week 08 lab","then add shell built-ins","then add command history","then add history substitution","then add filename expansion","then add input/output redirection","get normal commands running properly week 08 lab\nthen add shell built-ins\nthen add command history\nthen add history substitution\nthen add filename expansion\nthen add input/output redirection","if your submitted code won't compile your maximum possible performance mark is 3/9. the solution make sure your code compiles and runs under gcc before submitting. if your submitted code fails all the performance tests your maximum possible performance mark is 5/9. in both cases the actual mark will be determined by a tutor's assessment on how close your code is to working.","a shell is a program that executes other programs. command-line based shells e.g. bash read lines of text break each line into tokens and execute the command indicated by the first token. for example","is a command with three tokens ls -al and cs1521/bin . the shell works out where the executable for the ls command is located and executes it passing the second two tokens as command-line arguments.","however shells do a lot more than just reading command lines and executing them. for example they keep a history of previous commands to make it easy to re-execute them. they also allow users to capture the output of a command by redirecting its output into a file. and importantly on unix/linux they allow users to build a pipeline of commands to achieve powerful effects without having to write a program. for example the following pipeline produces a list of the top ten most frequently used words in a text file","for more details on unix/linux commands and how they can be combined in this way see the comp2041 web site.","unix/linux shells also typically provide a full programming capability if pipelines aren't quite enough.","you will not be required to implement a shell as powerful as bash for this assignment but you will build some of the core features.","create a private directory for doing the assignment and put the assignment files in it by running the following command","if you're working on this at home download the zip file and create the files on your home machine. it's fine to work on your own machine but remember to always test your code on the cse machines before submitting.","the above command will create the following files","a file to control compilation of the various modules in the system.","a skeleton for the shell program that you are required to write.","a complete interface for the functions on history list data.","a skeleton for the history list functions.","the aim of this exercise is to complete the supplied program skeleton in mymysh.c giving an executable called ./mymysh. this requires you to implement the command history list data structures and functions and then use these in implementing the main program. you can add as many functions as you like to mymysh.c and history.c files.","the shell needs to be able to do the following","the shell should print a prompt using the supplied prompt function. it then reads a single line of text and interprets it as a command. a command is a sequence of space-separated tokens on a single line. the first token is treated as the name of a command where the command exists as an executable file somewhere in the user's path. if no such executable is found the shell should print a command not found message.","the command is invoked via the execve library function with the full pathname of the command as the first parameter the sequence of tokens as the second parameter and the user's environment from the third argument of the the main program as the third parameter. this is similar as the week 08 lab except that the lab didn't use the available environment .","one difference to the lab is that the shell should print some additional information before and after the output fom the command. before the command it should show the pathname of the command executable use the full pathname if the command is found by using a search of the path if the command name is relative use the name as given. after the command it should print the command's return status as determined using wexitstatus . the output from the command should be delineated by twenty hyphens as shown below","note that mymysh$ is the shell's prompt.","there are a number of built-in commands that are not executed as described above but are handled directly by the shell. the built-ins are described below.","if the command line has no tokens it is simply ignored and a new shell prompt is printed.","the shell should maintain a persistent list of the most recent 20 valid commands that the shell has executed. each command is associated with a sequence number sequence numbers increase constantly over time and persist between sessions with the shell see the examples below .","while shell is executing the command history is maintained in a fixed-size data structure defined in history.c. a number of interface functions are defined on this list and should be used in the main function. if you asbolutely cannot stand the supplied data structures and functions feel free to define your own. as long as the history behaves as required the precise implementation of the command history is not critical.","the command history has to persist between executions of the mymysh program. to achieve this it saves the history in a file $home/.mymysh_history when mymysh terminates and restores it from this file when it next starts. the .mymysh_history is simply a text file containing the most recent 20 commands and their sequence numbers. it must be in the same format as that produced by the mymysh binary i.e. 3d s n which is the same format as used to display the history within the shell where represents a single space character .","commands from the history can be re-executed by using the special notation seqno and giving the sequence number for one of the commands in the history. the command from the history should become the current command and then be treated as if it had been typed by the user. the special notation re-executes the previous command.","note that unlike most unix/linux shells mymysh does not place invalid commands in the history so commands should be checked for the following before being executed","if the command line produces any of the above errors it should not be placed in the history.","the following commands are handled by the shell and do not need to be searched for in the command path.","terminate the shell after saving the command history","display the last 20 commands with their sequence numbers","print the shell's current working directory hint getcwd","change the shell's working directory after filename expansion after changing show the new working directory hint chdir and getcwd","the exit built-in is not placed in the command history.","if any of the following characters ' ' ' ' ' ' ' ' appears in one of the tokens that token should be replaced by all of the tokens matching that token using the glob library function. this may result in the tokens list becoming longer than initially. if there are no matches use the token unchanged. this should be done before any of the actions described below. hint use glob_nocheck glob_tilde as the second parameter of the glob function","if the command line contains the tokens and a filename as the last two tokens the command should be executed with its standard input connected to the named file. if the file does not exist or is not readable that is an error. having as the last token or elsewhere in the command-line is also an error. hint pipe and dup2","if the command line contains the tokens and a filename as the last two tokens the command should be executed with its standard output connected to the named file. if the file does not already exist or exists and is writeable then it is truncated to zero length and it current contents are overwritten. if the file exists and is not writeable that is an error. having as the last token or elsewhere in the command-line is also an error. hint pipe and dup2","shell built-ins cannot have their output redirected.","the main program of mymysh should be structured roughly as follows","trying to implement the whole of the above at once is difficult. i'd suggest implementing it in stages","marks are available for each of the components. you can get full marks for a working component even if other components don't work or aren't implemented.","the following example shows how the shell should work in practice","to resolve any ambiguities in the above and to give you a basis for testing an executable for the shell is available as","please let me know asap if you think that there are bugs in the sample executable. disagreeing with one of the above design choices does not constitute a bug . however if the sample executable behaves differently to what is stated above then that is definitely a bug.","worth kudos but no marks","implement command pipelines i.e. cmd1 cmd2 ... cmdn where n 2 .","have fun jas","course introduction, ","comp1521 18s1computer systems fundamentals, 2/74","course staff, 3/74","comp1521 on the web, 4/74","... comp1521 on the web, 5/74","me, 6/74","you, 7/74","course goals, 8/74","course context, 9/74","themes, 10/74","detailed topics, 11/74","textbook, 12/74","... textbook, 13/74",", , recommended reference ... computer systems a programmer's perspective bryant and o'halloren covers most topics and quite well but uses a different machine code available in unsw bookroom","books vs notes vs slides, 14/74","systems and tools, 15/74","classes, 16/74","... classes, 17/74","assessments, 18/74","... assessments, 19/74","quizzes, 20/74","blogs, 21/74","misconduct, 22/74","final exam, 23/74","course assessment, 24/74","supplementary exams, 25/74","summary, 26/74","computer systems, ","some history, 28/74","... some history, 29/74","... some history, 30/74","computer systems, 31/74","processor, 32/74","storage, 33/74","... storage, 34/74","computer system layers, 35/74","c program life-cycle, 36/74","... c program life-cycle, 37/74","history of c compilers, 38/74","c revisited, ","what i assume you know, 40/74","type definitions, 41/74","assignment as expression, 42/74","... assignment as expression, 43/74","ignoring expression results, 44/74","... ignoring expression results, 45/74","fine control, 46/74","... fine control, 47/74","fine function control, 48/74","fine program control, 49/74","stacks queues priorityqs, 50/74","... stacks queues priorityqs, 51/74","... stacks queues priorityqs, 52/74","example stack/queue/priorityq usage, 53/74","... example stack/queue/priorityq usage, 54/74","... example stack/queue/priorityq usage, 55/74","... example stack/queue/priorityq usage, 56/74","... example stack/queue/priorityq usage, 57/74","... example stack/queue/priorityq usage, 58/74","... example stack/queue/priorityq usage, 59/74","stack data structure, 60/74","example stack client, 61/74","queue data structure, 62/74","priority queue data structure, 63/74","bit manipulation, ","bits in bytes in words, 65/74","binary constants, 66/74","bitwise and, 67/74","bitwise or, 68/74","flag-bits, 69/74","... flag-bits, 70/74","bitwise xor, 71/74","bitwise neg, 72/74","left shift, 73/74","right shift, 74/74","convenor john shepherd","course admin wael alghamdi","tutors louis cheung matthew gibson alexander hinds aydin itil jashank jeremy thomas kilkelly daniel li alex nendick leon nguyen kevin ni ellen oates shanush prema thasarathan minjie shen","lab assistants caspian baska dylan brotherston jason chu jesse colville junjie lei oliver richards harrison scott simon shields james ye michael yoo","convenor john shepherd\ncourse admin wael alghamdi\ntutors louis cheung matthew gibson alexander hinds aydin itil jashank jeremy thomas kilkelly daniel li alex nendick leon nguyen kevin ni ellen oates shanush prema thasarathan minjie shen\nlab assistants caspian baska dylan brotherston jason chu jesse colville junjie lei oliver richards harrison scott simon shields james ye michael yoo","quizzes polls comments/forums forming groups ...","quizzes polls comments/forums forming groups ...","information extraction database systems online learning","information extraction database systems online learning","ug comp 1921 1511 1521 2041 3311 4011","pg comp 9311 9315 gsoe9010","ug comp 1921 1511 1521 2041 3311 4011\npg comp 9311 9315 gsoe9010","deputy head of school education","deputy head of school education","craft beer afl craft beer k-drama craft beer nordic noir ...","craft beer afl craft beer k-drama craft beer nordic noir ...","comp1511 or comp1917 or comp1911 maybe with bridging","comp1511 or comp1917 or comp1911 maybe with bridging","review/strengthen c knowledge","introduce/revise core data structures stacks queues","review/strengthen c knowledge\nintroduce/revise core data structures stacks queues","gets you thinking like a programmer","solving problems by developing programs","expressing your solution in the c language","gets you thinking like a programmer\nsolving problems by developing programs\nexpressing your solution in the c language","gets you thinking like a systems programmer","with a deep understanding of run-time behaviour","and better able to reason about your c programs","gets you thinking like a systems programmer\nwith a deep understanding of run-time behaviour\nand better able to reason about your c programs","processors data representation instruction set assembler programming","data representation instruction set","assembler programming","program execution mapping c to assembler memory layout stack heap code control structures function calls","memory layout stack heap code","control structures function calls","operating system architecture memory cache devices i/o interrupts virtual memory processes file systems","memory cache devices i/o interrupts","virtual memory processes file systems","concurrency parallelism synchronisation coordination","parallelism synchronisation coordination","network architecture","processors data representation instruction set assembler programming\ndata representation instruction set\nassembler programming\nprogram execution mapping c to assembler memory layout stack heap code control structures function calls\nmemory layout stack heap code\ncontrol structures function calls\noperating system architecture memory cache devices i/o interrupts virtual memory processes file systems\nmemory cache devices i/o interrupts\nvirtual memory processes file systems\nconcurrency parallelism synchronisation coordination\nparallelism synchronisation coordination\nnetwork architecture","data representation instruction set","assembler programming","data representation instruction set\nassembler programming","memory layout stack heap code","control structures function calls","memory layout stack heap code\ncontrol structures function calls","memory cache devices i/o interrupts","virtual memory processes file systems","memory cache devices i/o interrupts\nvirtual memory processes file systems","parallelism synchronisation coordination","parallelism synchronisation coordination","introduction to computing systems from bits and gates to c and beyond patt and patel","from nand to tetris building a modern computer system from first principles nisan and schocken","comp2121 course web site parameswaran and guo","introduction to computing systems from bits and gates to c and beyond patt and patel\nfrom nand to tetris building a modern computer system from first principles nisan and schocken\ncomp2121 course web site parameswaran and guo","computer systems a programmer's perspective bryant and o'halloren","covers most topics and quite well","but uses a different machine code","computer systems a programmer's perspective bryant and o'halloren\ncovers most topics and quite well\nbut uses a different machine code","cover some parts of syllabus in great detail","cover some parts of syllabus in great detail","cover whole syllabus but not in great detail","cover whole syllabus but not in great detail","summarize course notes and add exercises","summarize course notes and add exercises","all tools available on the cse lab machines","can use vlab to connect to cse from home","all tools available on the cse lab machines\ncan use vlab to connect to cse from home","4 hours/week for 9 weeks a la unsw3","all lectures will be video'd echo360 and youtube","4 hours/week for 9 weeks a la unsw3\nall lectures will be video'd echo360 and youtube","10 weeks 1 hour tute followed by 2-hour lab","explore lecture material via exercises","10 weeks 1 hour tute followed by 2-hour lab\nexplore lecture material via exercises","small ish implementation tasks done in pairs","give skills practice leading on to assignments/exam","small ish implementation tasks done in pairs\ngive skills practice leading on to assignments/exam","go to a different tute in that week","go to a different lab if you need help","submit lab by next sunday get your tutor to assess","go to a different tute in that week\ngo to a different lab if you need help\nsubmit lab by next sunday get your tutor to assess","submitted before sunday at end of week x","demonstrated to tutor during week x lab or demonstrated at the start of week x 1 lab","aim of demo is to get feedback on design and style","submitted before sunday at end of week x\ndemonstrated to tutor during week x lab or demonstrated at the start of week x 1 lab\naim of demo is to get feedback on design and style","ass1 assembly language weeks 3-6 9 marks","ass2 c programming weeks 7-10 11 marks","both assignments are completed individually","can be completed on your own machine but you must test on the cse machines before you submit","but you must test on the cse machines before you submit","ass1 assembly language weeks 3-6 9 marks\nass2 c programming weeks 7-10 11 marks\nboth assignments are completed individually\ncan be completed on your own machine but you must test on the cse machines before you submit\nbut you must test on the cse machines before you submit","but you must test on the cse machines before you submit","but you must test on the cse machines before you submit","3-4 questions multiple-choice format","primarily for review of recent topics","taken in your own time via webcms3","3-4 questions multiple-choice format\nprimarily for review of recent topics\ntaken in your own time via webcms3","write it at least weekly","reflect on and plan your learning","write it at least weekly\nreflect on and plan your learning","you maintain regularly weekly","what you write is interesting","you maintain regularly weekly\nwhat you write is interesting","mips / qtspim / c quick reference guides","unix programmers manual man very handy","mips / qtspim / c quick reference guides\nunix programmers manual man very handy","some programming exercises prac","some descriptive/analytical questions theory","some programming exercises prac\nsome descriptive/analytical questions theory","do not attend the final exam","have a documented reason for not attending","do not attend the final exam\nhave a documented reason for not attending","have examok 47 finalmark 50","have examok 47 finalmark 50","more confident in your own ability","with an expanded set of tools to draw on","a deeper understanding of run-time behaviour","able to view software from systems-level perspective","producing better engineered software","ultimately enjoying the programming process more","more confident in your own ability\nwith an expanded set of tools to draw on\na deeper understanding of run-time behaviour\nable to view software from systems-level perspective\nproducing better engineered software\nultimately enjoying the programming process more","1613 ... first use of the word computer meaning a person who performs computations","1800's ... babbage's mechanical computers analytical engine and difference engine with ada lovelace","1936 ... zuse's z1 electro-mechanical computer first binary programmable computer","1943 ... eckert/mauchley's eniac first fully functional electric digital computer ... 18000 valves","1949 ... edsac and manchester mark 1 first generation stored program computers ... valves","1955 ... whirlwhind at mit first digital computer with magnetic core ram","1960 ... digital equipment corporation pdp-1 first mini-computer ... recognisable as modern computer","1971 ... intel 4004 first microprocessor","1613 ... first use of the word computer meaning a person who performs computations\n1800's ... babbage's mechanical computers analytical engine and difference engine with ada lovelace\n1936 ... zuse's z1 electro-mechanical computer first binary programmable computer\n1943 ... eckert/mauchley's eniac first fully functional electric digital computer ... 18000 valves\n1949 ... edsac and manchester mark 1 first generation stored program computers ... valves\n1955 ... whirlwhind at mit first digital computer with magnetic core ram\n1960 ... digital equipment corporation pdp-1 first mini-computer ... recognisable as modern computer\n1971 ... intel 4004 first microprocessor","control arithmetic logic bit operators","relatively small set of simple instructions","small amount of very fast storage registers","small number of control registers e.g. pc","fast fetch-decode-execute cycle ns","access to system bus to communicate with other components","all integrated on a single chip","control arithmetic logic bit operators\nrelatively small set of simple instructions\nsmall amount of very fast storage registers\nsmall number of control registers e.g. pc\nfast fetch-decode-execute cycle ns\naccess to system bus to communicate with other components\nall integrated on a single chip","very large random-addressable array of bytes","can fetch single bytes into cpu registers","can fetch multi-byte chunks into cpu e.g. 4-byte int","typically access time 70 ns size 64 gb","very large random-addressable array of bytes\ncan fetch single bytes into cpu registers\ncan fetch multi-byte chunks into cpu e.g. 4-byte int\ntypically access time 70 ns size 64 gb","very very large block-oriented storage","often on spinning disk fetching 512b-4kb per request","typically access time 30 ms size 8 tb","nowadays ssd access time 0.8ms size 1gb","very very large block-oriented storage\noften on spinning disk fetching 512b-4kb per request\ntypically access time 30 ms size 8 tb\nnowadays ssd access time 0.8ms size 1gb","well-designed readable maintainable ...","well-designed readable maintainable ...","efficiently producing correct results","handling error conditions robustly","utlising services of underlying operating system","efficiently producing correct results\nhandling error conditions robustly\nutlising services of underlying operating system","cc ... original compiler by dennis ricthie 1971","gcc ... open source compiler by richard stallman et al 1987","gcc 2.0 ... added c compilation 1992","clang ... gcc replacement by apple et al 2007","dcc ... python wrapper on clang by andrew taylor 2012 augments error messages to be more helpful to novices incorporates useful run-time checking to help debugging","augments error messages to be more helpful to novices","incorporates useful run-time checking to help debugging","cc ... original compiler by dennis ricthie 1971\ngcc ... open source compiler by richard stallman et al 1987\ngcc 2.0 ... added c compilation 1992\nclang ... gcc replacement by apple et al 2007\ndcc ... python wrapper on clang by andrew taylor 2012 augments error messages to be more helpful to novices incorporates useful run-time checking to help debugging\naugments error messages to be more helpful to novices\nincorporates useful run-time checking to help debugging","augments error messages to be more helpful to novices","incorporates useful run-time checking to help debugging","augments error messages to be more helpful to novices\nincorporates useful run-time checking to help debugging","design an algorithmic solution","describe your solution in c code using ... variables assignment tests etc if while for break scanf printf functions return prototypes .h .c arrays files structs pointers malloc free","variables assignment tests etc","if while for break scanf printf","functions return prototypes .h .c","arrays files structs pointers malloc free","design an algorithmic solution\ndescribe your solution in c code using ... variables assignment tests etc if while for break scanf printf functions return prototypes .h .c arrays files structs pointers malloc free\nvariables assignment tests etc\nif while for break scanf printf\nfunctions return prototypes .h .c\narrays files structs pointers malloc free","variables assignment tests etc","if while for break scanf printf","functions return prototypes .h .c","arrays files structs pointers malloc free","variables assignment tests etc\nif while for break scanf printf\nfunctions return prototypes .h .c\narrays files structs pointers malloc free","linked structures adts sorting recursion bit operations","linked structures adts sorting recursion bit operations","are typically success/failure status","are typically success/failure status","extreemly unlikely to occur","not fatal if the failure occurs","extreemly unlikely to occur\nnot fatal if the failure occurs","break exits the innermost enclosing loop","continue goes directly to the next iteration","break exits the innermost enclosing loop\ncontinue goes directly to the next iteration","same effect can be achieved using ifs inside loop","same effect can be achieved using ifs inside loop","but used carefully can make code easier to understand","but used carefully can make code easier to understand","a function can contain several returns","each can capture a specific condition to complete function","a function can contain several returns\neach can capture a specific condition to complete function","stacks ... last-in-first-out lists e.g. used to represent function local variables","e.g. used to represent function local variables","queues ... first-in-first-out lists e.g. used to ensure fair access to a resource","e.g. used to ensure fair access to a resource","priority queues ... highest-priority-out lists e.g. used to represent weighted lists of processes","e.g. used to represent weighted lists of processes","stacks ... last-in-first-out lists e.g. used to represent function local variables\ne.g. used to represent function local variables\nqueues ... first-in-first-out lists e.g. used to ensure fair access to a resource\ne.g. used to ensure fair access to a resource\npriority queues ... highest-priority-out lists e.g. used to represent weighted lists of processes\ne.g. used to represent weighted lists of processes","e.g. used to represent function local variables","e.g. used to represent function local variables","e.g. used to ensure fair access to a resource","e.g. used to ensure fair access to a resource","e.g. used to represent weighted lists of processes","e.g. used to represent weighted lists of processes","a sequence of items","an operation to insert an item into the sequence","an operation to remove an item from the sequence","a sequence of items\nan operation to insert an item into the sequence\nan operation to remove an item from the sequence","stack ... insert adds on top removes from top","queue ... insert adds at tail removes from head","priorityq ... inserts in priority order removes from head","stack ... insert adds on top removes from top\nqueue ... insert adds at tail removes from head\npriorityq ... inserts in priority order removes from head","insert operation called push","remove operation called pop","has a top last item added and a size","insert operation called push\nremove operation called pop\nhas a top last item added and a size","insert operation called enter or enqueue","remove operation called leave or dequeue","has a head first item added a tail last item added and a size","insert operation called enter or enqueue\nremove operation called leave or dequeue\nhas a head first item added a tail last item added and a size","insert operation called enter or enqueue","remove operation called leave or dequeue","has a head next for removal a tail lowest-priority and a size","insert operation called enter or enqueue\nremove operation called leave or dequeue\nhas a head next for removal a tail lowest-priority and a size","char 1 byte 8 bits 'a' is 01100001","short 2 bytes 16 bits 42 is 0000000000101010","int 4 bytes 32 bits 42 is 0000000000...0000101010","double 8 bytes 64 bits","char 1 byte 8 bits 'a' is 01100001\nshort 2 bytes 16 bits 42 is 0000000000101010\nint 4 bytes 32 bits 42 is 0000000000...0000101010\ndouble 8 bytes 64 bits","takes two values 1 2 4 8 bytes treats as sequence of bits","performs logical and on each corresponding pair of bits","result contains same number of bits as inputs","takes two values 1 2 4 8 bytes treats as sequence of bits\nperforms logical and on each corresponding pair of bits\nresult contains same number of bits as inputs","takes two values 1 2 4 8 bytes treats as sequence of bits","performs logical or on each corresponding pair of bits","result contains same number of bits as inputs","takes two values 1 2 4 8 bytes treats as sequence of bits\nperforms logical or on each corresponding pair of bits\nresult contains same number of bits as inputs","rwx gives permissions for the owner of the file","rw- gives permissions for group members","r-- gives permissions for everyone else","rwx gives permissions for the owner of the file\nrw- gives permissions for group members\nr-- gives permissions for everyone else","takes two values 1 2 4 8 bytes treats as sequence of bits","performs logical xor on each corresponding pair of bits","result contains same number of bits as inputs","takes two values 1 2 4 8 bytes treats as sequence of bits\nperforms logical xor on each corresponding pair of bits\nresult contains same number of bits as inputs","takes a single value 1 2 4 8 bytes treats as sequence of bits","performs logical negation of each bit","result contains same number of bits as input","takes a single value 1 2 4 8 bytes treats as sequence of bits\nperforms logical negation of each bit\nresult contains same number of bits as input","takes a single value 1 2 4 8 bytes treats as sequence of bits","and a small positive integer x","moves shifts each bit x positions to the left","left-end bit vanishes right-end bit replaced by zero","result contains same number of bits as input","takes a single value 1 2 4 8 bytes treats as sequence of bits\nand a small positive integer x\nmoves shifts each bit x positions to the left\nleft-end bit vanishes right-end bit replaced by zero\nresult contains same number of bits as input","takes a single value 1 2 4 8 bytes treats as sequence of bits","and a small positive integer x","moves shifts each bit x positions to the right","right-end bit vanishes left-end bit replaced by zero","result contains same number of bits as input","takes a single value 1 2 4 8 bytes treats as sequence of bits\nand a small positive integer x\nmoves shifts each bit x positions to the right\nright-end bit vanishes left-end bit replaced by zero\nresult contains same number of bits as input","a introduction c language","course introduction","comp1521 18s1computer systems fundamentals2/74","course staff3/74","the cast of thousands","comp1521 on the web4/74","primary entry point is webcms3","http //webcms3.cse.unsw.edu.au/comp1521/18s1/","most of the content lives under","/home/cs1521/web/18s1/... e.g.lecs labs tutes ...","most content is web-accessible via","http //cgi.cse.unsw.edu.au/ cs1521/18s1/index.php","... comp1521 on the web5/74","most material on webcms3 is publically readable.","login to webcms3 is via zid/zpass and is needed for","check marks via sturec on cmd line or via webcms3","for questions use webcms3 forum or email cs1521 cse","me6/74","research","you7/74","students in this course have completed","comp1511/1917 also studied linked lists adts and sorting","since not everyone has seen these we won't use them","for this week ...","course goals8/74","comp1511/1911/1917 ...","course context9/74","themes10/74","major themes ...","detailed topics11/74","textbook12/74","there is no prescribed textbook","material has been drawn from","... textbook13/74","recommended reference ... computer systems a programmer's perspective bryant and o'halloren covers most topics and quite well but uses a different machine code available in unsw bookroom books vs notes vs slides14/74","textbooks ...","systems and tools15/74","prac work based on linux tools","assembly language mips on qtspim also xspim in cse","use your own favourite text editor i use vim","other tools make gdb man bc -l","learn to love the shell and command-line ... very useful","classes16/74","lectures ...","... classes17/74","public holidays friday week 5 wednesday week 8","fortunately public holidays don't clobber lecture slots","but if you have tute/lab on friday or wednesday","assessments18/74","lab exercises contribute 10 to overall mark.","ideally the lab exercise for week x must be","exceptionally good submissions can get bonus a","total mark for labs can be 10 capped at 11 .","... assessments19/74","two assignments ...","good time management avoids late penalties","quizzes20/74","five small online quizzes ...","starting this week ... c revision quiz","then in weeks 2 4 6 8 10","each quiz due before sunday 11 59pm at end of week","blogs21/74","keep a blog about what you're learning","misconduct22/74","final exam23/74","3-hour on-line torture exam during the exam period.","held in cse labs must know lab environment","on-line documentation available in exam","course assessment24/74","supplementary exams25/74","supplementary exams are available to students who","summary26/74","the goal is for you to become a better programmer","computer systems","some history28/74","a potted history of computer systems ...","... some history29/74","eniac ...","... some history30/74","whirlwind ...","computer systems31/74","component view of typical modern computer system","processor32/74","modern processors provide","storage33/74","memory main memory consists of","... storage34/74","run-time memory usage depends on language processor.","how typical c compiler uses the memory","computer system layers35/74","view of software layers in typical computer system","c program life-cycle36/74","your c programs start as text","how to make one c program run on different machine architectures","... c program life-cycle37/74","from source code to machine code ...","history of c compilers38/74","milestones in c history","c revisited","what i assume you know40/74","given a problem specification ...","type definitions41/74","reminder you can give a name to a c type definition e.g.","and then use the name instead of the type definition e.g.","assignment as expression42/74","assignments can be treated as expressions returning a value","can be useful","can be dangerous","... assignment as expression43/74","assignment-as-expression often used to simplify loops e.g.","rather than","ignoring expression results44/74","we usually ignore the value returned by an assignment.","some c functions return a result which is often ignored e.g.","printf returns the number of characters printed.","exercise what value does the above printf return","choose answer at www.zeetings.com/jas1/0004-2402-0001","... ignoring expression results45/74","return values not related to function semantics","ignored return error statuses stati are generally","fine control46/74","break and continue provide fine loop control","... fine control47/74","example scan a n stop on zero or at end ignore negative values","fine function control48/74","return returns the result of a function","good style says have a single return at end","however ...","fine program control49/74","good style says program returns at end of main","however exceptional conditions may require early exit","exit terminates program with return code","can be used from anywhere in program even deeply nested functions","assert can also be used to trigger program exit","stacks queues priorityqs50/74","computer systems frequently make use of","... stacks queues priorityqs51/74","all of these data structures have","... stacks queues priorityqs52/74","data structures differ in","example stack/queue/priorityq usage53/74","starting from data containing one item insert 3","... example stack/queue/priorityq usage54/74","then insert 6","... example stack/queue/priorityq usage55/74","then insert 2","... example stack/queue/priorityq usage56/74","then remove item","... example stack/queue/priorityq usage57/74","then insert 4","... example stack/queue/priorityq usage58/74","then remove item","... example stack/queue/priorityq usage59/74","then remove item","stack data structure60/74","stack last-in first-out lifo protocol","example stack client61/74","a program to use a stack of int values","queue data structure62/74","queue first-in first-out fifo protocol","implementation covered in tute exercises.","priority queue data structure63/74","queue highest-priority-out protocol","implementation left as an exercise for the reader.","bit manipulation","bits in bytes in words65/74","values that we normally treat as atomic can be viewed as bits e.g.","c provides a set of operators that act bit-by-bit on pairs of bytes.","e.g. 10101010 11110000 yields 10100000 bitwise and","c bitwise operators","binary constants66/74","c does not have a way of directly writing binary numbers","can write numbers in decimal hexadecimal and octal.","in hexadecimal each digit represents 4 bits","in octal each digit represents 3 bits","bitwise and67/74","the operator","used for e.g. checking whether a bit is set","bitwise or68/74","the operator","used for e.g. ensuring that a bit is set","flag-bits69/74","consider file permissions in the unix file system","each file has three sets of flags defining it permissions","... flag-bits70/74","one possible representation","another possible representation","compact representation","last representation uses 1-bit per permission flag","bitwise xor71/74","the operator","used in e.g. generating random numbers building adder circuits","bitwise neg72/74","the operator","used for e.g. creating useful bit patterns","left shift73/74","the operator","right shift74/74","the operator","if signed quantity sign bit replaces left-end bit","produced 2 apr 2018","the c view of data, 1/56","... the c view of data, 2/56","... the c view of data, 3/56","... the c view of data, 4/56","... the c view of data, 5/56","the physical view of data, 6/56","memory, 7/56","... memory, 8/56","... memory, 9/56","data representation, ","data representation, 11/56","character data, 12/56","ascii character encoding, 13/56","... ascii character encoding, 14/56","unicode, 15/56","utf-8 character encoding, 16/56","bytes, bits, byte 1, byte 2, byte 3, byte 4","1, 7, 0xxxxxxx, -, -, -","2, 11, 110xxxxx, 10xxxxxx, -, -","3, 16, 1110xxxx, 10xxxxxx, 10xxxxxx, -","4, 21, 11110xxx, 10xxxxxx, 10xxxxxx, 10xxxxxx","... utf-8 character encoding, 17/56","ch, unicode, bits, simple binary, utf-8 binary","$, u 0024, 7, 010 0100, 00100100",", u 00a2, 11, 000 1010 0010, 11000010 10100010",", u 20ac, 16, 0010 0000 1010 1100, 11100010 10000010 10101100",", u 10348, 21, 0 0001 0000 0011 0100 1000, 11110000 10010000 10001101 10001000","... utf-8 character encoding, 18/56","numeric data, 19/56","integer constants, 20/56","unsigned integers, 21/56","... unsigned integers, 22/56","signed integers, 23/56","... signed integers, 24/56","... signed integers, 25/56","... signed integers, 26/56","... signed integers, 27/56","pointers, 28/56","... pointers, 29/56","floating point numbers, 30/56","... floating point numbers, 31/56","... floating point numbers, 32/56","... floating point numbers, 33/56","... floating point numbers, 34/56","component, min value, max value","exponent, 00000000 -127, 11111111 128","fraction, 00...00 0, 11...11 2-1 2-2 ... 2-24","component, min value, max value","exponent, 00000000000 -2047, 11111111111 2048","fraction, 00...00 0, 11...11 2-1 2-2 ... 2-51","... floating point numbers, 35/56","arrays, 36/56","... arrays, 37/56","... arrays, 38/56","... arrays, 39/56","structs, 40/56","... structs, 41/56","... structs, 42/56","exercise 1 struct alternatives, 43/56","variable-length structs, 44/56","... variable-length structs, 45/56","bit-wise structs, 46/56","... bit-wise structs, 47/56","... bit-wise structs, 48/56","... bit-wise structs, 49/56","... bit-wise structs, 50/56","unions, 51/56","... unions, 52/56","... unions, 53/56","... unions, 54/56","... unions, 55/56","enumerated types, 56/56","a location in memory","a value ultimately just a bit-string","a name unless created by malloc","a type which determines ... its size in units of whole bytes sizeof how to interpret its value what operations apply to the value","its size in units of whole bytes sizeof","how to interpret its value","what operations apply to the value","a scope where it's visible within the program","a lifetime during which part of program execution it exists","a location in memory\na value ultimately just a bit-string\na name unless created by malloc\na type which determines ... its size in units of whole bytes sizeof how to interpret its value what operations apply to the value\nits size in units of whole bytes sizeof\nhow to interpret its value\nwhat operations apply to the value\na scope where it's visible within the program\na lifetime during which part of program execution it exists","its size in units of whole bytes sizeof","how to interpret its value","what operations apply to the value","its size in units of whole bytes sizeof\nhow to interpret its value\nwhat operations apply to the value","global variables static variables string constants","objects persist for entire duration of program execution","global variables static variables string constants\nobjects persist for entire duration of program execution","objects created by malloc calloc ...","objects persist in heap until explicitly free'd","objects created by malloc calloc ...\nobjects persist in heap until explicitly free'd","a small region frame for each active function","frames contain local variables and parameters","a frame is created when a function is called","the frame is removed when the function returns","a small region frame for each active function\nframes contain local variables and parameters\na frame is created when a function is called\nthe frame is removed when the function returns","relatively large e.g. 228 bytes","any byte can be fetched with same cost","cost of fetching 1 2 4 8 bytes is small ns","relatively large e.g. 228 bytes\nany byte can be fetched with same cost\ncost of fetching 1 2 4 8 bytes is small ns","volatile e.g. dram ... data lost when powered off","non-volatile e.g. eeprom ... data stays when powered off","volatile e.g. dram ... data lost when powered off\nnon-volatile e.g. eeprom ... data stays when powered off","any byte address can be used to fetch 1-byte object","byte address for n-byte object must be divisible by n","any byte address can be used to fetch 1-byte object\nbyte address for n-byte object must be divisible by n","load bit-strings of sizes 1 2 4 8 bytes","from n-byte boundary addresses","into registers in the cpu","load bit-strings of sizes 1 2 4 8 bytes\nfrom n-byte boundary addresses\ninto registers in the cpu","ascii iso 646 7-bit values using lower 7-bits of a byte top bit always zero can encode roman alphabet digits punctuation control chars","7-bit values using lower 7-bits of a byte top bit always zero","can encode roman alphabet digits punctuation control chars","utf-8 unicode 8-bit values with ability to extend to multi-byte values can encode all human languages plus other symbols e.g. or","8-bit values with ability to extend to multi-byte values","can encode all human languages plus other symbols e.g. or","ascii iso 646 7-bit values using lower 7-bits of a byte top bit always zero can encode roman alphabet digits punctuation control chars\n7-bit values using lower 7-bits of a byte top bit always zero\ncan encode roman alphabet digits punctuation control chars\nutf-8 unicode 8-bit values with ability to extend to multi-byte values can encode all human languages plus other symbols e.g. or\n8-bit values with ability to extend to multi-byte values\ncan encode all human languages plus other symbols e.g. or","7-bit values using lower 7-bits of a byte top bit always zero","can encode roman alphabet digits punctuation control chars","7-bit values using lower 7-bits of a byte top bit always zero\ncan encode roman alphabet digits punctuation control chars","8-bit values with ability to extend to multi-byte values","can encode all human languages plus other symbols e.g. or","8-bit values with ability to extend to multi-byte values\ncan encode all human languages plus other symbols e.g. or","control characters 0..31 ... e.g. ' 0' ' n'","punctuation chars 32..47 91..96 123..126","digits 48..57 ... '0'..'9'","upper case alphabetic 65..90 ... 'a'..'z'","lower case alphabetic 97..122 ... 'a'..'z'","control characters 0..31 ... e.g. ' 0' ' n'\npunctuation chars 32..47 91..96 123..126\ndigits 48..57 ... '0'..'9'\nupper case alphabetic 65..90 ... 'a'..'z'\nlower case alphabetic 97..122 ... 'a'..'z'","not all writing systems use a small set of discrete symbols","not all writing systems use a small set of discrete symbols","around 140k symbols covering 140 different languages","around 140k symbols covering 140 different languages","e.g. standard roman alphabet punctuation needs only 7-bits","e.g. standard roman alphabet punctuation needs only 7-bits","uhexdigits ... insert unicode code value","x2hexdigits ... insert individual bytes","uhexdigits ... insert unicode code value\nx2hexdigits ... insert individual bytes","integer ... subset range of the mathematical integers","floating point ... subset of the mathematical real numbers","integer ... subset range of the mathematical integers\nfloating point ... subset of the mathematical real numbers","42 ... signed decimal 0..9","0x2a ... unsigned hexadecimal 0..f","052 ... signed octal 0 ..7","42 ... signed decimal 0..9\n0x2a ... unsigned hexadecimal 0..f\n052 ... signed octal 0 ..7","123u ... unsigned int value typically 32 bits","123l ... long int value typically 64 bits","123s ... short int value typically 16 bits","123u ... unsigned int value typically 32 bits\n123l ... long int value typically 64 bits\n123s ... short int value typically 16 bits","4294967296 -1u 666666s 078","4294967296 -1u 666666s 078","commonly 32 bits storing values in the range 0 .. 232-1","commonly 32 bits storing values in the range 0 .. 232-1","commonly 32 bits storing values in the range -231 .. 231-1","commonly 32 bits storing values in the range -231 .. 231-1","signed magnitude ... first bit is sign rest are magnitude","ones complement ... form -n by inverting all bits in n","twos complement ... form -n by inverting n and adding 1","signed magnitude ... first bit is sign rest are magnitude\nones complement ... form -n by inverting all bits in n\ntwos complement ... form -n by inverting n and adding 1","10000101 ... signed magnitude","11111010 ... ones complement","11111011 ... twos complement","10000101 ... signed magnitude\n11111010 ... ones complement\n11111011 ... twos complement","what do these numbers represent 00000000 10000000","what do these numbers represent 00000000 10000000","what do these numbers represent 00000000 11111111","what do these numbers represent 00000000 11111111","-0 00000000 1 11111111 1 00000000","-0 00000000 1 11111111 1 00000000","number of bits depends on memory size but typically 32-bits","data pointers reference addresses in data/heap/stack regions","function pointers reference addresses in code region","number of bits depends on memory size but typically 32-bits\ndata pointers reference addresses in data/heap/stack regions\nfunction pointers reference addresses in code region","sizeof int sizeof char sizeof double sizeof struct x","sizeof int sizeof char sizeof double sizeof struct x","char ... can reference any byte address","int ... must have addr 4 0","double ... must have addr 8 0","char ... can reference any byte address\nint ... must have addr 4 0\ndouble ... must have addr 8 0","many real values don't have exact representation e.g. 1/3","results of calculations may contain small inaccuracies","many real values don't have exact representation e.g. 1/3\nresults of calculations may contain small inaccuracies","numbers close to zero have higher precision more accurate","numbers further from zero have lower precision less accurate","numbers close to zero have higher precision more accurate\nnumbers further from zero have lower precision less accurate","float ... typically 32-bit quantity lower precision narrower range","double ... typically 64-bit quantity higher precision wider range","float ... typically 32-bit quantity lower precision narrower range\ndouble ... typically 64-bit quantity higher precision wider range","scientific notation with fraction f and exponent e","numbers have form f 2e where both f and e can be -ve","infinity representation for and - e.g. 1.0/0","nan representation for invalid value nan e.g. sqrt -1.0","32-bit single-precision 64-bit double precision","scientific notation with fraction f and exponent e\nnumbers have form f 2e where both f and e can be -ve\ninfinity representation for and - e.g. 1.0/0\nnan representation for invalid value nan e.g. sqrt -1.0\n32-bit single-precision 64-bit double precision","1010.1011 is normalized as 1.0101011 2011","1010.1011 10 11/16 10.6875","1.0101011 2011 1 43/128 23 1.3359375 8 10.6875","1010.1011 is normalized as 1.0101011 2011\n1010.1011 10 11/16 10.6875\n1.0101011 2011 1 43/128 23 1.3359375 8 10.6875","fraction part is always 1.bbbbbbbb don't store 1","exponent is offset relative to a baseline -2b-1-1 b exponent bits","fraction part is always 1.bbbbbbbb don't store 1\nexponent is offset relative to a baseline -2b-1-1 b exponent bits","the baseline aka bias is 127 the exponent is 27","so in the exponent we store 127 7 134 10000110","the baseline aka bias is 127 the exponent is 27\nso in the exponent we store 127 7 134 10000110","individual array elements are accessed via indices 0..n-1","total amount of space allocated to array n sizeof type","individual array elements are accessed via indices 0..n-1\ntotal amount of space allocated to array n sizeof type","constant strings have ' 0' added automatically","string buffers must allow for element to hold ' 0'","constant strings have ' 0' added automatically\nstring buffers must allow for element to hold ' 0'","each component has a name and a type","each component has a name and a type","define the dynamic object as the last component","malloc more space than the struct requires","to make the final component as large as required","define the dynamic object as the last component\nmalloc more space than the struct requires\nto make the final component as large as required","c allows programmers to specify structs bit-wise","c allows programmers to specify structs bit-wise","specify unnamed components using standard types","specify named individual bit fields in each component","specify unnamed components using standard types\nspecify named individual bit fields in each component","course notes b memory and data representation","the c view of data1/56","a c program sees data as a collection of variables","each variable has a number of properties e.g. name type size","... the c view of data2/56","variables are examples of computational objects","each computational object has","... the c view of data3/56","c allocates data objects to various well-defined regions of memoryduring program execution","... the c view of data4/56","the global data area contains","... the c view of data5/56","example of runtime stack during call to h","the physical view of data6/56","memory indexed array of bytes","indexes are memory addresses a.k.a. pointers","data can be fetched in chunks of 1 2 4 8 bytes","memory7/56","also called ram main memory primary storage ...","technology semiconductor-based","distinguishing features","two properties related to data persistence","... memory8/56","when addressing objects in memory","data bytes in registers may be in different order to memory e.g.","... memory9/56","memories can be categorised as big-endian or little-endian","data representation","data representation11/56","ultimately memory allows you to","need to interpret this bit-string as a meaningful value","data representations provide a way of assigning meaning to bit-strings","character data12/56","character data has several possible representations encodings","the two most common","e.g. or","ascii character encoding13/56","uses values in the range 0x00 to 0x7f 0..127","characters partitioned into sequential groups","sequential nature of groups allow for e.g. ch - '0'","... ascii character encoding14/56","hexademical ascii char table from man 7 ascii","0x0a ' n' 0x20 ' ' 0x09 ' t' but note no eof","unicode15/56","widely-used standard for expressing writing systems","utf-8 character encoding16/56","utf-8 uses a variable-length encoding as follows","the 127 1-byte codes are compatible with ascii","the 2048 2-byte codes include most latin-script alphabets","the 65536 3-byte codes include most asian languages","the 2097152 4-byte codes include symbols and emojis and ...","... utf-8 character encoding17/56","utf-8 examples","unicode strings can be manipulated in c e.g.","like other c strings they are terminated by a 0 byte i.e. ' 0'","... utf-8 character encoding18/56","unicode constants in c strings ...","the following two notations work in some contexts","the red sequences produce 3 bytes and 1 unicode symbol.","numeric data19/56","numeric data comes in two major forms","integer constants20/56","three ways to write integer constants in c","unsigned integers21/56","the unsigned int data type","... unsigned integers22/56","value interpreted as binary number","e.g. consider an 8-bit unsigned int","01001101 26 23 22 20 64 8 4 1 77","addition is bitwise with carry","most machines will also flag the overflow in the fourth example","signed integers23/56","the int data type","... signed integers24/56","several possible representations for negative values","examples representations of 8-bit -5 where 5 is 00000101","... signed integers25/56","signed magnitude easy to form -x from x ... or in high-order bit","a problem using 8-bit ints ...","another problem x -x 0 mostly with simple addition","to fix requires extra hardware in alu","... signed integers26/56","ones complement easy to form -x from x ... neg all bits","a problem using 8-bit ints ...","at least x -x is equal to one of the zeroes with simple addition","... signed integers27/56","twos complement to form -x from x ... neg all bits then add 1","now have only one representation for zero 00000000","even better x -x 0 in all cases with simple addition","always produces an overflow bit but can ignore this","pointers28/56","pointers represent memory addresses/locations","... pointers29/56","can move from object to object by pointer arithmetic","for any pointer t p p increases p by sizeof t","examples assuming 16-bit pointers","a common efficient paradigm for scanning a string","floating point numbers30/56","floating point numbers model a tiny subset of","... floating point numbers31/56","c has two floating point types","display via printf","w gives total width blank padded p gives digits after dec point","... floating point numbers32/56","ieee 754 standard ...","example of normalising in binary","... floating point numbers33/56","internal structure of floating point values","more complex than int because 1.dddd e dd","... floating point numbers34/56","details of internal structure","00...00 24 zero bits 11...11 24 one bits","00...00 24 zero bits 11...11 24 one bits","... floating point numbers35/56","example single-precision","where red is sign bit green is exponent blue is fraction","note","arrays36/56","arrays are defined to have n elements each of type t","examples","elements are laid out adjacent in memory","... arrays37/56","assuming an array declaration like type v n ...","name of array can be treated as a pointer to element type type","array indexing can be treated as v i v i","if have pointer to first element can use it just like an array","strings are just arrays of char with a ' 0' terminator","... arrays38/56","when arrays are passed to a function actually pass a 0","... arrays39/56","arrays can be created automatically or via malloc","two separate arrays different 's but have same contents","except for the unitialised parts of the arrays","structs40/56","structs are defined to have a number of components","... structs41/56","internal layout of struct components determined by compiler","each name maps to a byte offset within the struct","e.g. in first example id offset 0 given offset 4 family offset 54 etc.","... structs42/56","to ensure alignment internal padding may be needed","padding wastes space re-order fields to minimise waste.","clang has -wpadded to warn about padding in structs","exercise 1 struct alternatives43/56","consider these two possible representations of nodes in a linked list of strings","show how they would be a defined b initialised. how large is each","variable-length structs44/56","structs can contain pointers to dynamic objects","but we can also embed one dynamic object in a malloc'd struct","... variable-length structs45/56","amount of memory allocated to struct is determined dynamically","bit-wise structs46/56","for fine-grained control over layout of fields in structs","has one component and three bit fields within that component.","... bit-wise structs47/56","two ways of declaring bit fields","in both cases sizeof struct _bit_fields is 4 bytes.","first way makes it clearer that a single unsigned int is used.","... bit-wise structs48/56","another example graphics objects","... bit-wise structs49/56","the graphics object would be stored in memory as","... bit-wise structs50/56","bit-fields provide an alternative to bit operators and masks","unions51/56","unions allow programmers to specify multiple interpretations for a single piece of memory.","... unions52/56","example of defining a union type cf. struct","myunion is a single 4-byte memory object","programmers can specify how to interpret bits using field names.","in the example above all components are coincidentally the same size 4 bytes","... unions53/56","difference between a struct and a union","... unions54/56","general syntax for defining union types and variables","type can be any c type member names must be distinct","sizeof union is the size of the largest member","uvar.member1 uvar.member2 uvar.member3 ...","... unions55/56","common use of union types generic variables","enumerated types56/56","enumerated types allow programmers to define a set of distinct named values","the names are assigned consecutive int values starting from 0","above primarycolors type is equivalent to","variables of type enum... are effectively unsigned ints.","produced 1 mar 2018","instruction set architectures, ","cpu architecture, 2/114","why study assembler, 3/114","instruction sets, 4/114","... instruction sets, 5/114","... instruction sets, 6/114","... instruction sets, 7/114","... instruction sets, 8/114","fetch-execute cycle, 9/114","... fetch-execute cycle, 10/114","assembly language, 11/114","... assembly language, 12/114","mips architecture, 13/114","mips vs spim, 14/114","using spim, 15/114","... using spim, 16/114","... using spim, 17/114","mips machine archtecture, 18/114","... mips machine archtecture, 19/114","reg, , name, , notes","$0, , zero, , the value 0 not changeable","$1, , $at, , assembler temporary used to implement pseudo-ops","$2, , $v0, , value from expression evaluation or function return","$3, , $v1, , value from expression evaluation or function return","$4, , $a0, , first argument to a function/subroutine if needed","$5, , $a1, , second argument to a function/subroutine if needed","$6, , $a2, , third argument to a function/subroutine if needed","$7, , $a3, , fourth argument to a function/subroutine if needed","$8..$15, , $t0..$t7, , temporary must be saved by caller to subroutine subroutine can overwrite","... mips machine archtecture, 20/114","reg, , name, , notes","$16..$23, , $s0..$s7, , safe function variable must not be overwritten by called subroutine","$24..$25, , $t8..$t9, , temporary must be saved by caller to subroutine subroutine can overwrite","$26..$27, , $k0..$k1, , for kernel use may change unexpectedly","$28, , $gp, , global pointer","$29, , $sp, , stack pointer","$30, , $fp, , frame pointer","$31, , $ra, , return address of most recent caller","... mips machine archtecture, 21/114","reg, , notes","","$f0..$f2, , hold floating-point function results","$f4..$f10, , temporary registers not preserved across function calls","$f12..$f14, , used for first two double-precision function arguments","$f16..$f18, , temporary registers used for expression evaluation","$f20..$f30, , saved registers value is preserved across function calls","mips assembly language, 22/114","... mips assembly language, 23/114","... mips assembly language, 24/114","... mips assembly language, 25/114","... mips assembly language, 26/114","region, , address, , notes","text, , 0x00400000, , contains only instructions read-only cannot expand","data, , 0x10000000, , data objects readable/writeable can be expanded","stack, , 0x7fffefff, , grows down from that address readable/writeable","k_text, , 0x80000000, , kernel code read-only only accessible kernel mode","k_data, , 0x90000000, , kernel data read/write only accessible kernel mode","mips instructions, 27/114","... mips instructions, 28/114","addressing modes, 29/114","... addressing modes, 30/114","format, , address computation","register, , address register contents of register","k, , address k","k register, , address k register","symbol, , address symbol address of symbol","symbol k, , address symbol k","symbol k register, , address symbol k register","... addressing modes, 31/114","operand sizes, 32/114","mips instruction set, 33/114","... mips instruction set, 34/114","syntax, semantics","$reg, as source the content of the register reg reg","$reg, as destination value is stored in register reg reg value","label, references the associated address in c terms label","addr, any expression that yields an address e.g. label $reg","addr, as source the content of memory cell memory addr","addr, as destination value is stored in memory addr value","... mips instruction set, 35/114","... mips instruction set, 36/114","... mips instruction set, 37/114","... mips instruction set, 38/114","... mips instruction set, 39/114","service, code, arguments, result","print_int, 1, $a0 integer, ","print_float, 2, $f12 float, ","print_double, 3, $f12 double, ","print_string, 4, $a0 char, ","read_int, 5, , integer in $v0","read_float, 6, , float in $f0","read_double, 7, , double in $f0","read_string, 8, $a0 buffer $a1 length, string in buffer including n 0","... mips instruction set, 40/114","mips programming, 41/114","... mips programming, 42/114","... mips programming, 43/114","... mips programming, 44/114","... mips programming, 45/114","rendering c in mips, 46/114","... rendering c in mips, 47/114","arithmetic expressions, 48/114","conditional statements, 49/114","... conditional statements, 50/114","... conditional statements, 51/114","... conditional statements, 52/114","... conditional statements, 53/114","boolean expressions, 54/114","... boolean expressions, 55/114","iteration statements, 56/114","... iteration statements, 57/114","functions, 58/114","... functions, 59/114","... functions, 60/114","... functions, 61/114","... functions, 62/114","... functions, 63/114","aside mips branch delay slots, 64/114","aside why do we need both $fp and $sp, 65/114","function calling protocol, 66/114","... function calling protocol, 67/114","... function calling protocol, 68/114","... function calling protocol, 69/114","... function calling protocol, 70/114","... function calling protocol, 71/114","... function calling protocol, 72/114","structure of functions, 73/114","function prologue, 74/114","... function prologue, 75/114","... function prologue, 76/114","... function prologue, 77/114","function epilogue, 78/114","... function epilogue, 79/114","data structures and mips, 80/114","static vs dynamic allocation, 81/114","... static vs dynamic allocation, 82/114","... static vs dynamic allocation, 83/114","... static vs dynamic allocation, 84/114","... static vs dynamic allocation, 85/114","... static vs dynamic allocation, 86/114","1-d arrays in mips, 87/114","... 1-d arrays in mips, 88/114","... 1-d arrays in mips, 89/114","... 1-d arrays in mips, 90/114","2-d arrays in mips, 91/114","... 2-d arrays in mips, 92/114","... 2-d arrays in mips, 93/114","... 2-d arrays in mips, 94/114","... 2-d arrays in mips, 95/114","structs in mips, 96/114","... structs in mips, 97/114","... structs in mips, 98/114","... structs in mips, 99/114","... structs in mips, 100/114","... structs in mips, 101/114","... structs in mips, 102/114","compiling c to mips, 103/114","c pre-processor, 104/114","... c pre-processor, 105/114","c parser, 106/114","symbol table management, 107/114","local variables, 108/114","expression evaluation, 109/114","mapping control structures, 110/114","... mapping control structures, 111/114","argc and argv, 112/114","... argc and argv, 113/114","... argc and argv, 114/114","a set of data registers","a set of control registers incl pc","an arithmetic-logic unit alu","access to random access memory ram","a set of simple instructions transfer data between memory and registers push values through the alu to compute results make tests and transfer control of execution","transfer data between memory and registers","push values through the alu to compute results","make tests and transfer control of execution","a set of data registers\na set of control registers incl pc\nan arithmetic-logic unit alu\naccess to random access memory ram\na set of simple instructions transfer data between memory and registers push values through the alu to compute results make tests and transfer control of execution\ntransfer data between memory and registers\npush values through the alu to compute results\nmake tests and transfer control of execution","transfer data between memory and registers","push values through the alu to compute results","make tests and transfer control of execution","transfer data between memory and registers\npush values through the alu to compute results\nmake tests and transfer control of execution","e.g. different registers different sized registers different instructions","e.g. different registers different sized registers different instructions","sometimes you are required to use it e.g. device handlers","improves your understanding of how c programs execute very helpful when debugging able to avoid using known inefficient constructs","very helpful when debugging","able to avoid using known inefficient constructs","uber-nerdy performance tweaking squeezing out last nano-s re-write that critical frequently-used function in assembler","re-write that critical frequently-used function in assembler","sometimes you are required to use it e.g. device handlers\nimproves your understanding of how c programs execute very helpful when debugging able to avoid using known inefficient constructs\nvery helpful when debugging\nable to avoid using known inefficient constructs\nuber-nerdy performance tweaking squeezing out last nano-s re-write that critical frequently-used function in assembler\nre-write that critical frequently-used function in assembler","very helpful when debugging","able to avoid using known inefficient constructs","very helpful when debugging\nable to avoid using known inefficient constructs","re-write that critical frequently-used function in assembler","re-write that critical frequently-used function in assembler","small ish set of simple general instructions","separate computation data transfer instructions","leading to simpler processor hardware","e.g. mips risc alpha sparc powerpc arm ...","small ish set of simple general instructions\nseparate computation data transfer instructions\nleading to simpler processor hardware\ne.g. mips risc alpha sparc powerpc arm ...","large r set of powerful instructions","each instruction has multiple actions comp store","more circuitry to decode/process instructions","e.g. pdp vax z80 motorola 68xxx intel x86 ...","large r set of powerful instructions\neach instruction has multiple actions comp store\nmore circuitry to decode/process instructions\ne.g. pdp vax z80 motorola 68xxx intel x86 ...","typically have 1-2 32-bit words per instruction","partition bits in each word into operator operands","bits for each depends on instructions registers ...","typically have 1-2 32-bit words per instruction\npartition bits in each word into operator operands\nbits for each depends on instructions registers ...","load register memoryaddress copy value stored in memory at address into named register","copy value stored in memory at address into named register","loadc register constantvalue copy value into named register","copy value into named register","store register memoryaddress copy value stored in named register into memory at address","copy value stored in named register into memory at address","jump memoryaddress transfer execution of program to instruction at address","transfer execution of program to instruction at address","jumpif register memoryaddress transfer execution of program if e.g. register holds zero value","transfer execution of program if e.g. register holds zero value","load register memoryaddress copy value stored in memory at address into named register\ncopy value stored in memory at address into named register\nloadc register constantvalue copy value into named register\ncopy value into named register\nstore register memoryaddress copy value stored in named register into memory at address\ncopy value stored in named register into memory at address\njump memoryaddress transfer execution of program to instruction at address\ntransfer execution of program to instruction at address\njumpif register memoryaddress transfer execution of program if e.g. register holds zero value\ntransfer execution of program if e.g. register holds zero value","copy value stored in memory at address into named register","copy value stored in memory at address into named register","copy value into named register","copy value into named register","copy value stored in named register into memory at address","copy value stored in named register into memory at address","transfer execution of program to instruction at address","transfer execution of program to instruction at address","transfer execution of program if e.g. register holds zero value","transfer execution of program if e.g. register holds zero value","add register1 register2 register3 similarly for sub mul div register3 register1 register2","register3 register1 register2","and register1 register2 register3 similarly for or xor register3 register1 register2","register3 register1 register2","neg register1 register2 register2 register1","register2 register1","shiftl register1 value register2 similarly for shiftr register2 register1 value","register2 register1 value","syscall value invoke a system service which service determined by value","invoke a system service which service determined by value","add register1 register2 register3 similarly for sub mul div register3 register1 register2\nregister3 register1 register2\nand register1 register2 register3 similarly for or xor register3 register1 register2\nregister3 register1 register2\nneg register1 register2 register2 register1\nregister2 register1\nshiftl register1 value register2 similarly for shiftr register2 register1 value\nregister2 register1 value\nsyscall value invoke a system service which service determined by value\ninvoke a system service which service determined by value","register3 register1 register2","register3 register1 register2","register3 register1 register2","register3 register1 register2","register2 register1","register2 register1","register2 register1 value","register2 register1 value","invoke a system service which service determined by value","invoke a system service which service determined by value","determine what the operator is","determine which registers if any are involved","determine which memory location if any is involved","carry out the operation with the relevant operands","store result if any in appropriate register","determine what the operator is\ndetermine which registers if any are involved\ndetermine which memory location if any is involved\ncarry out the operation with the relevant operands\nstore result if any in appropriate register","write instructions using mnemonics rather than hex codes","reference registers using either numbers or names","can associate names to memory addresses","write instructions using mnemonics rather than hex codes\nreference registers using either numbers or names\ncan associate names to memory addresses","need to use fine-grained control of memory usage","required to manipulate data in registers","control structures programmed via explicit jumps","need to use fine-grained control of memory usage\nrequired to manipulate data in registers\ncontrol structures programmed via explicit jumps","very popular in a range of computing devices in the 1990's","e.g. silicon graphics nec nintendo64 playstation supercomputers","very popular in a range of computing devices in the 1990's\ne.g. silicon graphics nec nintendo64 playstation supercomputers","using two variants of the open-source spim emulator","qtspim ... provides a gui front-end useful for debugging","spim ... command-line based version useful for testing","xspim ... gui front-end useful for debugging only in cse labs","using two variants of the open-source spim emulator\nqtspim ... provides a gui front-end useful for debugging\nspim ... command-line based version useful for testing\nxspim ... gui front-end useful for debugging only in cse labs","reads text files containing instruction directives","converts to machine code and loads into memory","provides debugging capabilities single-step breakpoints view registers/memory ...","single-step breakpoints view registers/memory ...","provides mechanism to interact with operating system syscall","reads text files containing instruction directives\nconverts to machine code and loads into memory\nprovides debugging capabilities single-step breakpoints view registers/memory ...\nsingle-step breakpoints view registers/memory ...\nprovides mechanism to interact with operating system syscall","single-step breakpoints view registers/memory ...","single-step breakpoints view registers/memory ...","provide convenient/mnemonic ways to do common operations","e.g. move $s0 $v0 rather than addu $s0 $0 $v0","provide convenient/mnemonic ways to do common operations\ne.g. move $s0 $v0 rather than addu $s0 $0 $v0","spim ... command line tool load programs using -file option interact using stdin/stdout via login terminal","load programs using -file option","interact using stdin/stdout via login terminal","qtspim ... gui environment load programs via a load button interact via a pop-up stdin/stdout terminal","load programs via a load button","interact via a pop-up stdin/stdout terminal","xspim ... gui environment similar to qtspim but not as pretty requires x-windows server","similar to qtspim but not as pretty","requires x-windows server","spim ... command line tool load programs using -file option interact using stdin/stdout via login terminal\nload programs using -file option\ninteract using stdin/stdout via login terminal\nqtspim ... gui environment load programs via a load button interact via a pop-up stdin/stdout terminal\nload programs via a load button\ninteract via a pop-up stdin/stdout terminal\nxspim ... gui environment similar to qtspim but not as pretty requires x-windows server\nsimilar to qtspim but not as pretty\nrequires x-windows server","load programs using -file option","interact using stdin/stdout via login terminal","load programs using -file option\ninteract using stdin/stdout via login terminal","load programs via a load button","interact via a pop-up stdin/stdout terminal","load programs via a load button\ninteract via a pop-up stdin/stdout terminal","similar to qtspim but not as pretty","requires x-windows server","similar to qtspim but not as pretty\nrequires x-windows server","32 32-bit general purpose registers","16 64-bit double-precision registers","pc ... 32-bit register always aligned on 4-byte boundary","hi lo ... for storing results of multiplication and division","32 32-bit general purpose registers\n16 64-bit double-precision registers\npc ... 32-bit register always aligned on 4-byte boundary\nhi lo ... for storing results of multiplication and division","register $0 always has value 0 cannot be written","registers $1 $26 $27 reserved for use by system","register $0 always has value 0 cannot be written\nregisters $1 $26 $27 reserved for use by system","registers come in pairs of 2 32-bits","only even registers are addressed for double-precision","registers come in pairs of 2 32-bits\nonly even registers are addressed for double-precision","comments ... introduced by","labels ... appended with","directives ... symbol beginning with .","assembly language instructions","comments ... introduced by\nlabels ... appended with\ndirectives ... symbol beginning with .\nassembly language instructions","data objects that live in the data region","functions instruction sequences that live in the code/text region","data objects that live in the data region\nfunctions instruction sequences that live in the code/text region","load and store .. transfer data between registers and memory","computational ... perform arithmetic/logical operations","jump and branch ... transfer control of program execution","coprocessor ... standard interface to various co-processors","special ... miscellaneous tasks e.g. syscall","load and store .. transfer data between registers and memory\ncomputational ... perform arithmetic/logical operations\njump and branch ... transfer control of program execution\ncoprocessor ... standard interface to various co-processors\nspecial ... miscellaneous tasks e.g. syscall","between memory and register direct indirect","constant to register immediate","register register destination register","between memory and register direct indirect\nconstant to register immediate\nregister register destination register","an operation e.g. load store add branch ...","one or more operands e.g. registers memory addresses constants","an operation e.g. load store add branch ...\none or more operands e.g. registers memory addresses constants","symbolic name label effectively a constant","indirectly via a register effectively pointer dereferencing","symbolic name label effectively a constant\nindirectly via a register effectively pointer dereferencing","computed address for a is 0x100000008","computed address for b is 0x100000000","computed address for c is 0x100000004","computed address for a is 0x100000008\ncomputed address for b is 0x100000000\ncomputed address for c is 0x100000004","single bytes two bytes halfword four bytes word","single bytes two bytes halfword four bytes word","lb ... load one byte from specified address","lbu ... load unsigned byte from specified address","lh ... load two bytes from specified address","lhu ... load unsigned 2-bytes from specified address","lw ... load four bytes one word from specified address","la ... load the specified address","lb ... load one byte from specified address\nlbu ... load unsigned byte from specified address\nlh ... load two bytes from specified address\nlhu ... load unsigned 2-bytes from specified address\nlw ... load four bytes one word from specified address\nla ... load the specified address","lw sw add sub and or sll slt beq j jal ...","lw sw add sub and or sll slt beq j jal ...","move rem la li blt ...","move rem la li blt ...","treat registers as unsigned int reg 32","treat memory as unsigned char mem 232","treat registers as unsigned int reg 32\ntreat memory as unsigned char mem 232","develop the solution in c","map to simplified c","translate each simplified c statement to mips instructions","develop the solution in c\nmap to simplified c\ntranslate each simplified c statement to mips instructions","does not have while switch complex expressions","does have simple if goto one-operator expressions","does not have function calls and auto local variables","does have jump-and-remember-where-you-came-from","does not have while switch complex expressions\ndoes have simple if goto one-operator expressions\ndoes not have function calls and auto local variables\ndoes have jump-and-remember-where-you-came-from","labels ... symbolic name for c statement","goto ... transfer control to labelled statement","labels ... symbolic name for c statement\ngoto ... transfer control to labelled statement","follow the conventions implied by register names","preserve values that need to be saved across function calls","follow the conventions implied by register names\npreserve values that need to be saved across function calls","you manage register usage as you like","typically making use of $t registers","you manage register usage as you like\ntypically making use of $t registers","you transfer control to a separate piece of code","which may change the value of any non-preserved register","$s registers must be preserved by function","$a $v $t registers may be modified by function","you transfer control to a separate piece of code\nwhich may change the value of any non-preserved register\n$s registers must be preserved by function\n$a $v $t registers may be modified by function","x 1 y y / 2 z 1.0 / 2 ...","x 1 y y / 2 z 1.0 / 2 ...","move rd rs li rd const add div and ...","move rd rs li rd const add div and ...","sequence if while for break continue ...","sequence if while for break continue ...","seq slti sltu ... beq bgtz bgezal ... j jr jal ...","seq slti sltu ... beq bgtz bgezal ... j jr jal ...","describing the process as a sequence of binary operations","managing data flow between the operations","describing the process as a sequence of binary operations\nmanaging data flow between the operations","works best for small dense range of case values e.g. 1..10","works best for small dense range of case values e.g. 1..10","evaluate cond1 if 0 then return 0 for whole expression","evaluate cond2 if 0 then return 0 for whole expression","...","evaluate condn if 0 then return 0 for whole expression","otherwise return 1","evaluate cond1 if 0 then return 0 for whole expression\nevaluate cond2 if 0 then return 0 for whole expression\n...\nevaluate condn if 0 then return 0 for whole expression\notherwise return 1","evaluate cond1 if 0 then return 1 for whole expression","evaluate cond2 if 0 then return 1 for whole expression","...","evaluate condn if 0 then return 1 for whole expression","otherwise return 1","evaluate cond1 if 0 then return 1 for whole expression\nevaluate cond2 if 0 then return 1 for whole expression\n...\nevaluate condn if 0 then return 1 for whole expression\notherwise return 1","the arguments are evaluated and set up for function","control is transferred to the code for the function","local variables are created","the function code is executed in this environment","the return value is set up","control transfers back to where the function was called from","the caller receives the return value","the arguments are evaluated and set up for function\ncontrol is transferred to the code for the function\nlocal variables are created\nthe function code is executed in this environment\nthe return value is set up\ncontrol transfers back to where the function was called from\nthe caller receives the return value","used for saved registers local variables parameters to callees","created in the function prologue pushed","removed in the function epilogue popped","used for saved registers local variables parameters to callees\ncreated in the function prologue pushed\nremoved in the function epilogue popped","function f calls g which calls h","h runs then finishes and returns to g","g continues then finishes and returns to f","function f calls g which calls h\nh runs then finishes and returns to g\ng continues then finishes and returns to f","caller saved registers saved by f f tells g if there is anything i want to preserve in these registers i have already saved it before calling you g tells f don't assume that these registers will be unchanged when i return to you e.g. $t0 .. $t9 $a0 .. $a3 $ra","f tells g if there is anything i want to preserve in these registers i have already saved it before calling you","g tells f don't assume that these registers will be unchanged when i return to you","e.g. $t0 .. $t9 $a0 .. $a3 $ra","callee saved registers saved by g f tells g i assume the values of these registers will be unchanged when you return g tells f if i need to use these registers i will save them first and restore them before returning e.g. $s0 .. $s7 $sp $fp","f tells g i assume the values of these registers will be unchanged when you return","g tells f if i need to use these registers i will save them first and restore them before returning","e.g. $s0 .. $s7 $sp $fp","caller saved registers saved by f f tells g if there is anything i want to preserve in these registers i have already saved it before calling you g tells f don't assume that these registers will be unchanged when i return to you e.g. $t0 .. $t9 $a0 .. $a3 $ra\nf tells g if there is anything i want to preserve in these registers i have already saved it before calling you\ng tells f don't assume that these registers will be unchanged when i return to you\ne.g. $t0 .. $t9 $a0 .. $a3 $ra\ncallee saved registers saved by g f tells g i assume the values of these registers will be unchanged when you return g tells f if i need to use these registers i will save them first and restore them before returning e.g. $s0 .. $s7 $sp $fp\nf tells g i assume the values of these registers will be unchanged when you return\ng tells f if i need to use these registers i will save them first and restore them before returning\ne.g. $s0 .. $s7 $sp $fp","f tells g if there is anything i want to preserve in these registers i have already saved it before calling you","g tells f don't assume that these registers will be unchanged when i return to you","e.g. $t0 .. $t9 $a0 .. $a3 $ra","f tells g if there is anything i want to preserve in these registers i have already saved it before calling you\ng tells f don't assume that these registers will be unchanged when i return to you\ne.g. $t0 .. $t9 $a0 .. $a3 $ra","f tells g i assume the values of these registers will be unchanged when you return","g tells f if i need to use these registers i will save them first and restore them before returning","e.g. $s0 .. $s7 $sp $fp","f tells g i assume the values of these registers will be unchanged when you return\ng tells f if i need to use these registers i will save them first and restore them before returning\ne.g. $s0 .. $s7 $sp $fp","one instruction can start before the previous one finishes","one instruction can start before the previous one finishes","instruction following branch is executed before branch completes","instruction following branch is executed before branch completes","$sp can change e.g. pushing params adding local vars","may need to reference local vars on the stack","useful if they can be defined by an offset relative to fixed point","$fp provides a fixed point during function code execution","$sp can change e.g. pushing params adding local vars\nmay need to reference local vars on the stack\nuseful if they can be defined by an offset relative to fixed point\n$fp provides a fixed point during function code execution","place 64-bit double args in $f12 and $f14","place 32-bit arguments in the $a0..$a3","if more than 4 args or args larger than 32-bits ... push value of all such args onto stack","push value of all such args onto stack","save any non-$s registers that need to be preserved push value of all such registers onto stack","push value of all such registers onto stack","jal address of function usually given by a label","place 64-bit double args in $f12 and $f14\nplace 32-bit arguments in the $a0..$a3\nif more than 4 args or args larger than 32-bits ... push value of all such args onto stack\npush value of all such args onto stack\nsave any non-$s registers that need to be preserved push value of all such registers onto stack\npush value of all such registers onto stack\njal address of function usually given by a label","push value of all such args onto stack","push value of all such args onto stack","push value of all such registers onto stack","push value of all such registers onto stack","create a stack frame for itself change $fp and $sp","save the return address $ra in the stack frame","save any $s registers that it plans to change","create a stack frame for itself change $fp and $sp\nsave the return address $ra in the stack frame\nsave any $s registers that it plans to change","4 bytes for saved $fp 4 bytes for saved $ra","4 bytes for each saved $s","4 bytes for saved $fp 4 bytes for saved $ra\n4 bytes for each saved $s","new $fp old $sp - 4","new $sp old $sp - size of frame in bytes","new $fp old $sp - 4\nnew $sp old $sp - size of frame in bytes","place the return value in $v0 and maybe $v1","pop any pushed arguments off the stack","restore the values of any saved $s registers","restore the saved value of $ra return address","remove its stack frame change $fp and $sp","return to the calling function jr $ra","place the return value in $v0 and maybe $v1\npop any pushed arguments off the stack\nrestore the values of any saved $s registers\nrestore the saved value of $ra return address\nremove its stack frame change $fp and $sp\nreturn to the calling function jr $ra","new $sp old $fp 4","new $fp memory old $fp","new $sp old $fp 4\nnew $fp memory old $fp","char ... as byte in memory or low-order byte in register","int ... as word in memory or whole register","double ... as two-words in memory or $f register","arrays ... sequence of memory bytes/words accessed by index","structs ... chunk of memory accessed by fields/offsets","linked structures ... struct containing address of another struct","char ... as byte in memory or low-order byte in register\nint ... as word in memory or whole register\ndouble ... as two-words in memory or $f register\narrays ... sequence of memory bytes/words accessed by index\nstructs ... chunk of memory accessed by fields/offsets\nlinked structures ... struct containing address of another struct","could be implemented in register if used in small scope","could be implemented on stack if local to function","could be implemented in .data if need longer persistence","could be implemented in register if used in small scope\ncould be implemented on stack if local to function\ncould be implemented in .data if need longer persistence","uninitialised memory allocated at compile/assemble-time e.g. int val val .space 4 char str 20 str .space 20 int vec 20 vec .space 80","initialised memory allocated at compile/assemble-time e.g. int val 5 val .word 5 int arr 4 9 8 7 6 arr .word 9 8 7 6 char msg hello n msg .asciiz hello n","uninitialised memory allocated at compile/assemble-time e.g. int val val .space 4 char str 20 str .space 20 int vec 20 vec .space 80\ninitialised memory allocated at compile/assemble-time e.g. int val 5 val .word 5 int arr 4 9 8 7 6 arr .word 9 8 7 6 char msg hello n msg .asciiz hello n","variables local to a function","variables local to a function","use space allocated on stack during function prologue","referenced during function relative to $fp","space reclaimed from stack in function epilogue","use space allocated on stack during function prologue\nreferenced during function relative to $fp\nspace reclaimed from stack in function epilogue","uninitialised block of memory allocated at run-time int ptr malloc sizeof int char str malloc 20 sizeof char int vec malloc 20 sizeof int ptr 5 strcpy str a string vec 0 1 // or vec 1 vec 1 6","initialised block of memory allocated at run-time int vec calloc 20 sizeof int // vec i 0 for i in 0..19","uninitialised block of memory allocated at run-time int ptr malloc sizeof int char str malloc 20 sizeof char int vec malloc 20 sizeof int ptr 5 strcpy str a string vec 0 1 // or vec 1 vec 1 6\ninitialised block of memory allocated at run-time int vec calloc 20 sizeof int // vec i 0 for i in 0..19","but provides syscall 9 to extend .data","before syscall set $a0 to the number of bytes requested","after syscall $v0 holds start address of allocated chunk","but provides syscall 9 to extend .data\nbefore syscall set $a0 to the number of bytes requested\nafter syscall $v0 holds start address of allocated chunk","a complete implementation of c's heap management i.e.","a large region of memory to manage syscall 9","ability to mark chunks of this region as in use with size","ability to maintain list of free chunks","ability to merge free chunks to prevent fragmentation","a complete implementation of c's heap management i.e.\na large region of memory to manage syscall 9\nability to mark chunks of this region as in use with size\nability to maintain list of free chunks\nability to merge free chunks to prevent fragmentation","either approach needs to account for size of elements","either approach needs to account for size of elements","must also pass array size since not available elsewhere","must also pass array size since not available elsewhere","makes things easier for a human to prodcue mips code","does not provide an automatic way of translating","this is provided by a compiler e.g. dcc","makes things easier for a human to prodcue mips code\ndoes not provide an automatic way of translating\nthis is provided by a compiler e.g. dcc","convert include and define","parse code to check syntactically valid","manage a list of symbols used in program","decide how to represent data structures","allocate local variables to registers or stack","map control structures to mips instructions","convert include and define\nparse code to check syntactically valid\nmanage a list of symbols used in program\ndecide how to represent data structures\nallocate local variables to registers or stack\nmap control structures to mips instructions","include file replace include by contents of file name.h ... uses named file.h ... uses file.h in /usr/include","replace include by contents of file","name.h ... uses named file.h","... uses file.h in /usr/include","define name constant replace all occurences of symbol name by constant e.g define max 5 char array max char array 5","replace all occurences of symbol name by constant","e.g define max 5 char array max char array 5","define name params expression replace name params by substitutedexpression e.g. define max x y x y x y a max b c a b c b c","replace name params by substitutedexpression","e.g. define max x y x y x y a max b c a b c b c","include file replace include by contents of file name.h ... uses named file.h ... uses file.h in /usr/include\nreplace include by contents of file\nname.h ... uses named file.h\n... uses file.h in /usr/include\ndefine name constant replace all occurences of symbol name by constant e.g define max 5 char array max char array 5\nreplace all occurences of symbol name by constant\ne.g define max 5 char array max char array 5\ndefine name params expression replace name params by substitutedexpression e.g. define max x y x y x y a max b c a b c b c\nreplace name params by substitutedexpression\ne.g. define max x y x y x y a max b c a b c b c","replace include by contents of file","name.h ... uses named file.h","... uses file.h in /usr/include","replace include by contents of file\nname.h ... uses named file.h\n... uses file.h in /usr/include","replace all occurences of symbol name by constant","e.g define max 5 char array max char array 5","replace all occurences of symbol name by constant\ne.g define max 5 char array max char array 5","replace name params by substitutedexpression","e.g. define max x y x y x y a max b c a b c b c","replace name params by substitutedexpression\ne.g. define max x y x y x y a max b c a b c b c","scope lifetime locally/externally defined","disambiguates e.g. x in main vs x in fun","resolves symbols to specific locations data/stack/registers","external symbols may remain unresolved until linking","however need to have a type for each external symbol","scope lifetime locally/externally defined\ndisambiguates e.g. x in main vs x in fun\nresolves symbols to specific locations data/stack/registers\nexternal symbols may remain unresolved until linking\nhowever need to have a type for each external symbol","on the stack ... persist for whole function -lw/sw needed in mips","in a register ... efficient -not many useful if var used in small scope if need to persist across function calls use $s register if used in very localised scope can use $t register","if need to persist across function calls use $s register","if used in very localised scope can use $t register","on the stack ... persist for whole function -lw/sw needed in mips\nin a register ... efficient -not many useful if var used in small scope if need to persist across function calls use $s register if used in very localised scope can use $t register\nif need to persist across function calls use $s register\nif used in very localised scope can use $t register","if need to persist across function calls use $s register","if used in very localised scope can use $t register","if need to persist across function calls use $s register\nif used in very localised scope can use $t register","even complex expressions don't generally need 3-4 registers","even complex expressions don't generally need 3-4 registers","c assembly language mips","instruction set architectures","cpu architecture2/114","a typical modern cpu has","why study assembler 3/114","useful to know assembly language because ...","instruction sets4/114","two broad families of instruction set architectures ...","risc reduced instruction set computer","... instruction sets5/114","machine-level instructions ...","operands and destination are typically registers","... instruction sets6/114","common kinds of instructions not from any real machine","... instruction sets7/114","other common kinds of instructions not from any real machine","... instruction sets8/114","fetch-execute cycle9/114","all cpus have program execution logic like","pc program counter a cpu register which keeps track of execution","note that some instructions may modify pc further e.g. jump","... fetch-execute cycle10/114","executing an instruction involves","assembly language11/114","instructions are simply bit patterns within a 32-bit bit-string","could describe machine programs as a sequence of hex digits e.g.","often call assembly language as assembler","slight notational abuse because assembler also refers to a program that translates assembly language to machine code","... assembly language12/114","assembler symbolic language for writing machine code","mips architecture13/114","mips is a well-known and relatively simple architecture","source code for browsing under /home/cs1521/spim/spim","mips vs spim14/114","mips is a machine architecture including instruction set","spim is an emulator for the mips instruction set","using spim15/114","three ways to execute mips code with spim","... using spim16/114","command-line tool","... using spim17/114","gui tool","mips machine archtecture18/114","mips cpu has","some registers have special uses e.g.","... mips machine archtecture19/114","registers and their usage","reg name notes $0 zero the value 0 not changeable $1 $at assembler temporary used to implement pseudo-ops $2 $v0 value from expression evaluation or function return $3 $v1 value from expression evaluation or function return $4 $a0 first argument to a function/subroutine if needed $5 $a1 second argument to a function/subroutine if needed $6 $a2 third argument to a function/subroutine if needed $7 $a3 fourth argument to a function/subroutine if needed $8..$15 $t0..$t7 temporary must be saved by caller to subroutine subroutine can overwrite","... mips machine archtecture20/114","more register usage ...","reg name notes $16..$23 $s0..$s7 safe function variable must not be overwritten by called subroutine $24..$25 $t8..$t9 temporary must be saved by caller to subroutine subroutine can overwrite $26..$27 $k0..$k1 for kernel use may change unexpectedly $28 $gp global pointer $29 $sp stack pointer $30 $fp frame pointer $31 $ra return address of most recent caller","... mips machine archtecture21/114","floating point register usage ...","reg notes $f0..$f2 hold floating-point function results $f4..$f10 temporary registers not preserved across function calls $f12..$f14 used for first two double-precision function arguments $f16..$f18 temporary registers used for expression evaluation $f20..$f30 saved registers value is preserved across function calls","notes","mips assembly language22/114","mips assembly language programs contain","... mips assembly language23/114","example mips assembler program","color coding label directive comment","... mips assembly language24/114","generic structure of mips programs","... mips assembly language25/114","another example mips assembler program","... mips assembly language26/114","mips programs assume the following memory layout","region address notes text 0x00400000 contains only instructions read-only cannot expand data 0x10000000 data objects readable/writeable can be expanded stack 0x7fffefff grows down from that address readable/writeable k_text 0x80000000 kernel code read-only only accessible kernel mode k_data 0x90000000 kernel data read/write only accessible kernel mode","mips instructions27/114","mips has several classes of instructions","... mips instructions28/114","mips instructions are 32-bits long and specify ...","addressing modes29/114","memory addresses can be given by","if $s0 contains 0x10000000 and var 0x100000008","... addressing modes30/114","addressing modes in mips","format address computation register address register contents of register k address k k register address k register symbol address symbol address of symbol symbol k address symbol k symbol k register address symbol k register","where k is a literal constant value e.g. 4 or 0x10000000","... addressing modes31/114","examples of load/store and addressing","operand sizes32/114","mips instructions can manipulate different-sized operands","leads to many opcodes for a conceptually single operation e.g.","mips instruction set33/114","the mips processor implements a base set of instructions e.g.","note use of $at register for intermediate results","... mips instruction set34/114","in describing instructions","syntaxsemantics $reg as source the content of the register reg reg $reg as destination value is stored in register reg reg value label references the associated address in c terms label addr any expression that yields an address e.g. label $reg addr as source the content of memory cell memory addr addr as destination value is stored in memory addr value","effectively ...","... mips instruction set35/114","examples of data movement instructions","examples of bit manipulation instructions","... mips instruction set36/114","examples of arithmetic instructions","... mips instruction set37/114","examples of testing and branching instructions","after each branch instruction execution continues at new pc location","... mips instruction set38/114","special jump instruction for invoking functions","... mips instruction set39/114","spim interacts with stdin/stdout via syscalls","servicecodeargumentsresult print_int1$a0 integer print_float2$f12 float print_double3$f12 double print_string4$a0 char read_int5 integer in $v0 read_float6 float in $f0 read_double7 double in $f0 read_string8$a0 buffer $a1 lengthstring in buffer including n 0","... mips instruction set40/114","directives instructions to assembler not mips instructions","mips programming41/114","writing directly in mips assembler is difficult impossible","strategy for producing likely correct mips code","... mips programming42/114","example translating c to mips","... mips programming43/114","simplified c makes extensive use of","... mips programming44/114","beware registers are shared by all parts of the code.","one function can overwrite value set by another function","after the function x 6 and y 120","it is sheer coincidence that y has the correct value.","... mips programming45/114","need to be careful managing registers","rendering c in mips46/114","c provides expression evaluation and assignment e.g.","sequence is easy s1 s2 mips s1 mips s2","... rendering c in mips47/114","simple example of assignment and sequence","arithmetic expressions48/114","expression evaluation involves","it is useful to minimise the number of registers involved in the evaluation","conditional statements49/114","conditional statements e.g. if","... conditional statements50/114","conditional statements e.g. if","... conditional statements51/114","example of if-then-else","... conditional statements52/114","could make switch by first converting to if","... conditional statements53/114","jump table an alternative implementation of switch","boolean expressions54/114","boolean expressions in c are short circuit","evaluates by","c99 standard defines return value for booleans expressions as 0 or 1","... boolean expressions55/114","similarly for disjunctions","evaluates by","c99 standard defines return value for booleans expressions as 0 or 1","iteration statements56/114","iteration e.g. while","treat for as a special case of while","... iteration statements57/114","example of iteration over an array","functions58/114","when we call a function","... functions59/114","data associated with function calls is placed on the mips stack.","... functions60/114","each function allocates a small section of the stack a frame","... functions61/114","how stack changes as functions are called and return","... functions62/114","register usage conventions when f calls g","... functions63/114","contents of a typical stack frame","aside mips branch delay slots64/114","the real mips architecture is pipelined to improve efficiency","a problem scenario and its solution branch delay slot","since spim is not pipelined the nop is not required","aside why do we need both $fp and $sp 65/114","during execution of a function","function calling protocol66/114","before one function calls another it needs to","... function calling protocol67/114","example simple function call","... function calling protocol68/114","simple function call","... function calling protocol69/114","execution of sum function","... function calling protocol70/114","example function f calls function g a b c d e f","... function calling protocol71/114","function call in mips","... function calling protocol72/114","execution of g function","structure of functions73/114","functions in mips have the following general structure","aim of prologue create environment for function to execute in.","function prologue74/114","before a function starts working it needs to ...","... function prologue75/114","example of function fx which uses $s0 $s1 $s2","... function prologue76/114","alternatively ... more explicit push","... function prologue77/114","alternatively ... relative to new $fp","function epilogue78/114","before a function returns it needs to ...","changing $fp and $sp ...","... function epilogue79/114","example of function fx which uses $s0 $s1 $s2","data structures and mips80/114","c data structures and their mips representations","static vs dynamic allocation81/114","static allocation","... static vs dynamic allocation82/114","dynamic allocation i","... static vs dynamic allocation83/114","example of local variables on the stack","... static vs dynamic allocation84/114","dynamic allocation ii","... static vs dynamic allocation85/114","spim doesn't provide malloc /free functions","cannot access allocated data by name need to retain address.","no way to free allocated data and no way to align data appropriately","... static vs dynamic allocation86/114","implementing c-like malloc and free in mips requires","1-d arrays in mips87/114","can be named/initialised as noted above","can access elements via index or cursor pointer","... 1-d arrays in mips88/114","scanning across an array of n elements using index","assumes the existence of a print function to do printf d n x","... 1-d arrays in mips89/114","scanning across an array of n elements using cursor","assumes the existence of a print function to do printf d n x","... 1-d arrays in mips90/114","arrays that are local to functions are allocated space on the stack","2-d arrays in mips91/114","2-d arrays could be represented two ways","... 2-d arrays in mips92/114","representations of int matrix 4 4 ...","now consider summing all elements","... 2-d arrays in mips93/114","accessing elements","... 2-d arrays in mips94/114","computing sum of all elements for strategy a int matrix 4 4","... 2-d arrays in mips95/114","computing sum of all elements for strategy b int matrix 4 4","structs in mips96/114","c structs hold a collection of values accessed by name","... structs in mips97/114","c struct definitions effectively define a new type.","instances of structures can be created by allocating space","... structs in mips98/114","accessing structure components is by offset not name","... structs in mips99/114","structs that are local to functions are allocated space on the stack","... structs in mips100/114","c can pass whole structures to functions e.g.","... structs in mips101/114","accessing struct within function ...","... structs in mips102/114","can also pass a pointer to a struct","clearly a more efficient way to pass a large struct","also required if the function needs to update the original struct","compiling c to mips103/114","using simplified c as an intermediate language","c pre-processor104/114","maps c c performing various substitutions","... c pre-processor105/114","more c pre-processor substitions","c parser106/114","understands syntax of c language","attempts to convert c program into parse tree","symbol table management107/114","compiler keeps track of names","local variables108/114","two choices for local variables","expression evaluation109/114","uses temporary $t registers","complex boolean expressions handled by short-circuit evaluation.","mapping control structures110/114","use templates e.g.","... mapping control structures111/114","template for if...else if... else","argc and argv112/114","the real mips machine has no idea about argc and argv","spim runs under linux and needs to interact with environment","so the initialisation code that invokes main sets them up","note we are ignoring envp environment pointer","... argc and argv113/114","what the main program receives","... argc and argv114/114","code to print the program's name argv 0","code to print the first cmd-line arg argv 1","produced 2 apr 2018","computer systems architecture, 1/21","evolution of operating systems oss, 2/21","... evolution of operating systems oss, 3/21","... evolution of operating systems oss, 4/21","operating systems, 5/21","... operating systems, 6/21","... operating systems, 7/21","... operating systems, 8/21","... operating systems, 9/21","... operating systems, 10/21","system calls, 11/21","... system calls, 12/21","libraries, 13/21","... libraries, 14/21","applications, 15/21","... applications, 16/21","... applications, 17/21","... applications, 18/21","... applications, 19/21","... applications, 20/21","roadmap, 21/21","no os ... one program at a time manually loaded","programs had to take account of details of machine/devices","no os ... one program at a time manually loaded\nprograms had to take account of details of machine/devices","batch processing ... load several programs at once run in sequence","programs had to take account of details of machine/devices","batch processing ... load several programs at once run in sequence\nprograms had to take account of details of machine/devices","computers proliferate ... programmers want to transport code","having to cope with different config on each machine was tedious","solution layer of software between raw machine and user programs","computers proliferate ... programmers want to transport code\nhaving to cope with different config on each machine was tedious\nsolution layer of software between raw machine and user programs","computers become smaller and faster but still fridge-size","complexity of 1960's oss drove bell labs researchers to develop a small os core written mostly in hll with a set of simple tools and ways of combining them led to the unix programming environment","develop a small os core written mostly in hll","with a set of simple tools and ways of combining them","led to the unix programming environment","writing os core in hll made it portable same os environment provided on many different machines","same os environment provided on many different machines","computers become smaller and faster but still fridge-size\ncomplexity of 1960's oss drove bell labs researchers to develop a small os core written mostly in hll with a set of simple tools and ways of combining them led to the unix programming environment\ndevelop a small os core written mostly in hll\nwith a set of simple tools and ways of combining them\nled to the unix programming environment\nwriting os core in hll made it portable same os environment provided on many different machines\nsame os environment provided on many different machines","develop a small os core written mostly in hll","with a set of simple tools and ways of combining them","led to the unix programming environment","develop a small os core written mostly in hll\nwith a set of simple tools and ways of combining them\nled to the unix programming environment","same os environment provided on many different machines","same os environment provided on many different machines","unix and variants ported to wide variety of architectures bsd sysv linux os x android all based on unix approach","bsd sysv linux os x android all based on unix approach","developments in hardware/software led to more os services databases o-o programming gui interfaces games networking multi-cpu systems mobile devices etc.","databases o-o programming gui interfaces games","networking multi-cpu systems mobile devices etc.","unix and variants ported to wide variety of architectures bsd sysv linux os x android all based on unix approach\nbsd sysv linux os x android all based on unix approach\ndevelopments in hardware/software led to more os services databases o-o programming gui interfaces games networking multi-cpu systems mobile devices etc.\ndatabases o-o programming gui interfaces games\nnetworking multi-cpu systems mobile devices etc.","bsd sysv linux os x android all based on unix approach","bsd sysv linux os x android all based on unix approach","databases o-o programming gui interfaces games","networking multi-cpu systems mobile devices etc.","databases o-o programming gui interfaces games\nnetworking multi-cpu systems mobile devices etc.","embedded systems phones workstations servers ...","embedded systems phones workstations servers ...","provide an abstraction layer on top of hardware","i.e. same view available regardless of underlying hardware","provide an abstraction layer on top of hardware\ni.e. same view available regardless of underlying hardware","have privileged access to the raw machine","manage use of machine resources cpu disk memory etc.","provide uniform interface to access machine-level operations","arrange for controlled execution of user programs","provide multi-tasking and pseudo parallelism","have privileged access to the raw machine\nmanage use of machine resources cpu disk memory etc.\nprovide uniform interface to access machine-level operations\narrange for controlled execution of user programs\nprovide multi-tasking and pseudo parallelism","batch e.g. eniac early ibm oss computational jobs run one-at-a-time via a queue","computational jobs run one-at-a-time via a queue","multi-user e.g. multics unix/linux osx windows mulitple jobs appear to run in parallel","mulitple jobs appear to run in parallel","embedded e.g. android ios ... small ish cut-down os embedded in a device","small ish cut-down os embedded in a device","real-time e.g. rtlinux duinos ... specialised os with time guarantees on job completion","specialised os with time guarantees on job completion","batch e.g. eniac early ibm oss computational jobs run one-at-a-time via a queue\ncomputational jobs run one-at-a-time via a queue\nmulti-user e.g. multics unix/linux osx windows mulitple jobs appear to run in parallel\nmulitple jobs appear to run in parallel\nembedded e.g. android ios ... small ish cut-down os embedded in a device\nsmall ish cut-down os embedded in a device\nreal-time e.g. rtlinux duinos ... specialised os with time guarantees on job completion\nspecialised os with time guarantees on job completion","computational jobs run one-at-a-time via a queue","computational jobs run one-at-a-time via a queue","mulitple jobs appear to run in parallel","mulitple jobs appear to run in parallel","small ish cut-down os embedded in a device","small ish cut-down os embedded in a device","specialised os with time guarantees on job completion","specialised os with time guarantees on job completion","users ... who can access login to the system","access rights ... what users are allowed to do","file system ... how data is organised on storage devices","input/output ... transferring data to/from devices","processes ... active computational entities on the system","communication ... how processes interact","networking ... how the system talks to other systems","users ... who can access login to the system\naccess rights ... what users are allowed to do\nfile system ... how data is organised on storage devices\ninput/output ... transferring data to/from devices\nprocesses ... active computational entities on the system\ncommunication ... how processes interact\nnetworking ... how the system talks to other systems","privileged mode full access to all machine operations and memory regions","full access to all machine operations and memory regions","non-privileged user mode a limited set of operations but still turing complete access to only part of the memory","a limited set of operations but still turing complete","access to only part of the memory","privileged mode full access to all machine operations and memory regions\nfull access to all machine operations and memory regions\nnon-privileged user mode a limited set of operations but still turing complete access to only part of the memory\na limited set of operations but still turing complete\naccess to only part of the memory","full access to all machine operations and memory regions","full access to all machine operations and memory regions","a limited set of operations but still turing complete","access to only part of the memory","a limited set of operations but still turing complete\naccess to only part of the memory","to cross the privileged/user boundary","in a controlled manner via well-defined requests","to cross the privileged/user boundary\nin a controlled manner via well-defined requests","primarily for i/o read/write on various types","also memory allocation and process exit","primarily for i/o read/write on various types\nalso memory allocation and process exit","process management e.g. fork exec _exit ...","file management e.g. open read fstat ...","device management e.g. ioctl ...","information maintenance e.g. settimeofday getuid ...","communication e.g. pipe connect send ...","process management e.g. fork exec _exit ...\nfile management e.g. open read fstat ...\ndevice management e.g. ioctl ...\ninformation maintenance e.g. settimeofday getuid ...\ncommunication e.g. pipe connect send ...","but system calls provide relatively low-level operations","but system calls provide relatively low-level operations","collections of useful functions","referenced from within user programs as c functions","defined by include","integrated with user code at link time","collections of useful functions\nreferenced from within user programs as c functions\ndefined by include\nintegrated with user code at link time","stdio.h ... text-oriented formatted input/output","stdlib.h ... wide range of functions e.g. rand malloc","stdio.h ... text-oriented formatted input/output\nstdlib.h ... wide range of functions e.g. rand malloc","possibly supplied with system e.g. ls vim gcc","possibly implemented by users e.g. dcc check webcms3","possibly supplied with system e.g. ls vim gcc\npossibly implemented by users e.g. dcc check webcms3","but may also make direct use of system calls","but may also make direct use of system calls","that runs as a user-level process not privileged","but can invoke other user-level processes","that runs as a user-level process not privileged\nbut can invoke other user-level processes","directly through a library of system calls documented in unix programmers manual section 2 e.g. man 2 open","documented in unix programmers manual section 2 e.g. man 2 open","indirectly through functions in the c libraries documented in unix programmers manual section 3 e.g. man 3 fopen","documented in unix programmers manual section 3 e.g. man 3 fopen","directly through a library of system calls documented in unix programmers manual section 2 e.g. man 2 open\ndocumented in unix programmers manual section 2 e.g. man 2 open\nindirectly through functions in the c libraries documented in unix programmers manual section 3 e.g. man 3 fopen\ndocumented in unix programmers manual section 3 e.g. man 3 fopen","documented in unix programmers manual section 2 e.g. man 2 open","documented in unix programmers manual section 2 e.g. man 2 open","documented in unix programmers manual section 3 e.g. man 3 fopen","documented in unix programmers manual section 3 e.g. man 3 fopen","file descriptors open close read write via include","file pointers file fopen fclose scanf printf via include","file descriptors open close read write via include\nfile pointers file fopen fclose scanf printf via include","check return value of sys call function -1 typically flags an error","check global variable errno contains specific error","check return value of sys call function -1 typically flags an error\ncheck global variable errno contains specific error","unlike other languages c provides no exception handling","unlike other languages c provides no exception handling","unless the sysetm call has a result value e.g. bytes read","unless the sysetm call has a result value e.g. bytes read","void perror char message","if message not null write to stderr","write standard message corresponding to errno","void perror char message\nif message not null write to stderr\nwrite standard message corresponding to errno","error status errnum format expressions ...","print error message using prog name format and expressions","if status is non-zero invoke exit status after printing message","if errnum is non-zero also print standard system error message","error status errnum format expressions ...\nprint error message using prog name format and expressions\nif status is non-zero invoke exit status after printing message\nif errnum is non-zero also print standard system error message","storage management disk storage filesystems unix file system interface","disk storage filesystems unix file system interface","memory management ram physical/virtual/process memory space page faults","ram physical/virtual/process memory space page faults","process management creating processes process hierarchy signals","creating processes process hierarchy signals","device management control registers data transfer interrupts","control registers data transfer interrupts","storage management disk storage filesystems unix file system interface\ndisk storage filesystems unix file system interface\nmemory management ram physical/virtual/process memory space page faults\nram physical/virtual/process memory space page faults\nprocess management creating processes process hierarchy signals\ncreating processes process hierarchy signals\ndevice management control registers data transfer interrupts\ncontrol registers data transfer interrupts","disk storage filesystems unix file system interface","disk storage filesystems unix file system interface","ram physical/virtual/process memory space page faults","ram physical/virtual/process memory space page faults","creating processes process hierarchy signals","creating processes process hierarchy signals","control registers data transfer interrupts","control registers data transfer interrupts","d computer systems architecture","computer systems architecture1/21","evolution of operating systems oss 2/21","1940's e.g. eniac","... evolution of operating systems oss 3/21","1970's e.g. pdp-11","... evolution of operating systems oss 4/21","1980's - present","operating systems5/21","modern computer devices connected via a system bus ...","... operating systems6/21","operating systems oss","... operating systems7/21","some different flavours of oss ...","... operating systems8/21","abstractions provided by modern oss","... operating systems9/21","... operating systems10/21","critical to os development execution modes","cpus can typically run in two modes","system calls11/21","spim has no os but provides a simple set of system calls","... system calls12/21","libraries13/21","user programs can request services via system calls","... libraries14/21","applications15/21","user-level programs which perform some useful task","applications are generally built using libraries","... applications16/21","... applications17/21","system calls are invoked ...","... applications18/21","system calls attempt to perform actions but may fail","user programs can detect this in several ways","... applications19/21","action in response to failed system call is often e.g.","can give more precise feedback via library functions e.g.","... applications20/21","linux library function to make it easy to report errors and exit","vs","roadmap21/21","following sections consider os modules","produced 8 apr 2018","storage management, ","storage management, 2/143","disks, 3/143","... disks, 4/143","... disks, 5/143","... disks, 6/143","ssds, 7/143","... ssds, 8/143","operating systems and storage, 9/143","file systems, ","file systems, 11/143","unix/linux file system, 12/143","... unix/linux file system, 13/143","... unix/linux file system, 14/143","... unix/linux file system, 15/143","... unix/linux file system, 16/143","file system operations, 17/143","open / close, 18/143","... open / close, 19/143","... open / close, 20/143","read / write, 21/143","... read / write, 22/143","... read / write, 23/143","... read / write, 24/143","... read / write, 25/143","seek, 26/143","... seek, 27/143","stat, 28/143","links, 29/143","... links, 30/143","... links, 31/143","... links, 32/143","... links, 33/143","... links, 34/143","file system summary, 35/143","memory management, ","memory, 37/143","processes, 38/143","memory management, 39/143","... memory management, 40/143","... memory management, 41/143","... memory management, 42/143","... memory management, 43/143","... memory management, 44/143","... memory management, 45/143","... memory management, 46/143","... memory management, 47/143","... memory management, 48/143","... memory management, 49/143","... memory management, 50/143","memory management review, 51/143","address mapping, 52/143","... address mapping, 53/143","virtual memory, 54/143","... virtual memory, 55/143","... virtual memory, 56/143","... virtual memory, 57/143","... virtual memory, 58/143","an aside working sets, 59/143","... an aside working sets, 60/143","virtual memory, 61/143","... virtual memory, 62/143","... virtual memory, 63/143","... virtual memory, 64/143","page faults, 65/143","... page faults, 66/143","page replacement, 67/143","... page replacement, 68/143","... page replacement, 69/143","... page replacement, 70/143","virtual memory, 71/143","... virtual memory, 72/143","... virtual memory, 73/143","cache memory, 74/143","... cache memory, 75/143","memory management hardware, 76/143","... memory management hardware, 77/143","process management, ","processes, 79/143","... processes, 80/143","... processes, 81/143","process management, 82/143","... process management, 83/143","unix/linux processes, 84/143","... unix/linux processes, 85/143","... unix/linux processes, 86/143","... unix/linux processes, 87/143","process-related system calls, 88/143","... process-related system calls, 89/143","... process-related system calls, 90/143","... process-related system calls, 91/143","... process-related system calls, 92/143","... process-related system calls, 93/143","... process-related system calls, 94/143","... process-related system calls, 95/143","... process-related system calls, 96/143","... process-related system calls, 97/143","... process-related system calls, 98/143","... process-related system calls, 99/143","... process-related system calls, 100/143","... process-related system calls, 101/143","... process-related system calls, 102/143","... process-related system calls, 103/143","... process-related system calls, 104/143","process control flow, 105/143","... process control flow, 106/143","... process control flow, 107/143","... process control flow, 108/143","signals, 109/143","... signals, 110/143","... signals, 111/143","signal handlers, 112/143","... signal handlers, 113/143","... signal handlers, 114/143","... signal handlers, 115/143","... signal handlers, 116/143","... signal handlers, 117/143","interrupts, 118/143","... interrupts, 119/143","... interrupts, 120/143","exceptions, 121/143","... exceptions, 122/143","multi-tasking, 123/143","process states, 124/143","scheduling, 125/143","... scheduling, 126/143","... scheduling, 127/143","device management, ","device management, 129/143","i/o devices, 130/143","... i/o devices, 131/143","... i/o devices, 132/143","... i/o devices, 133/143","... i/o devices, 134/143","device drivers, 135/143","memory-mapped i/o, 136/143","... memory-mapped i/o, 137/143","devices on unix/linux, 138/143","... devices on unix/linux, 139/143","... devices on unix/linux, 140/143","... devices on unix/linux, 141/143","buffered i/o, 142/143","... buffered i/o, 143/143","magnetic medium arranged in concentric tracks","usually multiple surfaces for storing data","rotates at very high speed e.g. 7200rpm","each track divided into fixed size sectors outer tracks have more sectors than inner tracks","outer tracks have more sectors than inner tracks","read/write head which can read/write one sector at-a-time","magnetic medium arranged in concentric tracks\nusually multiple surfaces for storing data\nrotates at very high speed e.g. 7200rpm\neach track divided into fixed size sectors outer tracks have more sectors than inner tracks\nouter tracks have more sectors than inner tracks\nread/write head which can read/write one sector at-a-time","outer tracks have more sectors than inner tracks","outer tracks have more sectors than inner tracks","head moves to track mechanical motion","head waits for sector to rotate under head mechanical","read/write data from/to disk surface electronic","head moves to track mechanical motion\nhead waits for sector to rotate under head mechanical\nread/write data from/to disk surface electronic","seek time move to track in range 0ms .. 12ms","rotational latency wait for sector in range 2ms .. 4ms","data transfer ... typically 200 mb/s relatively small","overall tens of milliseconds for a single access","seek time move to track in range 0ms .. 12ms\nrotational latency wait for sector in range 2ms .. 4ms\ndata transfer ... typically 200 mb/s relatively small\noverall tens of milliseconds for a single access","capacity ... 4tb ... available storage 3.5tb","size ... 2.5/3cm volume ... 34cm3 weight ... 60g","speed ... 20ms to find sector 1ms to read sector","capacity ... 4tb ... available storage 3.5tb\nsize ... 2.5/3cm volume ... 34cm3 weight ... 60g\nspeed ... 20ms to find sector 1ms to read sector","capacity ... 3mb ... available storage 2.5mb","size ... 1.5m volume ... 2m3 weight ... 900kg","speed ... 600ms to find sector 5ms to read sector","capacity ... 3mb ... available storage 2.5mb\nsize ... 1.5m volume ... 2m3 weight ... 900kg\nspeed ... 600ms to find sector 5ms to read sector","all data transfers read/write fixed number of bytes","even if only one byte is required","typical transfer size 512 bytes .. 4096 bytes","all data transfers read/write fixed number of bytes\neven if only one byte is required\ntypical transfer size 512 bytes .. 4096 bytes","each block comprised of one or more sectors","sectors for block arranged to minimse head movement/latency","each block comprised of one or more sectors\nsectors for block arranged to minimse head movement/latency","don't have mechanical delays that hdds do r/w much faster","better thermal performance that hdds e.g. no fans needed","controller more complex/spohisticated than hdd controller","relatively expensive per byte of storage compared to hdds","limited number of read/writes on each block before failure","data leaks over time over years ... but worse than hdds","writing requires erase-then-overwrite","susceptible to elector-magnetic fluctations e.g. power-outs","don't have mechanical delays that hdds do r/w much faster\nbetter thermal performance that hdds e.g. no fans needed\ncontroller more complex/spohisticated than hdd controller\nrelatively expensive per byte of storage compared to hdds\nlimited number of read/writes on each block before failure\ndata leaks over time over years ... but worse than hdds\nwriting requires erase-then-overwrite\nsusceptible to elector-magnetic fluctations e.g. power-outs","block-oriented devices but much faster than hdds e.g. 0.1ms","but limited number 105 of erases on each block before failure","easier to access logical blocks access to multiple ssd blocks","less fragmentation problems than hdds","block-oriented devices but much faster than hdds e.g. 0.1ms\nbut limited number 105 of erases on each block before failure\neasier to access logical blocks access to multiple ssd blocks\nless fragmentation problems than hdds","drop-in high-speed replacement for hdd","drop-in high-speed replacement for hdd","provides an abstract view of devices","hiding details of device control and data transfer","provides an abstract view of devices\nhiding details of device control and data transfer","typically on a disk device or nowadays on ssd","allocating chunks of space on the device to files where a file is viewed as a sequence of bytes","where a file is viewed as a sequence of bytes","allowing access to files by name and with access rights","arranging access to files via directories folders","maintaining information about files/directories meta-data","dealing with damage on the storage device bad blocks","typically on a disk device or nowadays on ssd\nallocating chunks of space on the device to files where a file is viewed as a sequence of bytes\nwhere a file is viewed as a sequence of bytes\nallowing access to files by name and with access rights\narranging access to files via directories folders\nmaintaining information about files/directories meta-data\ndealing with damage on the storage device bad blocks","where a file is viewed as a sequence of bytes","where a file is viewed as a sequence of bytes","current working directory cwd","current working directory cwd","files directories folders devices processes sockets ...","files directories folders devices processes sockets ...","absolute full path from root e.g. /usr/include/stdio.h /home/jas/cs1521/","relative path starts from cwd e.g. ../../another/path/prog.c ./a.out a.out","absolute full path from root e.g. /usr/include/stdio.h /home/jas/cs1521/\nrelative path starts from cwd e.g. ../../another/path/prog.c ./a.out a.out","off_t ... offsets within files typically long and signed to allow backward refs","typically long and signed to allow backward refs","size_t ... number of bytes in some object unsigned since objects can't have negative size","unsigned since objects can't have negative size","ssize_t ... sizes of read/written blocks like size_t but signed to allow for error values","like size_t but signed to allow for error values","struct stat ... file system object metadata stores information about file but stores no content requires ino_t dev_t time_t uid_t ...","stores information about file but stores no content","requires ino_t dev_t time_t uid_t ...","off_t ... offsets within files typically long and signed to allow backward refs\ntypically long and signed to allow backward refs\nsize_t ... number of bytes in some object unsigned since objects can't have negative size\nunsigned since objects can't have negative size\nssize_t ... sizes of read/written blocks like size_t but signed to allow for error values\nlike size_t but signed to allow for error values\nstruct stat ... file system object metadata stores information about file but stores no content requires ino_t dev_t time_t uid_t ...\nstores information about file but stores no content\nrequires ino_t dev_t time_t uid_t ...","typically long and signed to allow backward refs","typically long and signed to allow backward refs","unsigned since objects can't have negative size","unsigned since objects can't have negative size","like size_t but signed to allow for error values","like size_t but signed to allow for error values","stores information about file but stores no content","requires ino_t dev_t time_t uid_t ...","stores information about file but stores no content\nrequires ino_t dev_t time_t uid_t ...","physical location on storage device of file data","file type regular file directory ... file size bytes/blocks","ownership access permissions timestamps create/access/update","physical location on storage device of file data\nfile type regular file directory ... file size bytes/blocks\nownership access permissions timestamps create/access/update","where a directory is effectively a list of name inode pairs","where a directory is effectively a list of name inode pairs","open directory and scan for name","if not found no such file or directory","if found as name ino access inode table inodes ino","collect file metadata and ... check file access permissions given current user/group if don't have required access permission denied collect information about file's location and size update access timestamp","check file access permissions given current user/group if don't have required access permission denied","if don't have required access permission denied","collect information about file's location and size","update access timestamp","use physical location to access device and read/write file's data","open directory and scan for name\nif not found no such file or directory\nif found as name ino access inode table inodes ino\ncollect file metadata and ... check file access permissions given current user/group if don't have required access permission denied collect information about file's location and size update access timestamp\ncheck file access permissions given current user/group if don't have required access permission denied\nif don't have required access permission denied\ncollect information about file's location and size\nupdate access timestamp\nuse physical location to access device and read/write file's data","check file access permissions given current user/group if don't have required access permission denied","if don't have required access permission denied","collect information about file's location and size","update access timestamp","check file access permissions given current user/group if don't have required access permission denied\nif don't have required access permission denied\ncollect information about file's location and size\nupdate access timestamp","if don't have required access permission denied","if don't have required access permission denied","functions/syscalls manipulate objects as a stream of bytes","accessed via a file descriptor index into a system table","functions/syscalls manipulate objects as a stream of bytes\naccessed via a file descriptor index into a system table","open ... open a file system object returning a file descriptor","close ... stop using a file descriptor","read ... read some bytes into a buffer from a file descriptor","write ... write some bytes from a buffer to a file descriptor","lseek ... move to a specified offset within a file","stat ... get meta-data about a file system object","mount ... place a filesystem on a device","open ... open a file system object returning a file descriptor\nclose ... stop using a file descriptor\nread ... read some bytes into a buffer from a file descriptor\nwrite ... write some bytes from a buffer to a file descriptor\nlseek ... move to a specified offset within a file\nstat ... get meta-data about a file system object\nmount ... place a filesystem on a device","attempt to open an object at path according to flags","flags defined in o_rdonly ... open object for reading o_wronly ... open object for writing o_append ... open object for writing at end o_rdwr ... open object for reading and writing o_creat ... create object if doesn't exist","o_rdonly ... open object for reading","o_wronly ... open object for writing","o_append ... open object for writing at end","o_rdwr ... open object for reading and writing","o_creat ... create object if doesn't exist","flags can be combined e.g. o_wronly o_creat","if successful return file descriptor small ve int","if unsuccessful return -1 and set errno","attempt to open an object at path according to flags\nflags defined in o_rdonly ... open object for reading o_wronly ... open object for writing o_append ... open object for writing at end o_rdwr ... open object for reading and writing o_creat ... create object if doesn't exist\no_rdonly ... open object for reading\no_wronly ... open object for writing\no_append ... open object for writing at end\no_rdwr ... open object for reading and writing\no_creat ... create object if doesn't exist\nflags can be combined e.g. o_wronly o_creat\nif successful return file descriptor small ve int\nif unsuccessful return -1 and set errno","o_rdonly ... open object for reading","o_wronly ... open object for writing","o_append ... open object for writing at end","o_rdwr ... open object for reading and writing","o_creat ... create object if doesn't exist","o_rdonly ... open object for reading\no_wronly ... open object for writing\no_append ... open object for writing at end\no_rdwr ... open object for reading and writing\no_creat ... create object if doesn't exist","attempt to release an open file descriptor","if this is the last reference to object release its resources","if successful return 0","if unsuccessful return -1 and set errno","attempt to release an open file descriptor\nif this is the last reference to object release its resources\nif successful return 0\nif unsuccessful return -1 and set errno","removes the object's entry from a directory","but the inode and data persist until all processes accessing the object close their handle all references to the inode from other directories are removed","all processes accessing the object close their handle","all references to the inode from other directories are removed","after this the inode and the blocks on storage device are recycled","removes the object's entry from a directory\nbut the inode and data persist until all processes accessing the object close their handle all references to the inode from other directories are removed\nall processes accessing the object close their handle\nall references to the inode from other directories are removed\nafter this the inode and the blocks on storage device are recycled","all processes accessing the object close their handle","all references to the inode from other directories are removed","all processes accessing the object close their handle\nall references to the inode from other directories are removed","attempt to read count bytes from filedesc into buffer","if successful return number of bytes actually read nread","if currently positioned at end of file return 0","if unsuccessful return -1 and set errno","does not check whether buffer contains enough space","advances the file offset by nread","does not treat ' n' as special","attempt to read count bytes from filedesc into buffer\nif successful return number of bytes actually read nread\nif currently positioned at end of file return 0\nif unsuccessful return -1 and set errno\ndoes not check whether buffer contains enough space\nadvances the file offset by nread\ndoes not treat ' n' as special","the current position in the file is maintained as part of the fd entry","the current position is modified by read write and lseek","the current position in the file is maintained as part of the fd entry\nthe current position is modified by read write and lseek","attempt to write count bytes from buffer onto filedesc","if successful return number of bytes actually written nwritten","if unsuccessful return -1 and set errno","does not check whether buffer has count bytes of data","advances the file offset by nwritten bytes","attempt to write count bytes from buffer onto filedesc\nif successful return number of bytes actually written nwritten\nif unsuccessful return -1 and set errno\ndoes not check whether buffer has count bytes of data\nadvances the file offset by nwritten bytes","bytes can be interpreted as char int struct etc","so many kinds of objects can be read or write","bytes can be interpreted as char int struct etc\nso many kinds of objects can be read or write","list of double values read from sensor device","collection of student records","list of double values read from sensor device\ncollection of student records","because they refer to memory addresses within a process instance","and a different process instance might already have used those addresses","because they refer to memory addresses within a process instance\nand a different process instance might already have used those addresses","either write ing chunks of bytes from struct objects","or printing formatted text representation of struct data","either write ing chunks of bytes from struct objects\nor printing formatted text representation of struct data","no need to worry about formatting issues","writes entire structure even if string buffers half empty","can lseek to ith struct via i sizeof structtype","no need to worry about formatting issues\nwrites entire structure even if string buffers half empty\ncan lseek to ith struct via i sizeof structtype","produces files that are human-readable","only uses as many bytes as required from string buffers","can access structures only sequentially unless using padding","produces files that are human-readable\nonly uses as many bytes as required from string buffers\ncan access structures only sequentially unless using padding","set the current position of the filedesc","offset is in units of bytes and can be negative","whence can be one of ... seek_set ... set file position to offset from start of file seek_cur ... set file position to offset from current position seek_end ... set file position to offset from end of file","seek_set ... set file position to offset from start of file","seek_cur ... set file position to offset from current position","seek_end ... set file position to offset from end of file","seeking beyond end of file leaves a gap which reads as 0's","seeking back beyond start of file sets position to start of file","set the current position of the filedesc\noffset is in units of bytes and can be negative\nwhence can be one of ... seek_set ... set file position to offset from start of file seek_cur ... set file position to offset from current position seek_end ... set file position to offset from end of file\nseek_set ... set file position to offset from start of file\nseek_cur ... set file position to offset from current position\nseek_end ... set file position to offset from end of file\nseeking beyond end of file leaves a gap which reads as 0's\nseeking back beyond start of file sets position to start of file","seek_set ... set file position to offset from start of file","seek_cur ... set file position to offset from current position","seek_end ... set file position to offset from end of file","seek_set ... set file position to offset from start of file\nseek_cur ... set file position to offset from current position\nseek_end ... set file position to offset from end of file","stores meta-data associated with filename into statbuf","information includes inode number file type access mode owner group size in bytes storage block size allocated blocks time of last access/modification/status-change","inode number file type access mode owner group","size in bytes storage block size allocated blocks","time of last access/modification/status-change","returns -1 and sets errno if meta-data not accessible","if filename is a symbolic link returns info on referenced file","stores meta-data associated with filename into statbuf\ninformation includes inode number file type access mode owner group size in bytes storage block size allocated blocks time of last access/modification/status-change\ninode number file type access mode owner group\nsize in bytes storage block size allocated blocks\ntime of last access/modification/status-change\nreturns -1 and sets errno if meta-data not accessible\nif filename is a symbolic link returns info on referenced file","inode number file type access mode owner group","size in bytes storage block size allocated blocks","time of last access/modification/status-change","inode number file type access mode owner group\nsize in bytes storage block size allocated blocks\ntime of last access/modification/status-change","same as stat but gets data via an open file descriptor","same as stat but gets data via an open file descriptor","same as stat but doesn't follow symbolic links","same as stat but doesn't follow symbolic links","multiple directory entries referencing the same inode","the two entries must be on the same filesystem","multiple directory entries referencing the same inode\nthe two entries must be on the same filesystem","a file containing the path name of another file","opening the symlink opens the file being referenced","a file containing the path name of another file\nopening the symlink opens the file being referenced","create a new directory called pathname with mode mode","if pathname is e.g. a/b/c/d all of the directories a b and c must exist directory c must be writeable to the caller directory d must not already exist","all of the directories a b and c must exist","directory c must be writeable to the caller","directory d must not already exist","the new directory contains two initial entries . is a reference to itself .. is a reference to its parent directory",". is a reference to itself",".. is a reference to its parent directory","returns 0 if successful returns -1 and sets errno otherwise","create a new directory called pathname with mode mode\nif pathname is e.g. a/b/c/d all of the directories a b and c must exist directory c must be writeable to the caller directory d must not already exist\nall of the directories a b and c must exist\ndirectory c must be writeable to the caller\ndirectory d must not already exist\nthe new directory contains two initial entries . is a reference to itself .. is a reference to its parent directory\n. is a reference to itself\n.. is a reference to its parent directory\nreturns 0 if successful returns -1 and sets errno otherwise","all of the directories a b and c must exist","directory c must be writeable to the caller","directory d must not already exist","all of the directories a b and c must exist\ndirectory c must be writeable to the caller\ndirectory d must not already exist",". is a reference to itself",".. is a reference to its parent directory",". is a reference to itself\n.. is a reference to its parent directory","ensure that data associated with filedesc is written to storage","ensure that data associated with filedesc is written to storage","data written to a file is initially stored in memory buffers","eventually it makes its way onto permanent storage device","fsync forces this to happen now","data written to a file is initially stored in memory buffers\neventually it makes its way onto permanent storage device\nfsync forces this to happen now","fsync is normally called just once at process exit","fsync is normally called just once at process exit","file systems normally exist on permanent storage devices","mount attaches a file system to a specific location in the file hierarchy","source is often a storage device e.g. /dev/disk","source contains a file system inode table data chunks","target aka mount point is a path in the file hierarchy","filesystype specifies a particular layout/drivers","flags specify various properties of the filesys e.g. read-only","file systems normally exist on permanent storage devices\nmount attaches a file system to a specific location in the file hierarchy\nsource is often a storage device e.g. /dev/disk\nsource contains a file system inode table data chunks\ntarget aka mount point is a path in the file hierarchy\nfilesystype specifies a particular layout/drivers\nflags specify various properties of the filesys e.g. read-only","as an abstraction over physical storage devices e.g. disks","providing named access to chunks of related data files","providing access sequential/random to the contents of files","allowing files to be arranged in a hierarchy of directories","providing control over access to files and directories","managing other meta-data associated with files size location ...","as an abstraction over physical storage devices e.g. disks\nproviding named access to chunks of related data files\nproviding access sequential/random to the contents of files\nallowing files to be arranged in a hierarchy of directories\nproviding control over access to files and directories\nmanaging other meta-data associated with files size location ...","memory processes processor time i/o devices networking ...","memory processes processor time i/o devices networking ...","ram code read-only data read/write","registers program counter pc and other registers","other management info discussed later","ram code read-only data read/write\nregisters program counter pc and other registers\nother management info discussed later","typically not all loaded in ram at once","processes can be suspended waiting","restoring a process load code data registers","typically not all loaded in ram at once\nprocesses can be suspended waiting\nrestoring a process load code data registers","the process can use the entire memory","addresses within process code are absolute","the process can use the entire memory\naddresses within process code are absolute","addreses in proc1 are absolute","all addresses in proc2 need to be interpreted relative to p1size","addreses in proc1 are absolute\nall addresses in proc2 need to be interpreted relative to p1size","copy code data to memory starting at address 0","set stack pointer to p1size-4","copy code data to memory starting at address 0\nset stack pointer to p1size-4","fix them when process code data is loaded replace each address in code by addr p1size","replace each address in code by addr p1size","map addresses during execution after a memory address is computed in machine code incremement it by p1size before accessing memory requires extra hardware holding proc2's start address","after a memory address is computed in machine code","incremement it by p1size before accessing memory","requires extra hardware holding proc2's start address","fix them when process code data is loaded replace each address in code by addr p1size\nreplace each address in code by addr p1size\nmap addresses during execution after a memory address is computed in machine code incremement it by p1size before accessing memory requires extra hardware holding proc2's start address\nafter a memory address is computed in machine code\nincremement it by p1size before accessing memory\nrequires extra hardware holding proc2's start address","replace each address in code by addr p1size","replace each address in code by addr p1size","after a memory address is computed in machine code","incremement it by p1size before accessing memory","requires extra hardware holding proc2's start address","after a memory address is computed in machine code\nincremement it by p1size before accessing memory\nrequires extra hardware holding proc2's start address","remember base address for each process process table","when process re starts load base into mapping hardware","interpret every address addr in program as base addr","remember base address for each process process table\nwhen process re starts load base into mapping hardware\ninterpret every address addr in program as base addr","process can be loaded anywhere in memory without change","process can be loaded anywhere in memory without change","each chunk of process address space has its own base","each chunk of process address space has its own size","each chunk of process address space has its own memory location","each chunk of process address space has its own base\neach chunk of process address space has its own size\neach chunk of process address space has its own memory location","call each chunk of address space a page","all pages are the same size p pagesize","process memory is spread across procsize/p pages","page i has addresses a in range i p a i 1 p","call each chunk of address space a page\nall pages are the same size p pagesize\nprocess memory is spread across procsize/p pages\npage i has addresses a in range i p a i 1 p","each process has an array of page entries","each page entry contains start address of one chunk","can compute index of relevant page entry by a / p","can compute offset within page by a p","each process has an array of page entries\neach page entry contains start address of one chunk\ncan compute index of relevant page entry by a / p\ncan compute offset within page by a p","process has virtual address space 0..n-1 bytes","memory has physical address space 0..m-1 bytes","both address spaces partitioned in p byte pages","process address space contains k n/p pages","memory address space has l m/p frames","process has virtual address space 0..n-1 bytes\nmemory has physical address space 0..m-1 bytes\nboth address spaces partitioned in p byte pages\nprocess address space contains k n/p pages\nmemory address space has l m/p frames","takes address vaddr in process address space","returns address paddr in memory address space","takes address vaddr in process address space\nreturns address paddr in memory address space","to save space just store frame number f","compute physical address via p f offset","to save space just store frame number f\ncompute physical address via p f offset","don't need to load all of process's pages up-front","start with a small memory footprint e.g. main stack top","load new process address pages into memory as needed","grow up to the size of the available physical memory","don't need to load all of process's pages up-front\nstart with a small memory footprint e.g. main stack top\nload new process address pages into memory as needed\ngrow up to the size of the available physical memory","dividing process memory space into fixed-size pages","on-demand loading of process pages into physical memory","dividing process memory space into fixed-size pages\non-demand loading of process pages into physical memory","each page table entry pte contains page status ... loaded ismodified notloaded frame number of page if loaded ... maybe others ... e.g. last accessed time","page status ... loaded ismodified notloaded","frame number of page if loaded","... maybe others ... e.g. last accessed time","we need procsize /pagesize entries in this table","each page table entry pte contains page status ... loaded ismodified notloaded frame number of page if loaded ... maybe others ... e.g. last accessed time\npage status ... loaded ismodified notloaded\nframe number of page if loaded\n... maybe others ... e.g. last accessed time\nwe need procsize /pagesize entries in this table","page status ... loaded ismodified notloaded","frame number of page if loaded","... maybe others ... e.g. last accessed time","page status ... loaded ismodified notloaded\nframe number of page if loaded\n... maybe others ... e.g. last accessed time","initially has zero pages loaded","load page containing code for main","load page for main 's stack frame","load other pages when process references address within page","initially has zero pages loaded\nload page containing code for main\nload page for main 's stack frame\nload other pages when process references address within page","in any given window of time a process is likely to access only a small subset of its pages","in any given window of time a process is likely to access only a small subset of its pages","if each process has a relatively small working set can hold pages for many active processes in memory at same time","if only need to hold some of process's pages in memory process address space can be larger than physical memory","if each process has a relatively small working set can hold pages for many active processes in memory at same time\nif only need to hold some of process's pages in memory process address space can be larger than physical memory","code is loaded from the executable file stored on disk","global data is also initially loaded from here","dynamic heap stack data is created in memory","code is loaded from the executable file stored on disk\nglobal data is also initially loaded from here\ndynamic heap stack data is created in memory","may need to be removed temporarily from memory see later","thus would also be saved on disk and restored from disk","may need to be removed temporarily from memory see later\nthus would also be saved on disk and restored from disk","exists on disk for the duration of the process's execution","and only some parts of it are in memory at any given time","exists on disk for the duration of the process's execution\nand only some parts of it are in memory at any given time","need to ensure minimal reading from / writing to disk","need to ensure minimal reading from / writing to disk","find a free unused page frame in memory and use that","find a free unused page frame in memory and use that","suspend the requesting process until a page is freed","replace one of the currently loaded/used pages","suspend the requesting process until a page is freed\nreplace one of the currently loaded/used pages","maintain a priority queue of processes waiting for pages","dequeue and schedule the first process on queue when page freed","maintain a priority queue of processes waiting for pages\ndequeue and schedule the first process on queue when page freed","if it's been modified since loading save to disk in the disk-based virtual memory space of the running process","grab its frame number and give it to the requestor","if it's been modified since loading save to disk in the disk-based virtual memory space of the running process\ngrab its frame number and give it to the requestor","define a usefulness measure for each frame","grab the frame with lowest usefulness e.g. priority queue","define a usefulness measure for each frame\ngrab the frame with lowest usefulness e.g. priority queue","best page is one that won't be used again by its process","prefer pages that are read-only no need to write to disk","prefer pages that are unmodified no need to write to disk","prefer pages that are used by only one process see later","best page is one that won't be used again by its process\nprefer pages that are read-only no need to write to disk\nprefer pages that are unmodified no need to write to disk\nprefer pages that are used by only one process see later","a page not used recently may not be needed again soon","a page not used recently may not be needed again soon","we replace a page which is soon used again","this causes us to replace another page","and the second page is soon used again ......","we replace a page which is soon used again\nthis causes us to replace another page\nand the second page is soon used again ......","recently used page is likely to be used again soon","not recently used page is unlikely to be used again soon","recently used page is likely to be used again soon\nnot recently used page is unlikely to be used again soon","page frames are entered into a queue when loaded","page replacement uses the frame from the front of the queue","page frames are entered into a queue when loaded\npage replacement uses the frame from the front of the queue","uses a reference bit for each frame updated when page is used","maintains a circular list of allocated frames","uses a clock hand which iterates over page frame list skipping and resetting reference bit in all referenced pages","skipping and resetting reference bit in all referenced pages","page replacement uses first-found unreferenced frame","uses a reference bit for each frame updated when page is used\nmaintains a circular list of allocated frames\nuses a clock hand which iterates over page frame list skipping and resetting reference bit in all referenced pages\nskipping and resetting reference bit in all referenced pages\npage replacement uses first-found unreferenced frame","skipping and resetting reference bit in all referenced pages","skipping and resetting reference bit in all referenced pages","a virtual address space with k pages needs k pt entries","since k may be large do not want to store whole pt","especially since working set tells us n k needed at once","a virtual address space with k pages needs k pt entries\nsince k may be large do not want to store whole pt\nespecially since working set tells us n k needed at once","several processes include same frame in virtual address space","several processes include same frame in virtual address space","holds parts of ram that are hopefully heavily used","transfers data to/from ram in blocks cache blocks","memory reference hardware first looks in cache if required address is there use its contents if not get it from ram and put in cache possibly replacing an existing cache block","if required address is there use its contents","if not get it from ram and put in cache","possibly replacing an existing cache block","replacement strategies have similar issues to virtual memory","holds parts of ram that are hopefully heavily used\ntransfers data to/from ram in blocks cache blocks\nmemory reference hardware first looks in cache if required address is there use its contents if not get it from ram and put in cache possibly replacing an existing cache block\nif required address is there use its contents\nif not get it from ram and put in cache\npossibly replacing an existing cache block\nreplacement strategies have similar issues to virtual memory","if required address is there use its contents","if not get it from ram and put in cache","possibly replacing an existing cache block","if required address is there use its contents\nif not get it from ram and put in cache\npossibly replacing an existing cache block","provide specialised hardware mmu to do it efficiently","sometimes located on cpu chip sometimes separate","provide specialised hardware mmu to do it efficiently\nsometimes located on cpu chip sometimes separate","lookup table containing virtual physical address pairs","lookup table containing virtual physical address pairs","multi-tasking provided by all modern operating systems","multi-tasking provided by all modern operating systems","control-flow independence each process executes as if the only process running on the machine","each process executes as if the only process running on the machine","private address space each process has its own address space m bytes addressed 0..m-1","each process has its own address space m bytes addressed 0..m-1","control-flow independence each process executes as if the only process running on the machine\neach process executes as if the only process running on the machine\nprivate address space each process has its own address space m bytes addressed 0..m-1\neach process has its own address space m bytes addressed 0..m-1","each process executes as if the only process running on the machine","each process executes as if the only process running on the machine","each process has its own address space m bytes addressed 0..m-1","each process has its own address space m bytes addressed 0..m-1","each process uses the cpu until pre-empted or exits","then another process uses the cpu until it too is pre-empted","eventually the first process will get another run on the cpu","each process uses the cpu until pre-empted or exits\nthen another process uses the cpu until it too is pre-empted\neventually the first process will get another run on the cpu","it runs long enough and the os replaces it by a waiting process","it attempts to perform a long-duration task like i/o","it runs long enough and the os replaces it by a waiting process\nit attempts to perform a long-duration task like i/o","the process's entire dynamic state must be saved incl pc","the process is flagged as temporarily suspended","it is placed on a process priority queue for re-start","the process's entire dynamic state must be saved incl pc\nthe process is flagged as temporarily suspended\nit is placed on a process priority queue for re-start","static information program code and data","dynamic state heap stack registers program counter","os-supplied state environment variables stdin stdout","static information program code and data\ndynamic state heap stack registers program counter\nos-supplied state environment variables stdin stdout","save context for one process","restore context for another process","save context for one process\nrestore context for another process","identifier unique process id","status running ready suspended dead","state registers including pc","privileges owner group","if suspended event being waited for","memory management info reference to page table","accounting cpu time used amount of i/o done","i/o open file descriptors","identifier unique process id\nstatus running ready suspended dead\nstate registers including pc\nprivileges owner group\nif suspended event being waited for\nmemory management info reference to page table\naccounting cpu time used amount of i/o done\ni/o open file descriptors","sh ... for creating processes via object-file name","ps w top ... show process information","kill ... send a signal to a process","sh ... for creating processes via object-file name\nps w top ... show process information\nkill ... send a signal to a process","fork ... create a new child process copy of current process","execve ... convert one process into another","wait ... wait for state change in child process","kill ... send a signal to a process","_exit ... terminate an executing process after clean up","fork ... create a new child process copy of current process\nexecve ... convert one process into another\nwait ... wait for state change in child process\nkill ... send a signal to a process\n_exit ... terminate an executing process after clean up","pid ...process id unique among current processes","ruid euid ... real and effective user id","rgid egid ... real and effective group id","current working directory","accumulated execution time user/kernel","user file descriptor table","information on how to react to signals","pointer to process page table","process state ... running suspended asleep etc.","pid ...process id unique among current processes\nruid euid ... real and effective user id\nrgid egid ... real and effective group id\ncurrent working directory\naccumulated execution time user/kernel\nuser file descriptor table\ninformation on how to react to signals\npointer to process page table\nprocess state ... running suspended asleep etc.","memory-resident since very heavily used","contains info as described above for pcb","content of pcb entry critical for scheduler","memory-resident since very heavily used\ncontains info as described above for pcb\ncontent of pcb entry critical for scheduler","holds info not needed when process swapped out","e.g. execution state registers signal handlers file descriptors ...","holds info not needed when process swapped out\ne.g. execution state registers signal handlers file descriptors ...","requires include","creates new process by duplicating the calling process","new process is the child calling process is the parent","child has a different process id pid to the parent","in the child fork returns 0","in the parent fork returns the pid of the child","if the system call fails fork returns -1","child inherits copies of parent's address space and open fd's","requires include\ncreates new process by duplicating the calling process\nnew process is the child calling process is the parent\nchild has a different process id pid to the parent\nin the child fork returns 0\nin the parent fork returns the pid of the child\nif the system call fails fork returns -1\nchild inherits copies of parent's address space and open fd's","a ve integer unique among currently executing processes","with type pid_t defined in","process 0 is the scheduler part of kernel","process 1 is init for starting/stopping the system","low-numbered processes are typically system-related","regular processes have pid in the range 300 .. maxpid e.g. 216","a ve integer unique among currently executing processes\nwith type pid_t defined in\nprocess 0 is the scheduler part of kernel\nprocess 1 is init for starting/stopping the system\nlow-numbered processes are typically system-related\nregular processes have pid in the range 300 .. maxpid e.g. 216","each group is associated with a unique pgid","groups allow distribution of signals to a set of related processes","one important application job control control-z","each group is associated with a unique pgid\ngroups allow distribution of signals to a set of related processes\none important application job control control-z","requires include","returns the process id of the current process","requires include\nreturns the process id of the current process","requires include","returns the parent process id of the current process","requires include\nreturns the parent process id of the current process","a signal can be sent to all processes in a process group","a signal can be sent to all processes in a process group","returns the process group id of specified process","if pid is zero use get pgid of current process","returns the process group id of specified process\nif pid is zero use get pgid of current process","set the process group id of specified process","set the process group id of specified process","pause current process until process pid changes state where state changes include finishing stopping re-starting ...","where state changes include finishing stopping re-starting ...","ensures that child resources are released on exit","special values for pid ... if pid -1 wait on any child process if pid 0 wait on any child in process group if pid 0 wait on the specified process","if pid -1 wait on any child process","if pid 0 wait on any child in process group","if pid 0 wait on the specified process","pause current process until process pid changes state where state changes include finishing stopping re-starting ...\nwhere state changes include finishing stopping re-starting ...\nensures that child resources are released on exit\nspecial values for pid ... if pid -1 wait on any child process if pid 0 wait on any child in process group if pid 0 wait on the specified process\nif pid -1 wait on any child process\nif pid 0 wait on any child in process group\nif pid 0 wait on the specified process","where state changes include finishing stopping re-starting ...","where state changes include finishing stopping re-starting ...","if pid -1 wait on any child process","if pid 0 wait on any child in process group","if pid 0 wait on the specified process","if pid -1 wait on any child process\nif pid 0 wait on any child in process group\nif pid 0 wait on the specified process","equivalent to waitpid -1 status 0","pauses until one of the child processes terminates","equivalent to waitpid -1 status 0\npauses until one of the child processes terminates","status is set to hold info about pid e.g. exit status if pid terminated macros allow precise determination of state change e.g. wifexited status wcoredump status","e.g. exit status if pid terminated","macros allow precise determination of state change e.g. wifexited status wcoredump status","options provide variations in waitpid behaviour default wait for child process to terminate wnohang return immediately if no child has exited wcontinued return if a stopped child has been restarted","default wait for child process to terminate","wnohang return immediately if no child has exited","wcontinued return if a stopped child has been restarted","status is set to hold info about pid e.g. exit status if pid terminated macros allow precise determination of state change e.g. wifexited status wcoredump status\ne.g. exit status if pid terminated\nmacros allow precise determination of state change e.g. wifexited status wcoredump status\noptions provide variations in waitpid behaviour default wait for child process to terminate wnohang return immediately if no child has exited wcontinued return if a stopped child has been restarted\ndefault wait for child process to terminate\nwnohang return immediately if no child has exited\nwcontinued return if a stopped child has been restarted","e.g. exit status if pid terminated","macros allow precise determination of state change e.g. wifexited status wcoredump status","e.g. exit status if pid terminated\nmacros allow precise determination of state change e.g. wifexited status wcoredump status","default wait for child process to terminate","wnohang return immediately if no child has exited","wcontinued return if a stopped child has been restarted","default wait for child process to terminate\nwnohang return immediately if no child has exited\nwcontinued return if a stopped child has been restarted","requires include","send signal sigid to process procid","various signals posix e.g. sighup ... hangup detected on controlling terminal/process sigint ... interrupt from keyboard control-c sigkill ... kill signal e.g. kill -9 sigill ... illegal instruction sigfpe ... floating point exception e.g. divide by zero sigsegv ... invalid memory reference sigpipe ... broken pipe no processes reading from pipe","sighup ... hangup detected on controlling terminal/process","sigint ... interrupt from keyboard control-c","sigkill ... kill signal e.g. kill -9","sigill ... illegal instruction","sigfpe ... floating point exception e.g. divide by zero","sigsegv ... invalid memory reference","sigpipe ... broken pipe no processes reading from pipe","if successful return 0 on error return -1 and set errno","requires include\nsend signal sigid to process procid\nvarious signals posix e.g. sighup ... hangup detected on controlling terminal/process sigint ... interrupt from keyboard control-c sigkill ... kill signal e.g. kill -9 sigill ... illegal instruction sigfpe ... floating point exception e.g. divide by zero sigsegv ... invalid memory reference sigpipe ... broken pipe no processes reading from pipe\nsighup ... hangup detected on controlling terminal/process\nsigint ... interrupt from keyboard control-c\nsigkill ... kill signal e.g. kill -9\nsigill ... illegal instruction\nsigfpe ... floating point exception e.g. divide by zero\nsigsegv ... invalid memory reference\nsigpipe ... broken pipe no processes reading from pipe\nif successful return 0 on error return -1 and set errno","sighup ... hangup detected on controlling terminal/process","sigint ... interrupt from keyboard control-c","sigkill ... kill signal e.g. kill -9","sigill ... illegal instruction","sigfpe ... floating point exception e.g. divide by zero","sigsegv ... invalid memory reference","sigpipe ... broken pipe no processes reading from pipe","sighup ... hangup detected on controlling terminal/process\nsigint ... interrupt from keyboard control-c\nsigkill ... kill signal e.g. kill -9\nsigill ... illegal instruction\nsigfpe ... floating point exception e.g. divide by zero\nsigsegv ... invalid memory reference\nsigpipe ... broken pipe no processes reading from pipe","terminates current process","closes any open file descriptors","a sigchld signal is sent to parent","returns status to parent via wait","any child processes are inherited by scheduler pid 1","termination may be delayed waiting for i/o to complete","terminates current process\ncloses any open file descriptors\na sigchld signal is sent to parent\nreturns status to parent via wait\nany child processes are inherited by scheduler pid 1\ntermination may be delayed waiting for i/o to complete","terminates current process","triggers any functions registered as on_exit","flushes stdio buffers closes open file 's","then behaves like _exit","terminates current process\ntriggers any functions registered as on_exit\nflushes stdio buffers closes open file 's\nthen behaves like _exit","generates sigabrt signal normally terminates process","closes and flushes stdio streams","used by the assert macro","generates sigabrt signal normally terminates process\ncloses and flushes stdio streams\nused by the assert macro","all processes become zombie until sigchld handled","parent may be delayed e.g. slow i/o but usually resolves quickly","bug in parent that ignores sigchld creates long-term zombies","note that zombies occupy a slot in the process table","all processes become zombie until sigchld handled\nparent may be delayed e.g. slow i/o but usually resolves quickly\nbug in parent that ignores sigchld creates long-term zombies\nnote that zombies occupy a slot in the process table","when parent exits orphan is assigned pid 1 as its parent","pid 1 always handles sigchld when process exits","when parent exits orphan is assigned pid 1 as its parent\npid 1 always handles sigchld when process exits","replaces current process by executing path object path must be an executable binary or script starting with","path must be an executable binary or script starting with","passes arrays of strings to new process both arrays terminated by a null pointer element envp contains strings of the form key value","both arrays terminated by a null pointer element","envp contains strings of the form key value","much of the state of the original process is lost e.g. new virtual address space is created signal handlers reset ...","new virtual address space is created signal handlers reset ...","new process inherits open file descriptors from original process","on error returns -1 and sets errno","if successful does not return","replaces current process by executing path object path must be an executable binary or script starting with\npath must be an executable binary or script starting with\npasses arrays of strings to new process both arrays terminated by a null pointer element envp contains strings of the form key value\nboth arrays terminated by a null pointer element\nenvp contains strings of the form key value\nmuch of the state of the original process is lost e.g. new virtual address space is created signal handlers reset ...\nnew virtual address space is created signal handlers reset ...\nnew process inherits open file descriptors from original process\non error returns -1 and sets errno\nif successful does not return","path must be an executable binary or script starting with","path must be an executable binary or script starting with","both arrays terminated by a null pointer element","envp contains strings of the form key value","both arrays terminated by a null pointer element\nenvp contains strings of the form key value","new virtual address space is created signal handlers reset ...","new virtual address space is created signal handlers reset ...","fetch instruction from memory pc pc","decode and execute instruction if jump-type instruction pc new address if regular instruction carry out operation","if jump-type instruction pc new address","if regular instruction carry out operation","repeat above","fetch instruction from memory pc pc\ndecode and execute instruction if jump-type instruction pc new address if regular instruction carry out operation\nif jump-type instruction pc new address\nif regular instruction carry out operation\nrepeat above","if jump-type instruction pc new address","if regular instruction carry out operation","if jump-type instruction pc new address\nif regular instruction carry out operation","unexpected conditions occuring during program execution","which require some form of immediate action maybe just quit","unexpected conditions occuring during program execution\nwhich require some form of immediate action maybe just quit","exceptions ... from conditions within an executing program often fatal to continued execution of program","often fatal to continued execution of program","interrupts ... from events external to the program often require some action and then execution can continue","often require some action and then execution can continue","exceptions ... from conditions within an executing program often fatal to continued execution of program\noften fatal to continued execution of program\ninterrupts ... from events external to the program often require some action and then execution can continue\noften require some action and then execution can continue","often fatal to continued execution of program","often fatal to continued execution of program","often require some action and then execution can continue","often require some action and then execution can continue","process makes system call e.g. fork","generates an exception which transfers control to system call handler in privileged mode carries out system-level operations e.g. modify process table then returns control to the process in user mode","transfers control to system call handler in privileged mode","carries out system-level operations e.g. modify process table","then returns control to the process in user mode","process makes system call e.g. fork\ngenerates an exception which transfers control to system call handler in privileged mode carries out system-level operations e.g. modify process table then returns control to the process in user mode\ntransfers control to system call handler in privileged mode\ncarries out system-level operations e.g. modify process table\nthen returns control to the process in user mode","transfers control to system call handler in privileged mode","carries out system-level operations e.g. modify process table","then returns control to the process in user mode","transfers control to system call handler in privileged mode\ncarries out system-level operations e.g. modify process table\nthen returns control to the process in user mode","from another process via kill","from the operating system e.g. timer","from within the process e.g. system call","from a fault in the process e.g. div-by-zero","from a device e.g. disk read completes","from another process via kill\nfrom the operating system e.g. timer\nfrom within the process e.g. system call\nfrom a fault in the process e.g. div-by-zero\nfrom a device e.g. disk read completes","using the signal library function simple","using the sigaction system call powerful","using the signal library function simple\nusing the sigaction system call powerful","sigill ... illegal instruction term by default","sigabrt ... generated by abort core by default","sigfpe ... floating point exception core by default","sigsegv ... invalid memory reference core by default","sigill ... illegal instruction term by default\nsigabrt ... generated by abort core by default\nsigfpe ... floating point exception core by default\nsigsegv ... invalid memory reference core by default","sigint ... interrupt from keyboard term by default","sigpipe ... broken pipe term by default","sigchld ... child process stopped or died ignored by default","sigtstp ... stop typed at tty control-z stop by default","sigint ... interrupt from keyboard term by default\nsigpipe ... broken pipe term by default\nsigchld ... child process stopped or died ignored by default\nsigtstp ... stop typed at tty control-z stop by default","term ... terminate the process","core ... terminate the process dump core","stop ... stop the process","cont ... continue the process if currently stopped","term ... terminate the process\ncore ... terminate the process dump core\nstop ... stop the process\ncont ... continue the process if currently stopped","knows which signal it was invoked by","needs to ensure that invoking signal at least is blocked","carries out appropriate action may return","knows which signal it was invoked by\nneeds to ensure that invoking signal at least is blocked\ncarries out appropriate action may return","define how to handle a particular signal","requires library function not syscall","sigid is one of the os-defined signals e.g. sighup sigchld sigsegv ... but not sigkill sigstop","e.g. sighup sigchld sigsegv ... but not sigkill sigstop","handler can be one of ... sig_ign ... ignore signals of type sigid sig_dfl ... use default handler for sigid a user-defined function to handle sigid signals","sig_ign ... ignore signals of type sigid","sig_dfl ... use default handler for sigid","a user-defined function to handle sigid signals","note typedef void sighnd int","returns previous value of signal handler or sig_err","define how to handle a particular signal\nrequires library function not syscall\nsigid is one of the os-defined signals e.g. sighup sigchld sigsegv ... but not sigkill sigstop\ne.g. sighup sigchld sigsegv ... but not sigkill sigstop\nhandler can be one of ... sig_ign ... ignore signals of type sigid sig_dfl ... use default handler for sigid a user-defined function to handle sigid signals\nsig_ign ... ignore signals of type sigid\nsig_dfl ... use default handler for sigid\na user-defined function to handle sigid signals\nnote typedef void sighnd int\nreturns previous value of signal handler or sig_err","e.g. sighup sigchld sigsegv ... but not sigkill sigstop","e.g. sighup sigchld sigsegv ... but not sigkill sigstop","sig_ign ... ignore signals of type sigid","sig_dfl ... use default handler for sigid","a user-defined function to handle sigid signals","sig_ign ... ignore signals of type sigid\nsig_dfl ... use default handler for sigid\na user-defined function to handle sigid signals","sigid is one of the os-defined signals e.g. sighup sigchld sigsegv ... but not sigkill sigstop","e.g. sighup sigchld sigsegv ... but not sigkill sigstop","newact defines how signal should be handled","oldact saves a copy of how signal was handled","if newact.sa_handler sig_ign signal is ignored","if newact.sa_handler sig_dfl default handler is used","on success returns 0 on error returns -1 and sets errno","sigid is one of the os-defined signals e.g. sighup sigchld sigsegv ... but not sigkill sigstop\ne.g. sighup sigchld sigsegv ... but not sigkill sigstop\nnewact defines how signal should be handled\noldact saves a copy of how signal was handled\nif newact.sa_handler sig_ign signal is ignored\nif newact.sa_handler sig_dfl default handler is used\non success returns 0 on error returns -1 and sets errno","e.g. sighup sigchld sigsegv ... but not sigkill sigstop","e.g. sighup sigchld sigsegv ... but not sigkill sigstop","void sa_handler int pointer to a handler function or sig_ign or sig_dfl","pointer to a handler function or sig_ign or sig_dfl","void sa_sigaction int siginfo_t void pointer to handler function used if sa_siginfo flag is set allows more context info to be passed to handler","pointer to handler function used if sa_siginfo flag is set","allows more context info to be passed to handler","sigset_t sa_mask a mask where each bit specifies a signal to be blocked","a mask where each bit specifies a signal to be blocked","int sa_flags flags to modify how signal is treated e.g. don't block signal in its own handler","flags to modify how signal is treated e.g. don't block signal in its own handler","void sa_handler int pointer to a handler function or sig_ign or sig_dfl\npointer to a handler function or sig_ign or sig_dfl\nvoid sa_sigaction int siginfo_t void pointer to handler function used if sa_siginfo flag is set allows more context info to be passed to handler\npointer to handler function used if sa_siginfo flag is set\nallows more context info to be passed to handler\nsigset_t sa_mask a mask where each bit specifies a signal to be blocked\na mask where each bit specifies a signal to be blocked\nint sa_flags flags to modify how signal is treated e.g. don't block signal in its own handler\nflags to modify how signal is treated e.g. don't block signal in its own handler","pointer to a handler function or sig_ign or sig_dfl","pointer to a handler function or sig_ign or sig_dfl","pointer to handler function used if sa_siginfo flag is set","allows more context info to be passed to handler","pointer to handler function used if sa_siginfo flag is set\nallows more context info to be passed to handler","a mask where each bit specifies a signal to be blocked","a mask where each bit specifies a signal to be blocked","flags to modify how signal is treated e.g. don't block signal in its own handler","flags to modify how signal is treated e.g. don't block signal in its own handler","si_signo ... signal being handled","si_errno ... any errno value associated with signal","si_pid ... process id of sending process","si_uid ... user id of owner of sending process","si_status ... exit value for process termination","etc. etc. etc.","si_signo ... signal being handled\nsi_errno ... any errno value associated with signal\nsi_pid ... process id of sending process\nsi_uid ... user id of owner of sending process\nsi_status ... exit value for process termination\netc. etc. etc.","cause normal process execution to be suspended","an interrupt handler then carries out tasks related to interrupt","control is then returned to the original process","cause normal process execution to be suspended\nan interrupt handler then carries out tasks related to interrupt\ncontrol is then returned to the original process","process requests data from disk will take 100ms","if process can do other work not related to requested data keep executing ...","keep executing ...","when data fetched from disk process is interrupted","handler places data in a buffer for access by process","in-memory computation resumes","process requests data from disk will take 100ms\nif process can do other work not related to requested data keep executing ...\nkeep executing ...\nwhen data fetched from disk process is interrupted\nhandler places data in a buffer for access by process\nin-memory computation resumes","keep executing ...","keep executing ...","process runs for a while normal control flow","receives a timer signal from the o/s","process is suspended and its state is saved","process is eventually added to runnable queue","removed from front of queue and state restored","process continues from where it was suspended","process runs for a while normal control flow\nreceives a timer signal from the o/s\nprocess is suspended and its state is saved\nprocess is eventually added to runnable queue\nremoved from front of queue and state restored\nprocess continues from where it was suspended","in-memory computations are very fast ns","input/output operations are very slow ms","in-memory computations are very fast ns\ninput/output operations are very slow ms","suspend and place on waiting for i/o queue","when i/o complete move process to runnable queue","eventually process resumes with new data available","suspend and place on waiting for i/o queue\nwhen i/o complete move process to runnable queue\neventually process resumes with new data available","unexpected conditions which arise during computation","unexpected but not unanticipated robust code","unexpected conditions which arise during computation\nunexpected but not unanticipated robust code","create a data structure using multiple malloc s","part-way through function one malloc fails","if abandoning create need to clean up previous malloc s","if terminating the entire process no need to clean up","create a data structure using multiple malloc s\npart-way through function one malloc fails\nif abandoning create need to clean up previous malloc s\nif terminating the entire process no need to clean up","processes are not necessarily executing simultaneously although this could happen if there are multiple cpus","although this could happen if there are multiple cpus","more likely have a mixture of processes some are blocked waiting on a signal e.g. i/o completion some are runnable ready to execute one is running on each cpu","some are blocked waiting on a signal e.g. i/o completion","some are runnable ready to execute","one is running on each cpu","processes are not necessarily executing simultaneously although this could happen if there are multiple cpus\nalthough this could happen if there are multiple cpus\nmore likely have a mixture of processes some are blocked waiting on a signal e.g. i/o completion some are runnable ready to execute one is running on each cpu\nsome are blocked waiting on a signal e.g. i/o completion\nsome are runnable ready to execute\none is running on each cpu","although this could happen if there are multiple cpus","although this could happen if there are multiple cpus","some are blocked waiting on a signal e.g. i/o completion","some are runnable ready to execute","one is running on each cpu","some are blocked waiting on a signal e.g. i/o completion\nsome are runnable ready to execute\none is running on each cpu","by switching process after one runs for a defined time slice","after timer counts down current process is pre-empted","a new process is selected to run by the system scheduler","by switching process after one runs for a defined time slice\nafter timer counts down current process is pre-empted\na new process is selected to run by the system scheduler","processes are organised into priority queue s where highest priority process is always at head of queue","where highest priority process is always at head of queue","priority determined by multiple factors e.g. system processes have higher priority than user processes longer-running processes might have lower priority memory-intensive processes might have lower priority processes can also suggest their own priority","system processes have higher priority than user processes","longer-running processes might have lower priority","memory-intensive processes might have lower priority","processes can also suggest their own priority","processes are organised into priority queue s where highest priority process is always at head of queue\nwhere highest priority process is always at head of queue\npriority determined by multiple factors e.g. system processes have higher priority than user processes longer-running processes might have lower priority memory-intensive processes might have lower priority processes can also suggest their own priority\nsystem processes have higher priority than user processes\nlonger-running processes might have lower priority\nmemory-intensive processes might have lower priority\nprocesses can also suggest their own priority","where highest priority process is always at head of queue","where highest priority process is always at head of queue","system processes have higher priority than user processes","longer-running processes might have lower priority","memory-intensive processes might have lower priority","processes can also suggest their own priority","system processes have higher priority than user processes\nlonger-running processes might have lower priority\nmemory-intensive processes might have lower priority\nprocesses can also suggest their own priority","is priority-based priority queue of processes","linux process priorities are values in range -20..139","lower values represent higher priority","factors in determining priority user processes have lower priority than system processes processes have niceness value -20 highest .. 20 lowest recent cpu time usage by the process","user processes have lower priority than system processes","processes have niceness value -20 highest .. 20 lowest","recent cpu time usage by the process","scheduler chooses highest priority process from runnable","is priority-based priority queue of processes\nlinux process priorities are values in range -20..139\nlower values represent higher priority\nfactors in determining priority user processes have lower priority than system processes processes have niceness value -20 highest .. 20 lowest recent cpu time usage by the process\nuser processes have lower priority than system processes\nprocesses have niceness value -20 highest .. 20 lowest\nrecent cpu time usage by the process\nscheduler chooses highest priority process from runnable","user processes have lower priority than system processes","processes have niceness value -20 highest .. 20 lowest","recent cpu time usage by the process","user processes have lower priority than system processes\nprocesses have niceness value -20 highest .. 20 lowest\nrecent cpu time usage by the process","allow programs to communicate with the outside world","have significantly different characteristics to memory-based data","allow programs to communicate with the outside world\nhave significantly different characteristics to memory-based data","fast ns random access via virtual address","transfer data in units of bytes halfwords words","fast ns random access via virtual address\ntransfer data in units of bytes halfwords words","much slower ms access random or sequential","often transfer data in blocks e.g. 128b 512b 4kb ...","much slower ms access random or sequential\noften transfer data in blocks e.g. 128b 512b 4kb ...","address specified by track and sector s/t 200 s.size 512b","access time move to track wait for sector read block","address specified by track and sector s/t 200 s.size 512b\naccess time move to track wait for sector read block","high capacity gb high cost reading faster than writing","pages 512b..4kb blocks 32..128 pages r/w page-at-a-time","pages updated by erase then write limit on updates","avg read time 11 10-6 sec avg write time 15 10-6 sec","high capacity gb high cost reading faster than writing\npages 512b..4kb blocks 32..128 pages r/w page-at-a-time\npages updated by erase then write limit on updates\navg read time 11 10-6 sec avg write time 15 10-6 sec","destination specified by ip address packet size 1kb","transfer time includes dt transmission delay ... time to push data packet onto the wire dp propagation delay ... time for packet to travel along the wire dc processing delay ... time to check header re-route to next node dq queueing delay ... time waiting on node before transmission need to calculate for n hops so n dt dp dc dq","dt transmission delay ... time to push data packet onto the wire","dp propagation delay ... time for packet to travel along the wire","dc processing delay ... time to check header re-route to next node","dq queueing delay ... time waiting on node before transmission","need to calculate for n hops so n dt dp dc dq","destination specified by ip address packet size 1kb\ntransfer time includes dt transmission delay ... time to push data packet onto the wire dp propagation delay ... time for packet to travel along the wire dc processing delay ... time to check header re-route to next node dq queueing delay ... time waiting on node before transmission need to calculate for n hops so n dt dp dc dq\ndt transmission delay ... time to push data packet onto the wire\ndp propagation delay ... time for packet to travel along the wire\ndc processing delay ... time to check header re-route to next node\ndq queueing delay ... time waiting on node before transmission\nneed to calculate for n hops so n dt dp dc dq","dt transmission delay ... time to push data packet onto the wire","dp propagation delay ... time for packet to travel along the wire","dc processing delay ... time to check header re-route to next node","dq queueing delay ... time waiting on node before transmission","need to calculate for n hops so n dt dp dc dq","dt transmission delay ... time to push data packet onto the wire\ndp propagation delay ... time for packet to travel along the wire\ndc processing delay ... time to check header re-route to next node\ndq queueing delay ... time waiting on node before transmission\nneed to calculate for n hops so n dt dp dc dq","keyboard ... byte-by-byte input often line-buffered","screen ... pixel-array output typically via gpu","mouse ... transmit x y movement and button presses","camera ... convert video signal frame-by-frame to digital stream","microphone ... convert analog audio signal to digital stream","keyboard ... byte-by-byte input often line-buffered\nscreen ... pixel-array output typically via gpu\nmouse ... transmit x y movement and button presses\ncamera ... convert video signal frame-by-frame to digital stream\nmicrophone ... convert analog audio signal to digital stream","special control and data registers","locations buffers for data to be read/written","special control and data registers\nlocations buffers for data to be read/written","often written in assembler","are core components of the operating system","often written in assembler\nare core components of the operating system","send request for operation e.g. read write get status","receive interrupt when request is completed","send request for operation e.g. read write get status\nreceive interrupt when request is completed","operating system defines special memory address","user programs perform i/o by getting/putting data into memory","virtual memory addresses are associated with data buffers of i/o device control registers of i/o device","data buffers of i/o device","control registers of i/o device","operating system defines special memory address\nuser programs perform i/o by getting/putting data into memory\nvirtual memory addresses are associated with data buffers of i/o device control registers of i/o device\ndata buffers of i/o device\ncontrol registers of i/o device","data buffers of i/o device","control registers of i/o device","data buffers of i/o device\ncontrol registers of i/o device","uses existing memory access logic cirucits less hardware","can use full range of cpu operations on device memory cf. having limited set of special instructions to manipulate i/o devices","uses existing memory access logic cirucits less hardware\ncan use full range of cpu operations on device memory cf. having limited set of special instructions to manipulate i/o devices","/dev/diskn ... part of a hard drive","/dev/ttyn ... a terminal device","/dev/ptyn ... a pseudo-terminal device","/dev/diskn ... part of a hard drive\n/dev/ttyn ... a terminal device\n/dev/ptyn ... a pseudo-terminal device","/dev/mem ... the physical memory mostly protected","/dev/null ... data sink or empty source","/dev/random ... stream of pseudo-random numbers","/dev/mem ... the physical memory mostly protected\n/dev/null ... data sink or empty source\n/dev/random ... stream of pseudo-random numbers","provide unbuffered direct access to hardware devices","programmers interact with device by writing individual bytes","do not necessarily provide byte-by-byte hardware i/o e.g. disks","provide unbuffered direct access to hardware devices\nprogrammers interact with device by writing individual bytes\ndo not necessarily provide byte-by-byte hardware i/o e.g. disks","provide buffered access to hardware devices","programmers interact with device by writing chunks of bytes","data transferred to device via operating system buffers","provide buffered access to hardware devices\nprogrammers interact with device by writing chunks of bytes\ndata transferred to device via operating system buffers","manipulates parameters of special files behind open filedesc","request is a device-specific request code","arg is either an integer modifier or pointer to data block","requires include returns 0 if ok -1 if error","manipulates parameters of special files behind open filedesc\nrequest is a device-specific request code\narg is either an integer modifier or pointer to data block\nrequires include returns 0 if ok -1 if error","hdio_getgeo ... get disk info in heads sectors cylinders ...","blkgetsize ... get device size in sectors","in both cases arg is a pointer to an appropriate object","hdio_getgeo ... get disk info in heads sectors cylinders ...\nblkgetsize ... get device size in sectors\nin both cases arg is a pointer to an appropriate object","attempts to open device pathname in mode flags","flags can specify caching async i/o close on exec etc.","returns file descriptor if ok -1 plus errno if error","attempts to open device pathname in mode flags\nflags can specify caching async i/o close on exec etc.\nreturns file descriptor if ok -1 plus errno if error","attempts to read nbytes of data into buf from fdesc","returns bytes actually read 0 at eof -1 plus errno if error","attempts to read nbytes of data into buf from fdesc\nreturns bytes actually read 0 at eof -1 plus errno if error","attempts to write nbytes of data from buf to fdesc","returns bytes actually written -1 plus errno if error","attempts to write nbytes of data from buf to fdesc\nreturns bytes actually written -1 plus errno if error","os uses a collection of buffers to hold data from devices","data is supplied to user programs normally from buffer","sometimes infrequently need to access device","os uses a collection of buffers to hold data from devices\ndata is supplied to user programs normally from buffer\nsometimes infrequently need to access device","it is slow because of the context switch each time it is called","it is slow because of the context switch each time it is called","from tty-like devices generally line buffered","from disk-like devices files read/written in bufsiz chunks via os buffers so may not need disk access each time","via os buffers so may not need disk access each time","buffering hidden from user who sees getchar fgets etc.","buffer is allocated by fopen removed by fclose","from tty-like devices generally line buffered\nfrom disk-like devices files read/written in bufsiz chunks via os buffers so may not need disk access each time\nvia os buffers so may not need disk access each time\nbuffering hidden from user who sees getchar fgets etc.\nbuffer is allocated by fopen removed by fclose","via os buffers so may not need disk access each time","via os buffers so may not need disk access each time","contains the buffer malloc'd on fopen","contains current position within the buffer and file","etc. etc.","contains the buffer malloc'd on fopen\ncontains current position within the buffer and file\netc. etc.","e operating system components","storage management","storage management2/143","computer systems have bulk persistent storage devices","disks3/143","hdd hard disk drive","hdds have the following characteristics","... disks4/143","to access data on disk one sector at-a-time","... disks5/143","typical and historical measures of hdds","... disks6/143","disks are block-oriented devices","ssds7/143","ssd solid-state drive","ssds are fully-electronic devices that can store data persistenly","... ssds8/143","oss can view ssds like hdds","operating systems and storage9/143","operating system manages data stored on bulk storage devices","file systems","file systems11/143","file systems provide a mechanism for managing stored data","unix/linux file system12/143","unix/linux file system is tree-structured","we say it's tree structured but symlinks actually make it into a graph","processes have a notion of their location within the file system","... unix/linux file system13/143","the file system is used to access various types of objects","paths can be","e.g. /usr/include/stdio.h /home/jas/cs1521/","e.g. ../../another/path/prog.c ./a.out a.out","... unix/linux file system14/143","unix defines a range of file-system-related types","... unix/linux file system15/143","metadata for file system objects is stored in inodes","note an inode does not contain the name of the file","access to a file by name requires a directory","... unix/linux file system16/143","access to files by name proceeds as ...","file system operations17/143","unix presents a uniform interface to file system objects","open / close 18/143","int open char path int flags","... open / close 19/143","int close int filedesc","an aside removing an object e.g. via rm","... open / close 20/143","example using open and close","read / write 21/143","ssize_t read int filedesc void buffer size_t count","once a file is open 'd ...","... read / write 22/143","ssize_t write int filedesc void buffer size_t count","... read / write 23/143","functions from stdio.h tend to be char-oriented","file-descriptor-based system calls deal with byte sequences","you cannot save/restore pointer values using write /read","... read / write 24/143","files of records can be produced by","for the write approach","... read / write 25/143","example of write ing records vs printf ing records","seek 26/143","off_t lseek int filedesc off_t offset int whence","... seek 27/143","example","stat 28/143","int stat char filename struct stat statbuf","links29/143","file system links allow multiple paths to access the same data","hard links","... links30/143","file stat structure","... links31/143","the st_mode is a bit-string containing some of","... links32/143","int mkdir char pathname mode_t mode","... links33/143","int fsync int filedesc","... links34/143","int mount char source char target char filesystype unsigned long flags void data","use disk5 to hold the /usr file system as read-only ext3-type","file system summary35/143","operating systems provide a file system","memory management","memory37/143","systems typically contain 4-16gb of volatile ram","plus other smaller faster cache memory","processes38/143","a process is an active computation consisting of","memory management39/143","operating system provides a view of memory for individual processes","... memory management40/143","on a system with e.g. 1 cpu 1 memory and 100's of processes","... memory management41/143","the good-old-days ... one process/computation at a time","or if the process did not need the entire memory","easy to implement by initialising $sp to psize-4","... memory management42/143","two processes loaded into memory at once","... memory management43/143","when proc1 is loaded ...","... memory management44/143","consider a scenario with multiple processes loaded in memory","if we do on-the-fly address mapping we need to ...","... memory management45/143","consider the same scenario but now we want to add a new process","the new process doesn't fit in any of the unused slots","could move some process to make a single large slot","... memory management46/143","alternative strategy split new process memory over two regions","becomes","... memory management47/143","implications for splitting process memory across physical memory","... memory management48/143","under this scheme address mapping calculation is complicated","the above mapping must be done in hardware to be efficient.","... memory management49/143","address mapping would be simpler if all chunks were same size","... memory management50/143","example of simple mapping table","memory management review51/143","reminder process addresses physical addresses","address mapping52/143","mapping from process address to physical address","computation of pageno offset is efficient if pagesize 2n","note that we assume pageinfo entries with more information ....","... address mapping53/143","page table entries typically do not store physical address","virtual memory54/143","a side-effect of this type of virtual physical address mapping","... virtual memory55/143","pages/frames are typically 512b .. 8kb in size","in a 4gb memory would have 4 million 1kb frames","each frame can hold one page of process address space","leads to a memory layout like this with l total pages of physical memory","when a process completes all of its frames are released for re-use","... virtual memory56/143","how to arrange mapping process address physical address","consider a per-process page table e.g.","... virtual memory57/143","example of page table for one process","timestamps show when page was loaded.","... virtual memory58/143","virtual address to physical address mapping more detail","an aside working sets59/143","consider a new process commencing execution ...","... an aside working sets60/143","from observations of running programs ...","only need to hold at a given time the process's working set of pages","implications","virtual memory61/143","we say that we load pages into physical memory","but where are they loaded from","the pages of dynamic data not currently in use","... virtual memory62/143","we can imagine that a process's address space ...","transferring pages between disk memory is very expensive","... virtual memory63/143","per-process page table allowing for some pages to be not loaded","... virtual memory64/143","recall the address mapping process with per-process page tables","what to do if the page is not loaded","page faults65/143","requesting a non-loaded page generates a page fault.","one approach to handling a page fault ...","assumes that we have a way of quickly identifying free frames","commonly handled via a free list","reminder frames allocated to a process become free when process exits","... page faults66/143","what happens if there are currently no free page frames","what does getfreeframe do","possibilities","page replacement67/143","what happens when a page is replaced","... page replacement68/143","factors to consider in deciding which page to replace","but we do know whether it has been used recently if we record this","useful heuristic lru replacement","... page replacement69/143","factors for choosing best page to replace are heuristic","what happens if ...","the working set model plus lru helps avoid thrashing","... page replacement70/143","lru is one replacement strategy. others include","first-in-first-out fifo","virtual memory 71/143","page tables pts revisited ...","... virtual memory 72/143","alternative strategy multi-level page tables","effective because not all pages in virtual address space are required e.g. the pages between the top of the heap and the bottom of the stack","... virtual memory 73/143","virtual memory allows sharing of read-only pages e.g. library code","cache memory74/143","cache memory small fast memory close to cpu","small mb fast 5 ram","... cache memory75/143","cache memory","memory management hardware76/143","address translation is very important/frequent","... memory management hardware77/143","tlb translation lookaside buffer","process management","processes79/143","a process is an instance of an executing program","multiple processes are active simultaneously","... processes80/143","control-flow independence i am the only process and i run until i finish","in reality there are multiple processes running on the machine","overall impression three programs running simultaneously","... processes81/143","what can cause a process to be pre-empted","overall impression i ran until i finished all my computation","process management82/143","how does the os manage multiple simultaneous processes","context collection of information for one process","... process management83/143","process control block where os records info about each process","unix/linux processes84/143","environment for processes running on unix/linux systems","... unix/linux processes85/143","unix provides a range of tools for manipulating processes","commands","... unix/linux processes86/143","information associated with processes pcb","... unix/linux processes87/143","process info is split across process table entry and user structure","process table kernel data structure describing all processes","process-related system calls88/143","pid_t fork void","... process-related system calls89/143","minimal example for fork","... process-related system calls90/143","every process in unix/linux is allocated a process id","... process-related system calls91/143","getting information about a process ...","pid_t getpid","... process-related system calls92/143","processes belong to process groups","for more details man 2 getpgid","... process-related system calls93/143","minimal example for getpid","... process-related system calls94/143","pid_t waitpid pid_t pid int status int options","... process-related system calls95/143","more on waitpid pid status options","... process-related system calls96/143","minimal example for wait","... process-related system calls97/143","int kill pid_t procid int sigid","... process-related system calls98/143","minimal example for kill","... process-related system calls99/143","void _exit int status","... process-related system calls100/143","void exit int status","... process-related system calls101/143","... process-related system calls102/143","when a process finishes sends sigchld signal to parent","zombie process a process which has exited but signal not handled","... process-related system calls103/143","int execve char path char argv char envp","... process-related system calls104/143","on unix processes create new different processes via","process control flow105/143","when a process is executing ...","regular control flow can be interrupted exceptional control flow","... process control flow106/143","exceptional events are","two types of exceptional events","... process control flow107/143","effect of exceptions/interrupts on control flow","... process control flow108/143","system calls typically operate via exceptions traps","critical difference is transfer to system space privileged mode","signals109/143","signals can be generated from a variety of sources","... signals110/143","signals from internal process activity e.g.","signals from external process events e.g.","... signals111/143","processes can choose to ignore most signals.","if not ignored signals can be handled in several default ways","see man 7 signal for details of signals and default handling.","signal handlers112/143","signal handler a function invoked in response to a signal","... signal handlers113/143","sighnd signal int sigid sighnd handler","... signal handlers114/143","how to define and install a signal handler function","... signal handlers115/143","int sigaction int sigid struct sigaction newact struct sigaction oldact","... signal handlers116/143","details on struct sigaction ...","... signal handlers117/143","details on siginfo_t ...","interrupts118/143","interrupts are signals which","... interrupts119/143","example process pre-emption","... interrupts120/143","interrupts are frequently associated with input/output","exceptions121/143","above exceptions are low-level system ones.","alternative notion of exceptions","... exceptions122/143","such exceptions require handling in context of computation","example","c does not have generic exception handling roll your own.","multi-tasking123/143","multi-tasking multiple processes are active at the same time","process states124/143","how process state changes during execution ...","scheduling125/143","scheduling selecting which process should run next","... scheduling126/143","linux process scheduler ...","... scheduling127/143","abstract view of the os scheduler","device management","device management129/143","i/o devices130/143","input/output i/o devices","... i/o devices131/143","hard disk characteristics","typical cost 10ms seek 5ms latency 0.1ms transfer","... i/o devices132/143","solid state disk ssd characteristics","... i/o devices133/143","example network transfer","can check transmission times using the ping command","... i/o devices134/143","other types of devices ...","device drivers135/143","each type of device has its own unique access protocol","memory-mapped i/o136/143","memory-mapped input/output","cf. having limited set of special instructions to manipulate i/o devices","... memory-mapped i/o137/143","example of using memory-mapped i/o.","assume memory address of disk device is 0x80000200","transfers data from memory onto the disk at specified block.","disclaimer above code is not real mips/spim code. illustrative only.","devices on unix/linux138/143","unix treats devices uniformly as byte-streams like files .","devices can be accessed via the file system under /dev e.g.","... devices on unix/linux139/143","two standard types of device files ...","character devices aka character special files","... devices on unix/linux140/143","int ioctl int filedesc int request void arg","... devices on unix/linux141/143","devices can be manipulated by open read write ...","int open char pathname int flags","buffered i/o142/143","devices are typically very slow compared to cpu speed","using a read from a device for each byte is inefficient","note that read accesses data via the os buffers","... buffered i/o143/143","the standard i/o library stdio.h provides buffered i/o","produced 29 apr 2018","networks, ","networks, 2/52","... networks, 3/52","overview of network communication, 4/52","the internet, 5/52","components of the internet ... millions of connected devices e.g pc server laptop smartphone host end system running network apps communication links e.g. fibre copper radio satellite bandwidth transmission rate packet switches e.g. routers network switches compute next hop forward packets, , ","... the internet, 6/52","... the internet, 7/52","protocols, 8/52","network application layer, 9/52","client-server architecture, 10/52","addressing, 11/52","ip addresses, 12/52","application-layer protocols, 13/52","the http protocol, 14/52","... the http protocol, 15/52","application-layer protocol for the web client-server model client web browser e.g. chrome sends http requests receives http responses shows response as web page server web server e.g. apache receives http requests sends http responses, , ","... the http protocol, 16/52","... the http protocol, 17/52","... the http protocol, 18/52","... the http protocol, 19/52","... the http protocol, 20/52","server addresses dns, 21/52","... server addresses dns, 22/52","... server addresses dns, 23/52","... server addresses dns, 24/52","... server addresses dns, 25/52","... server addresses dns, 26/52","network architecture, 27/52","transport layer, 28/52","... transport layer, 29/52","transport layer protocols, 30/52","... transport layer protocols, 31/52","... transport layer protocols, 32/52","... transport layer protocols, 33/52","network layer, 34/52","network layer protocol, 35/52","... network layer protocol, 36/52","link layer, 37/52","ethernet, 38/52","... ethernet, 39/52","... ethernet, 40/52","wireless sensor network security, 41/52","... wireless sensor network security, 42/52","... wireless sensor network security, 43/52","... wireless sensor network security, 44/52","... wireless sensor network security, 45/52","wsn attacks, 46/52","... wsn attacks, 47/52","... wsn attacks, 48/52","... wsn attacks, 49/52","... wsn attacks, 50/52","... wsn attacks, 51/52","... wsn attacks, 52/52","local area networks ... within an organisation/physical location","wide area networks ... geographically dispersed wan","internet ... global set of interconnected wans","local area networks ... within an organisation/physical location\nwide area networks ... geographically dispersed wan\ninternet ... global set of interconnected wans","previously ... transfer data send text-based emails","nowadays ... communication communication communication","sharing resources e.g. printers large storage devices ...","previously ... transfer data send text-based emails\nnowadays ... communication communication communication\nsharing resources e.g. printers large storage devices ...","get data from machine a to machine b","a and b may be separated by 100's of networks and devices","get data from machine a to machine b\na and b may be separated by 100's of networks and devices","need a unique address for destination","identify a route first post office","process at intermediate nodes other post offices","follow certain protocols envelopes stamps fees","need a unique address for destination\nidentify a route first post office\nprocess at intermediate nodes other post offices\nfollow certain protocols envelopes stamps fees","packets are small fixed-size chunks of data with headers","packets are small fixed-size chunks of data with headers","each node decides where to send it next for best route","each node decides where to send it next for best route","millions of connected devices e.g pc server laptop smartphone host end system running network apps","e.g pc server laptop smartphone","host end system running network apps","communication links e.g. fibre copper radio satellite bandwidth transmission rate","e.g. fibre copper radio satellite","bandwidth transmission rate","packet switches e.g. routers network switches compute next hop forward packets","e.g. routers network switches","compute next hop forward packets","millions of connected devices e.g pc server laptop smartphone host end system running network apps\ne.g pc server laptop smartphone\nhost end system running network apps\ncommunication links e.g. fibre copper radio satellite bandwidth transmission rate\ne.g. fibre copper radio satellite\nbandwidth transmission rate\npacket switches e.g. routers network switches compute next hop forward packets\ne.g. routers network switches\ncompute next hop forward packets","e.g pc server laptop smartphone","host end system running network apps","e.g pc server laptop smartphone\nhost end system running network apps","e.g. fibre copper radio satellite","bandwidth transmission rate","e.g. fibre copper radio satellite\nbandwidth transmission rate","e.g. routers network switches","compute next hop forward packets","e.g. routers network switches\ncompute next hop forward packets","physical layer bits on wires or fibre optics or radio","link layer ethernet mac addressing csma etc.","network layer routing protocols ip","transport layer process-process data transfer tcp/udp","application layer dns http email skype torrents ftp etc.","physical layer bits on wires or fibre optics or radio\nlink layer ethernet mac addressing csma etc.\nnetwork layer routing protocols ip\ntransport layer process-process data transfer tcp/udp\napplication layer dns http email skype torrents ftp etc.","each layer encapsulates one aspect of network transport","provides layered reference model for discussion","modularization eases maintenance/updating e.g. changing implementation of one layer doesn't affect other layers","e.g. changing implementation of one layer doesn't affect other layers","each layer encapsulates one aspect of network transport\nprovides layered reference model for discussion\nmodularization eases maintenance/updating e.g. changing implementation of one layer doesn't affect other layers\ne.g. changing implementation of one layer doesn't affect other layers","e.g. changing implementation of one layer doesn't affect other layers","e.g. changing implementation of one layer doesn't affect other layers","format and order of messages sent/received","actions taken on message transmission/receipt","format and order of messages sent/received\nactions taken on message transmission/receipt","link layer ppp point-to-point protocol ...","network layer ip internet protoocol ...","transport layer tcp transmission control udp user datagram","application layer http ftp ssh pop smtp ...","link layer ppp point-to-point protocol ...\nnetwork layer ip internet protoocol ...\ntransport layer tcp transmission control udp user datagram\napplication layer http ftp ssh pop smtp ...","e-mail","web","text messaging","remote login","p2p file sharing","multi-user network games","streaming stored video youtube hulu netflix","voice over ip e.g. skype","real-time video conferencing","social networking","e-mail\nweb\ntext messaging\nremote login\np2p file sharing\nmulti-user network games\nstreaming stored video youtube hulu netflix\nvoice over ip e.g. skype\nreal-time video conferencing\nsocial networking","process that waits for requests","always-on host with permanent ip address","possibly using data centers / multiple cpus for scaling","process that waits for requests\nalways-on host with permanent ip address\npossibly using data centers / multiple cpus for scaling","sends requests to server collects response","may be intermittently connected may have dynamic ip address","does not communicate directly with other clients","sends requests to server collects response\nmay be intermittently connected may have dynamic ip address\ndoes not communicate directly with other clients","part of address is ip address of host machine","other part of address is port number where server listens","part of address is ip address of host machine\nother part of address is port number where server listens","address of web server on gaia.cs.umass.edu","address of web server on gaia.cs.umass.edu","22 ... ssh secure shell","25 ... smtp simple mail transfer protocol","53 ... dns domain name system","80 ... http web server","389 ... ldap lightweight directory access protocol","443 ... https web server encrypted","5432 ... postgresql database server","22 ... ssh secure shell\n25 ... smtp simple mail transfer protocol\n53 ... dns domain name system\n80 ... http web server\n389 ... ldap lightweight directory access protocol\n443 ... https web server encrypted\n5432 ... postgresql database server","given as a 32-bit identifier dotted quad e.g. 129.94.242.20","special case 127.0.0.1 loopback address referring to local host","ip addresses are assigned by sys admin entering into local registry for permanent addresses dynamically by getting a temporary address from dhcp server","sys admin entering into local registry for permanent addresses","dynamically by getting a temporary address from dhcp server","given as a 32-bit identifier dotted quad e.g. 129.94.242.20\nspecial case 127.0.0.1 loopback address referring to local host\nip addresses are assigned by sys admin entering into local registry for permanent addresses dynamically by getting a temporary address from dhcp server\nsys admin entering into local registry for permanent addresses\ndynamically by getting a temporary address from dhcp server","sys admin entering into local registry for permanent addresses","dynamically by getting a temporary address from dhcp server","sys admin entering into local registry for permanent addresses\ndynamically by getting a temporary address from dhcp server","why internet of things ... every networked device needs an ip","ipv6 uses 128-bit addresses e.g. 2001 388 c 4193 129 94 242 20","distinct addresses ipv4 4 109 ipv6 3 1038","why internet of things ... every networked device needs an ip\nipv6 uses 128-bit addresses e.g. 2001 388 c 4193 129 94 242 20\ndistinct addresses ipv4 4 109 ipv6 3 1038","types of messages different types of requests and responses","different types of requests and responses","message syntax what fields are in messages how fields are delineated","what fields are in messages how fields are delineated","message semantics meaning of information in fields","meaning of information in fields","processing rules when and how processes respond to messages","when and how processes respond to messages","types of messages different types of requests and responses\ndifferent types of requests and responses\nmessage syntax what fields are in messages how fields are delineated\nwhat fields are in messages how fields are delineated\nmessage semantics meaning of information in fields\nmeaning of information in fields\nprocessing rules when and how processes respond to messages\nwhen and how processes respond to messages","different types of requests and responses","different types of requests and responses","what fields are in messages how fields are delineated","what fields are in messages how fields are delineated","meaning of information in fields","meaning of information in fields","when and how processes respond to messages","when and how processes respond to messages","an extremely important protocol drives the web","message types urls requests and web pages responses","message syntax headers data see details later","an extremely important protocol drives the web\nmessage types urls requests and web pages responses\nmessage syntax headers data see details later","contain html may contain references to other types of objects","all objects are addressable via a url","contain html may contain references to other types of objects\nall objects are addressable via a url","client web browser e.g. chrome sends http requests receives http responses shows response as web page","sends http requests","receives http responses","shows response as web page","server web server e.g. apache receives http requests sends http responses","receives http requests","sends http responses","client web browser e.g. chrome sends http requests receives http responses shows response as web page\nsends http requests\nreceives http responses\nshows response as web page\nserver web server e.g. apache receives http requests sends http responses\nreceives http requests\nsends http responses","sends http requests","receives http responses","shows response as web page","sends http requests\nreceives http responses\nshows response as web page","receives http requests","sends http responses","receives http requests\nsends http responses","using tcp","client initiates tcp connection socket to server port 80","server accepts tcp connection from client","client sends http request messages e.g. get","server responds with http messages e.g. html","interaction completes connection socket closed","using tcp\nclient initiates tcp connection socket to server port 80\nserver accepts tcp connection from client\nclient sends http request messages e.g. get\nserver responds with http messages e.g. html\ninteraction completes connection socket closed","no need to mention host since connection already established","get requests data from resource specified by path query string is included in the path","query string is included in the path","post submitd data to be processed by specified resource query string is included in the body","query string is included in the body","head same as get but returns only header no data","no need to mention host since connection already established\nget requests data from resource specified by path query string is included in the path\nquery string is included in the path\npost submitd data to be processed by specified resource query string is included in the body\nquery string is included in the body\nhead same as get but returns only header no data","query string is included in the path","query string is included in the path","query string is included in the body","query string is included in the body","202 ok ... succesful request","301 moved permanently ... requested object moved returns new url for client to use in future requests","returns new url for client to use in future requests","400 bad request ... request cannot be processed possible reasons bad request syntax request size too large ...","possible reasons bad request syntax request size too large ...","403 forbidden ... valid request cannot be processed possible reasons user does not have permission for operation","possible reasons user does not have permission for operation","404 not found ... path does not exist on server","500 internal server error ... server cannot complete request possible reasons server side script fails database not accessible ...","possible reasons server side script fails database not accessible ...","202 ok ... succesful request\n301 moved permanently ... requested object moved returns new url for client to use in future requests\nreturns new url for client to use in future requests\n400 bad request ... request cannot be processed possible reasons bad request syntax request size too large ...\npossible reasons bad request syntax request size too large ...\n403 forbidden ... valid request cannot be processed possible reasons user does not have permission for operation\npossible reasons user does not have permission for operation\n404 not found ... path does not exist on server\n500 internal server error ... server cannot complete request possible reasons server side script fails database not accessible ...\npossible reasons server side script fails database not accessible ...","returns new url for client to use in future requests","returns new url for client to use in future requests","possible reasons bad request syntax request size too large ...","possible reasons bad request syntax request size too large ...","possible reasons user does not have permission for operation","possible reasons user does not have permission for operation","possible reasons server side script fails database not accessible ...","possible reasons server side script fails database not accessible ...","http //www.cse.unsw.edu.au/ cs1521/17s2/","http //www.cse.unsw.edu.au/ cs1521/17s2/","a person name ssn tfn passport ...","a person name ssn tfn passport ...","one or more symbolic names unique ip address","symbolic www.cse.unsw.edu.au ip 129.94.242.51","one or more symbolic names unique ip address\nsymbolic www.cse.unsw.edu.au ip 129.94.242.51","a given ip address may be reachable via several names","a given name may map to several ips e.g. for load distribution","a given ip address may be reachable via several names\na given name may map to several ips e.g. for load distribution","effectively a distributed database of name ip mappings","implemented across a hierarchy of name servers","name servers cooperate to resolve names to ip addresses","effectively a distributed database of name ip mappings\nimplemented across a hierarchy of name servers\nname servers cooperate to resolve names to ip addresses","central point of failure high traffic volume","distant database lag maintenance of very large db","central point of failure high traffic volume\ndistant database lag maintenance of very large db","contact a root dns server to find .com dns server","contact .com dns server to get amazon.com dns server","contact amazon.com dns server to get ip of their web server","contact a root dns server to find .com dns server\ncontact .com dns server to get amazon.com dns server\ncontact amazon.com dns server to get ip of their web server","iterated query ... work done by client client contacts name server x gets response i don't know but ask name server y or gets response here is the ip address client repeats above steps until name resolved","client contacts name server x","gets response i don't know but ask name server y","or gets response here is the ip address","client repeats above steps until name resolved","recursive query ... work done by name servers client contacts name server x x contacts name server y y contacts z ... query propagates until name resolved","client contacts name server x","x contacts name server y y contacts z ...","query propagates until name resolved","iterated query ... work done by client client contacts name server x gets response i don't know but ask name server y or gets response here is the ip address client repeats above steps until name resolved\nclient contacts name server x\ngets response i don't know but ask name server y\nor gets response here is the ip address\nclient repeats above steps until name resolved\nrecursive query ... work done by name servers client contacts name server x x contacts name server y y contacts z ... query propagates until name resolved\nclient contacts name server x\nx contacts name server y y contacts z ...\nquery propagates until name resolved","client contacts name server x","gets response i don't know but ask name server y","or gets response here is the ip address","client repeats above steps until name resolved","client contacts name server x\ngets response i don't know but ask name server y\nor gets response here is the ip address\nclient repeats above steps until name resolved","client contacts name server x","x contacts name server y y contacts z ...","query propagates until name resolved","client contacts name server x\nx contacts name server y y contacts z ...\nquery propagates until name resolved","top-level domain tld name servers .com .org .edu and all country-level domains e.g. .uk network solutions maintains servers for .com ausregistry maintains servers for .au",".com .org .edu and all country-level domains e.g. .uk","network solutions maintains servers for .com","ausregistry maintains servers for .au","authoritative name servers maintains mappings from names to ip within an organisation all hosts within the organisation are registered here","maintains mappings from names to ip within an organisation","all hosts within the organisation are registered here","local default name servers maintains cache of name ip mappings starting point for dns queries forward to tld server if cached","maintains cache of name ip mappings","starting point for dns queries forward to tld server if cached","top-level domain tld name servers .com .org .edu and all country-level domains e.g. .uk network solutions maintains servers for .com ausregistry maintains servers for .au\n.com .org .edu and all country-level domains e.g. .uk\nnetwork solutions maintains servers for .com\nausregistry maintains servers for .au\nauthoritative name servers maintains mappings from names to ip within an organisation all hosts within the organisation are registered here\nmaintains mappings from names to ip within an organisation\nall hosts within the organisation are registered here\nlocal default name servers maintains cache of name ip mappings starting point for dns queries forward to tld server if cached\nmaintains cache of name ip mappings\nstarting point for dns queries forward to tld server if cached",".com .org .edu and all country-level domains e.g. .uk","network solutions maintains servers for .com","ausregistry maintains servers for .au",".com .org .edu and all country-level domains e.g. .uk\nnetwork solutions maintains servers for .com\nausregistry maintains servers for .au","maintains mappings from names to ip within an organisation","all hosts within the organisation are registered here","maintains mappings from names to ip within an organisation\nall hosts within the organisation are registered here","maintains cache of name ip mappings","starting point for dns queries forward to tld server if cached","maintains cache of name ip mappings\nstarting point for dns queries forward to tld server if cached","lowest least abstract level","physical layer ... bits on wires","link layer ... e.g. ethernet mac","network layer ... e.g. ip","transport layer ... e.g. tcp/udp","application layer ... e.g. http email","highest most abstract level","lowest least abstract level\nphysical layer ... bits on wires\nlink layer ... e.g. ethernet mac\nnetwork layer ... e.g. ip\ntransport layer ... e.g. tcp/udp\napplication layer ... e.g. http email\nhighest most abstract level","data integrity some apps e.g. file transfer require 100 reliable transfer other apps e.g. audio streaming can tolerate some loss","some apps e.g. file transfer require 100 reliable transfer","other apps e.g. audio streaming can tolerate some loss","timing some apps e.g. networked games require low transmission delay","some apps e.g. networked games require low transmission delay","throughput some apps e.g. multimedia require minimum throughput other apps elastic apps can use whatever is available","some apps e.g. multimedia require minimum throughput","other apps elastic apps can use whatever is available","security some apps e.g. web services require encrypted transmission","some apps e.g. web services require encrypted transmission","data integrity some apps e.g. file transfer require 100 reliable transfer other apps e.g. audio streaming can tolerate some loss\nsome apps e.g. file transfer require 100 reliable transfer\nother apps e.g. audio streaming can tolerate some loss\ntiming some apps e.g. networked games require low transmission delay\nsome apps e.g. networked games require low transmission delay\nthroughput some apps e.g. multimedia require minimum throughput other apps elastic apps can use whatever is available\nsome apps e.g. multimedia require minimum throughput\nother apps elastic apps can use whatever is available\nsecurity some apps e.g. web services require encrypted transmission\nsome apps e.g. web services require encrypted transmission","some apps e.g. file transfer require 100 reliable transfer","other apps e.g. audio streaming can tolerate some loss","some apps e.g. file transfer require 100 reliable transfer\nother apps e.g. audio streaming can tolerate some loss","some apps e.g. networked games require low transmission delay","some apps e.g. networked games require low transmission delay","some apps e.g. multimedia require minimum throughput","other apps elastic apps can use whatever is available","some apps e.g. multimedia require minimum throughput\nother apps elastic apps can use whatever is available","some apps e.g. web services require encrypted transmission","some apps e.g. web services require encrypted transmission","file transfer no loss elastic not time sensitive","email no loss elastic not time sensitive","web/http no loss elastic not time sensitive","audio loss-tolerant 5kbps-1mbps few ms delay ok","video loss-tolerant 10kbps-5mbps few ms delay ok","games loss-tolerant 5kbps-5mbps few secs delay ok","texting no loss elastic few ms delay ok","file transfer no loss elastic not time sensitive\nemail no loss elastic not time sensitive\nweb/http no loss elastic not time sensitive\naudio loss-tolerant 5kbps-1mbps few ms delay ok\nvideo loss-tolerant 10kbps-5mbps few ms delay ok\ngames loss-tolerant 5kbps-5mbps few secs delay ok\ntexting no loss elastic few ms delay ok","logical communication between processes on different hosts","transport protocols run within end-point processes sender splits messages into segments passes to network layer receiver reassembles segments into messages passes to app layer","sender splits messages into segments passes to network layer","receiver reassembles segments into messages passes to app layer","logical communication between processes on different hosts\ntransport protocols run within end-point processes sender splits messages into segments passes to network layer receiver reassembles segments into messages passes to app layer\nsender splits messages into segments passes to network layer\nreceiver reassembles segments into messages passes to app layer","sender splits messages into segments passes to network layer","receiver reassembles segments into messages passes to app layer","sender splits messages into segments passes to network layer\nreceiver reassembles segments into messages passes to app layer","tcp ... reliable connection-oriented protocol byte-stream","udp ... unreliable simple connectionless protocol segments","tcp ... reliable connection-oriented protocol byte-stream\nudp ... unreliable simple connectionless protocol segments","reliable transport data flow between sender/receiver","flow control sender doesn't overwhelm receiver","congestion control slow sender if network congested","connection-oriented setup required between client/server","reliable transport data flow between sender/receiver\nflow control sender doesn't overwhelm receiver\ncongestion control slow sender if network congested\nconnection-oriented setup required between client/server","fast for sender but unreliable data transfer","fast for sender but unreliable data transfer","ip is an unreliable network-layer protocol","tcp provides reliable stream of data on top of ip","ip is an unreliable network-layer protocol\ntcp provides reliable stream of data on top of ip","set up connection between sender and receiver","sender transmits a pipeline of segments","expect ack for each segment","retransmissions triggered by timeouts and duplicate acks","receiver manages receipt and collation of segments","set up connection between sender and receiver\nsender transmits a pipeline of segments\nexpect ack for each segment\nretransmissions triggered by timeouts and duplicate acks\nreceiver manages receipt and collation of segments","small segment headers no connection setup costs","udp senders can transmit segments as fast as they like","segments are handled independently of each other","small segment headers no connection setup costs\nudp senders can transmit segments as fast as they like\nsegments are handled independently of each other","sender and receiver treat segment data as sequence of ints","sender compute sum of ints store in header","receiver compute sum of ints compare to checksum","sender and receiver treat segment data as sequence of ints\nsender compute sum of ints store in header\nreceiver compute sum of ints compare to checksum","hosts specified by ip addresses e.g. 129.94.242.19","hosts specified by ip addresses e.g. 129.94.242.19","for outgoing packets select the next-hop host pass packet to link layer to transmit to host","select the next-hop host","pass packet to link layer to transmit to host","for incoming packets if reached destination extract payload pass to transport layer if not reached destination treat as outgoing packet","if reached destination extract payload pass to transport layer","if not reached destination treat as outgoing packet","for all packets/transmissions error detection diagnostics","may also split oversize segments into smaller packets","for outgoing packets select the next-hop host pass packet to link layer to transmit to host\nselect the next-hop host\npass packet to link layer to transmit to host\nfor incoming packets if reached destination extract payload pass to transport layer if not reached destination treat as outgoing packet\nif reached destination extract payload pass to transport layer\nif not reached destination treat as outgoing packet\nfor all packets/transmissions error detection diagnostics\nmay also split oversize segments into smaller packets","select the next-hop host","pass packet to link layer to transmit to host","select the next-hop host\npass packet to link layer to transmit to host","if reached destination extract payload pass to transport layer","if not reached destination treat as outgoing packet","if reached destination extract payload pass to transport layer\nif not reached destination treat as outgoing packet","host addressing and routing of packets","splitting and reassembly of large packets","host addressing and routing of packets\nsplitting and reassembly of large packets","each host maintains a routing table maps address next-hop","uses subnets to reduce table size all hosts in a subnet have common prefix e.g. cse 129.94.2xx.xxx all ip addresses with common prefix sent to same host gateway","all hosts in a subnet have common prefix e.g. cse 129.94.2xx.xxx","all ip addresses with common prefix sent to same host gateway","routing table maintained dynamically hosts transmit active signals to each other periodically","hosts transmit active signals to each other periodically","each host maintains a routing table maps address next-hop\nuses subnets to reduce table size all hosts in a subnet have common prefix e.g. cse 129.94.2xx.xxx all ip addresses with common prefix sent to same host gateway\nall hosts in a subnet have common prefix e.g. cse 129.94.2xx.xxx\nall ip addresses with common prefix sent to same host gateway\nrouting table maintained dynamically hosts transmit active signals to each other periodically\nhosts transmit active signals to each other periodically","all hosts in a subnet have common prefix e.g. cse 129.94.2xx.xxx","all ip addresses with common prefix sent to same host gateway","all hosts in a subnet have common prefix e.g. cse 129.94.2xx.xxx\nall ip addresses with common prefix sent to same host gateway","hosts transmit active signals to each other periodically","hosts transmit active signals to each other periodically","every host on network has network layer implementation","implemented as a combination of hardware/software","each host contains a network interface card nic","connected to system bus as i/o device","every host on network has network layer implementation\nimplemented as a combination of hardware/software\neach host contains a network interface card nic\nconnected to system bus as i/o device","flow control ... pacing between adjacent sending and receiving nodes","error detection ... detects transmission errors flags error to network layer","error correction ... can identify and correct single bit errors","flow control ... pacing between adjacent sending and receiving nodes\nerror detection ... detects transmission errors flags error to network layer\nerror correction ... can identify and correct single bit errors","ethernet is a cable physically connecting multiple hosts","data broadcast onto cable tagged with receiver mac address","devices recognise their own data using mac address","ethernet is a cable physically connecting multiple hosts\ndata broadcast onto cable tagged with receiver mac address\ndevices recognise their own data using mac address","interference two different packets broadcast at same time","collision node receives two or more signals at same time","interference two different packets broadcast at same time\ncollision node receives two or more signals at same time","channel partitioning partition channel based on time-slices/frequency-bands/... allocate one partition to each node for exclusive use","partition channel based on time-slices/frequency-bands/...","allocate one partition to each node for exclusive use","random access allow collisions need mechanisms to recover from collisions","allow collisions need mechanisms to recover from collisions","taking turns nodes take turns nodes with more to send get longer turns","nodes take turns nodes with more to send get longer turns","channel partitioning partition channel based on time-slices/frequency-bands/... allocate one partition to each node for exclusive use\npartition channel based on time-slices/frequency-bands/...\nallocate one partition to each node for exclusive use\nrandom access allow collisions need mechanisms to recover from collisions\nallow collisions need mechanisms to recover from collisions\ntaking turns nodes take turns nodes with more to send get longer turns\nnodes take turns nodes with more to send get longer turns","partition channel based on time-slices/frequency-bands/...","allocate one partition to each node for exclusive use","partition channel based on time-slices/frequency-bands/...\nallocate one partition to each node for exclusive use","allow collisions need mechanisms to recover from collisions","allow collisions need mechanisms to recover from collisions","nodes take turns nodes with more to send get longer turns","nodes take turns nodes with more to send get longer turns","large number of autonomous sensors","one or multiple base station mobile or static","reasons for popularity low cost ability to solve and interact with real world problems and challenges","low cost","ability to solve and interact with real world problems and challenges","large number of autonomous sensors\none or multiple base station mobile or static\nreasons for popularity low cost ability to solve and interact with real world problems and challenges\nlow cost\nability to solve and interact with real world problems and challenges","low cost","ability to solve and interact with real world problems and challenges","low cost\nability to solve and interact with real world problems and challenges","operate in unattended and hostile environments","potentially interact with sensitive data","operate in unattended and hostile environments\npotentially interact with sensitive data","environmental/habitat monitoring","acoustic detection","seismic detection","military surveillance","inventory tracking","medical monitoring","smart spaces","process monitoring","environmental/habitat monitoring\nacoustic detection\nseismic detection\nmilitary surveillance\ninventory tracking\nmedical monitoring\nsmart spaces\nprocess monitoring","difficult to apply existing approaches to wsn security","very limited resources limited memory and storage space power limitation","limited memory and storage space","power limitation","unreliable communication unreliable transfer connectionless routing packet loss/error handling conflicts packet collision latency multihop routing/network congestion/node processing","unreliable transfer connectionless routing packet loss/error handling","conflicts packet collision","latency multihop routing/network congestion/node processing","unattended operation exposure to physical attacks bad weather etc managed remotely physical tampering no central management point","exposure to physical attacks bad weather etc","managed remotely physical tampering","no central management point","difficult to apply existing approaches to wsn security\nvery limited resources limited memory and storage space power limitation\nlimited memory and storage space\npower limitation\nunreliable communication unreliable transfer connectionless routing packet loss/error handling conflicts packet collision latency multihop routing/network congestion/node processing\nunreliable transfer connectionless routing packet loss/error handling\nconflicts packet collision\nlatency multihop routing/network congestion/node processing\nunattended operation exposure to physical attacks bad weather etc managed remotely physical tampering no central management point\nexposure to physical attacks bad weather etc\nmanaged remotely physical tampering\nno central management point","limited memory and storage space","power limitation","limited memory and storage space\npower limitation","unreliable transfer connectionless routing packet loss/error handling","conflicts packet collision","latency multihop routing/network congestion/node processing","unreliable transfer connectionless routing packet loss/error handling\nconflicts packet collision\nlatency multihop routing/network congestion/node processing","exposure to physical attacks bad weather etc","managed remotely physical tampering","no central management point","exposure to physical attacks bad weather etc\nmanaged remotely physical tampering\nno central management point","data confidentiality military sensitive data encryption","military sensitive data","encryption","data integrity","data freshness important because of shared key strategies","important because of shared key strategies","availability","self organization","authentication","data confidentiality military sensitive data encryption\nmilitary sensitive data\nencryption\ndata integrity\ndata freshness important because of shared key strategies\nimportant because of shared key strategies\navailability\nself organization\nauthentication","military sensitive data","encryption","military sensitive data\nencryption","important because of shared key strategies","important because of shared key strategies","denial of service attack","the sybil attack malicious device taking on multiple identities voting systems","malicious device taking on multiple identities voting systems","traffic analysis attack","node replication attacks","attacks against privacy monitor and eavesdropping traffic analysis camouflage","monitor and eavesdropping traffic analysis camouflage","physical attacks","denial of service attack\nthe sybil attack malicious device taking on multiple identities voting systems\nmalicious device taking on multiple identities voting systems\ntraffic analysis attack\nnode replication attacks\nattacks against privacy monitor and eavesdropping traffic analysis camouflage\nmonitor and eavesdropping traffic analysis camouflage\nphysical attacks","malicious device taking on multiple identities voting systems","malicious device taking on multiple identities voting systems","monitor and eavesdropping traffic analysis camouflage","monitor and eavesdropping traffic analysis camouflage","any event that diminishes or eliminates network's capacity to perform its expected function","any event that diminishes or eliminates network's capacity to perform its expected function","computational overhead in wsn","critical applications","computational overhead in wsn\ncritical applications","intermittent jamming","constant jamming","link layer attacks collision","intermittent jamming\nconstant jamming\nlink layer attacks collision","malicious device illegitimately taking on multiple identities","malicious device illegitimately taking on multiple identities","routing algorithms data aggregation voting","fair resource allocation and foiling misbehavior detection","routing algorithms data aggregation voting\nfair resource allocation and foiling misbehavior detection","multiple votes registered using multiple identities","multiple votes registered using multiple identities","add another node to sensor network by replicating node id","add another node to sensor network by replicating node id","packet corruption","incorrect packet routing","packet corruption\nincorrect packet routing","to manipulate a specific segment of the network","to manipulate a specific segment of the network","destruction tampering with circuitry or modification of programming","destruction tampering with circuitry or modification of programming","nodes operate in hostile outdoor environments","small form factor","unattended nature of deployment","nodes operate in hostile outdoor environments\nsmall form factor\nunattended nature of deployment","modification attack malicious node modifies data in transit between source and destination","malicious node modifies data in transit between source and destination","selective forwarding attack malicious node intends to selectively drop some packets","malicious node intends to selectively drop some packets","black-hole attack malicious node intend to refuse routing and drop all packets through","malicious node intend to refuse routing and drop all packets through","modification attack malicious node modifies data in transit between source and destination\nmalicious node modifies data in transit between source and destination\nselective forwarding attack malicious node intends to selectively drop some packets\nmalicious node intends to selectively drop some packets\nblack-hole attack malicious node intend to refuse routing and drop all packets through\nmalicious node intend to refuse routing and drop all packets through","malicious node modifies data in transit between source and destination","malicious node modifies data in transit between source and destination","malicious node intends to selectively drop some packets","malicious node intends to selectively drop some packets","malicious node intend to refuse routing and drop all packets through","malicious node intend to refuse routing and drop all packets through","encryption","multipath routing","overhearing","concealed data aggregation","more","encryption\nmultipath routing\noverhearing\nconcealed data aggregation\nmore","f network architecture","networks","networks2/52","network interconnected collection of computers","flavours of networks","... networks3/52","what are the basic requirements for a network","overview of network communication4/52","how a file is sent over the network","the internet5/52","components of the internet ... millions of connected devices e.g pc server laptop smartphone host end system running network apps communication links e.g. fibre copper radio satellite bandwidth transmission rate packet switches e.g. routers network switches compute next hop forward packets","... the internet6/52","internet communications are based on a 5-layer stack","why so many layers of abstraction","... the internet7/52","path of data through network layers","protocols8/52","network protocols govern all communication activity on the network","protocols provide communication rules ...","network application layer9/52","the application layer directly supports the apps we interact with e.g.","client-server architecture10/52","client-server common way of structuring network communication","server is a data provider","addressing11/52","server processes must have a unique internet-wide address","ip addresses12/52","ip address unique identifier for host on network","application-layer protocols13/52","each application-layer protocol defines","the http protocol14/52","http hypertext transfer protocol","web pages are the primary type of response","... the http protocol15/52","application-layer protocol for the web client-server model client web browser e.g. chrome sends http requests receives http responses shows response as web page server web server e.g. apache receives http requests sends http responses","client-server model","... the http protocol16/52","transport layer view of http application layer","... the http protocol17/52","http request message ascii text","url can also include a query string e.g.","... the http protocol18/52","first line of http request contains method path protocol e.g.","... the http protocol19/52","http response message ascii text","... the http protocol20/52","response status codes appear in first line of http response","server addresses dns 21/52","network requests typically use server names e.g.","domain name system provides name ip address mapping","can access this on unix/linux via the host command e.g.","assumes that you have a network connection","... server addresses dns 22/52","in real life often have one object referenced by many names e.g.","... server addresses dns 23/52","domain name system dns","why not centralize dns","... server addresses dns 24/52","resolving www.amazon.com in this system","... server addresses dns 25/52","two styles of name resolution","... server addresses dns 26/52","how are the various dns servers structured/managed","network architecture27/52","five layer model","software at each level uses headers appropriate for its purpose","transport layer28/52","transport layer deals with ...","... transport layer29/52","properties of some common apps ...","transport layer protocols30/52","transport layer protocols provide","... transport layer protocols31/52","tcp transmission control protocol provides ...","udp user datagram protocol provides ...","... transport layer protocols32/52","tcp is typically layered on top of ip protocol","... transport layer protocols33/52","above comments makes udp sound sub-standard","however it has a number of advantages over tcp ...","error detection requires use of checksum","network layer34/52","transport layer provides a way for app processes to communicate","network layer provides communication between hosts","network layer protocol35/52","ip internet protocol is a network layer protocol that provides ...","... network layer protocol36/52","simplified routing algorithm ip forwarding","link layer37/52","link layer takes packets from network layer and transmits them","ethernet38/52","ethernet is an example of link layer implementation","mac address media access control address stored in nic","... ethernet39/52","ethernet is a shared broadcast medium and so ...","example multiple access protocols","... ethernet40/52","a random access transmission protocol csma","wireless sensor network security41/52","what is wsn","a wireless sensor network wsn is a wireless network consisting of spatially distributed autonomous devices using sensors to cooperatively monitor physical or environmental conditions such as temperature sound vibration pressure motion or pollutants at different locations.","... wireless sensor network security42/52","security of wireless sensor networks","wsns operate under resource constraints","applications","... wireless sensor network security43/52","main aspects to discuss ...","... wireless sensor network security44/52","obstacles to sensor network security","... wireless sensor network security45/52","security requirements of a wireless sensor network","wsn attacks46/52","types of attacks","... wsn attacks47/52","denial of service dos attack","constraints","... wsn attacks48/52","sybil attack","... wsn attacks49/52","node replication attacks","... wsn attacks50/52","physical attacks","... wsn attacks51/52","other kinds of attack","... wsn attacks52/52","defense strategies ...","produced 2 may 2018","parallelism/concurrency, ","concurrency/parallelism, 2/59","... concurrency/parallelism, 3/59","... concurrency/parallelism, 4/59","... concurrency/parallelism, 5/59","creating concurrency, 6/59","... creating concurrency, 7/59","linux/unix threads, 8/59","... linux/unix threads, 9/59","... linux/unix threads, 10/59","... linux/unix threads, 11/59","concurrency, 12/59","... concurrency, 13/59","... concurrency, 14/59","... concurrency, 15/59","concurrency control, 16/59","... concurrency control, 17/59","producer-consumer problem, 18/59","... producer-consumer problem, 19/59","... producer-consumer problem, 20/59","... producer-consumer problem, 21/59","... producer-consumer problem, 22/59","semaphores, 23/59","... semaphores, 24/59","... semaphores, 25/59","... semaphores, 26/59","... semaphores, 27/59","message passing, 28/59","... message passing, 29/59","... message passing, 30/59","... message passing, 31/59","... message passing, 32/59","... message passing, 33/59","process interaction, ","interacting processes, 35/59","... interacting processes, 36/59","file locking, 37/59","... file locking, 38/59","pipes, 39/59","... pipes, 40/59","... pipes, 41/59","... pipes, 42/59","... pipes, 43/59","... pipes, 44/59","message queues, 45/59","... message queues, 46/59","... message queues, 47/59","... message queues, 48/59","... message queues, 49/59","... message queues, 50/59","... message queues, 51/59","sockets, 52/59","... sockets, 53/59","... sockets, 54/59","... sockets, 55/59","... sockets, 56/59","... sockets, 57/59","... sockets, 58/59","... sockets, 59/59","e.g. multiple cpus one process on each cpu mimd","e.g. data vector one processor computes on each element simd","e.g. map-reduce computation spread across multiple hosts","e.g. multiple cpus one process on each cpu mimd\ne.g. data vector one processor computes on each element simd\ne.g. map-reduce computation spread across multiple hosts","e.g. single cpu alternating between processes time-slicing","e.g. single cpu alternating between processes time-slicing","mutliple identical processors","each given one element of a data structure from main memory","each performing same computation on that element","results copied back to main memory data structure","mutliple identical processors\neach given one element of a data structure from main memory\neach performing same computation on that element\nresults copied back to main memory data structure","manipulating very large data sets","on a large network of nodes local or distributed","manipulating very large data sets\non a large network of nodes local or distributed","data distributed shuffled as key value pairs","each node receives a set of pairs with common key s","data distributed shuffled as key value pairs\neach node receives a set of pairs with common key s","nodes perform calculation on received data items","and combine outputs from these calculations","nodes perform calculation on received data items\nand combine outputs from these calculations","child executes concurrently with parent","inherits some state from parent e.g. open fd's","runs in its own address space","child executes concurrently with parent\ninherits some state from parent e.g. open fd's\nruns in its own address space","process switching requires kernel intervention","each has a significant amount of state","process interaction requires system-level mechanisms","process switching requires kernel intervention\neach has a significant amount of state\nprocess interaction requires system-level mechanisms","processes are independent of each other threads exist within a parent process","processes have own state threads share parent process state","each process has own address space all threads within a process share one address space","processes communicate via ipc mechanisms see later threads can communicate via shared memory","context-switching between processes is expensive context-switching between threads is relatively cheap","processes are independent of each other threads exist within a parent process\nprocesses have own state threads share parent process state\neach process has own address space all threads within a process share one address space\nprocesses communicate via ipc mechanisms see later threads can communicate via shared memory\ncontext-switching between processes is expensive context-switching between threads is relatively cheap","requires include","provides opaque pthread_t data type","functions on threads create identify send signals exit ...","requires include\nprovides opaque pthread_t data type\nfunctions on threads create identify send signals exit ...","creates a new thread with specified attributes","thread info stored in thread","thread starts by executing func with arg","returns 0 if ok -1 otherwise and sets errno","creates a new thread with specified attributes\nthread info stored in thread\nthread starts by executing func with arg\nreturns 0 if ok -1 otherwise and sets errno","returns pthread_t for current thread","in some ways analogous to getpid","returns pthread_t for current thread\nin some ways analogous to getpid","compares two thread ids","returns non-zero if same thread 0 otherwise","compares two thread ids\nreturns non-zero if same thread 0 otherwise","suspend execution until thread t terminates","pthread_exit value is placed in value_ptr","if t has already exited does not wait","suspend execution until thread t terminates\npthread_exit value is placed in value_ptr\nif t has already exited does not wait","terminate execution of thread and do some cleaning up","stores a return value in value_ptr","terminate execution of thread and do some cleaning up\nstores a return value in value_ptr","each process runs to completion before next one starts","low throughput not acceptable on multi-user systems","each process runs to completion before next one starts\nlow throughput not acceptable on multi-user systems","if one process is delayed others can run","if we have multiple cpus use all of them at once","if one process is delayed others can run\nif we have multiple cpus use all of them at once","each process runs and completes its task","without any effect on the computation of other processes","each process runs and completes its task\nwithout any effect on the computation of other processes","multiple processes accessing a shared resource","one process synchronizing with another for some computation","multiple processes accessing a shared resource\none process synchronizing with another for some computation","nondeterminism ... same code different runs different results e.g. output on shared resource is jumbled e.g. input from shared resource is unpredictable","e.g. output on shared resource is jumbled","e.g. input from shared resource is unpredictable","deadlock ... a group of processes end up waiting for each other","starvation ... one process keeps missing access to resource","nondeterminism ... same code different runs different results e.g. output on shared resource is jumbled e.g. input from shared resource is unpredictable\ne.g. output on shared resource is jumbled\ne.g. input from shared resource is unpredictable\ndeadlock ... a group of processes end up waiting for each other\nstarvation ... one process keeps missing access to resource","e.g. output on shared resource is jumbled","e.g. input from shared resource is unpredictable","e.g. output on shared resource is jumbled\ne.g. input from shared resource is unpredictable","each process attempts to withdraw $300 a","each process attempts to withdraw $300 a","process 1 executes up to line 3 then swapped out","process 2 executes up to line 3 then swapped out","process 1 continues and reduces balance by $300","process 2 continues and reduces balance by $300","process 1 executes up to line 3 then swapped out\nprocess 2 executes up to line 3 then swapped out\nprocess 1 continues and reduces balance by $300\nprocess 2 continues and reduces balance by $300","provide correct sequencing of interactions between processes","coordinate semantically-valid access to shared resources","provide correct sequencing of interactions between processes\ncoordinate semantically-valid access to shared resources","shared memory based e.g. semaphores","message passing based e.g. send/receive","shared memory based e.g. semaphores\nmessage passing based e.g. send/receive","available via special library functions or","available via new language constructs","available via special library functions or\navailable via new language constructs","uses shared variable manipulated atomically","blocks if access unavailable decrements once available","uses shared variable manipulated atomically\nblocks if access unavailable decrements once available","processes communicate by sending/receiving messages","receiver can block waiting for message to arrive","sender may block waiting for message to be received synchronous message passing sender waits for ack of receipt asynchronous message passing sender transmits and continues","synchronous message passing sender waits for ack of receipt","asynchronous message passing sender transmits and continues","processes communicate by sending/receiving messages\nreceiver can block waiting for message to arrive\nsender may block waiting for message to be received synchronous message passing sender waits for ack of receipt asynchronous message passing sender transmits and continues\nsynchronous message passing sender waits for ack of receipt\nasynchronous message passing sender transmits and continues","synchronous message passing sender waits for ack of receipt","asynchronous message passing sender transmits and continues","synchronous message passing sender waits for ack of receipt\nasynchronous message passing sender transmits and continues","have a buffer with slots for n items","a process that produces new items and puts them in the buffer","a process that consumes items from the buffer","a mechanism for a process to pause itself","a mechanism for signalling a process to wake up","have a buffer with slots for n items\na process that produces new items and puts them in the buffer\na process that consumes items from the buffer\na mechanism for a process to pause itself\na mechanism for signalling a process to wake up","c checks nitems finds zero decides to pause","just before pausing c is timed-out different to paused","p creates item puts it in currently empty buffer","because buffer now has one item p signals c","because c is not paused signal is lost","c is resumed after time-out and pauses","p resumes and adds more items","eventually buffer fills and p pauses","each process is paused waiting for signal from the other","c checks nitems finds zero decides to pause\njust before pausing c is timed-out different to paused\np creates item puts it in currently empty buffer\nbecause buffer now has one item p signals c\nbecause c is not paused signal is lost\nc is resumed after time-out and pauses\np resumes and adds more items\neventually buffer fills and p pauses\neach process is paused waiting for signal from the other","init sem initvalue set the initial value of semaphore sem","set the initial value of semaphore sem","wait sem also called p if current value of sem 0 decrement sem and continue otherwise block and wait until sem value 0","if current value of sem 0 decrement sem and continue","otherwise block and wait until sem value 0","signal sem also called v increment value of sem and continue","increment value of sem and continue","init sem initvalue set the initial value of semaphore sem\nset the initial value of semaphore sem\nwait sem also called p if current value of sem 0 decrement sem and continue otherwise block and wait until sem value 0\nif current value of sem 0 decrement sem and continue\notherwise block and wait until sem value 0\nsignal sem also called v increment value of sem and continue\nincrement value of sem and continue","set the initial value of semaphore sem","set the initial value of semaphore sem","if current value of sem 0 decrement sem and continue","otherwise block and wait until sem value 0","if current value of sem 0 decrement sem and continue\notherwise block and wait until sem value 0","increment value of sem and continue","increment value of sem and continue","can be achieved via a fifo queue fair but maybe not optimal","can be achieved via a fifo queue fair but maybe not optimal","semaphores are updated atomically","so can't timeout in if nitems 0 pause","semaphores are updated atomically\nso can't timeout in if nitems 0 pause","only one process at a time manipulates the buffer","allows multiple producers/consumers to interact correctly","only one process at a time manipulates the buffer\nallows multiple producers/consumers to interact correctly","include giving sem_t","int sem_init sem_t sem int shared uint value create a semaphore object and set initial value","create a semaphore object and set initial value","int sem_wait sem_t sem i.e. wait try to decrement block if sem 0","try to decrement block if sem 0","int sem_post sem_t sem i.e. signal increment the value of semaphore sem","increment the value of semaphore sem","int sem_destroy sem_t sem free all memory associated with semaphore sem","free all memory associated with semaphore sem","include giving sem_t\nint sem_init sem_t sem int shared uint value create a semaphore object and set initial value\ncreate a semaphore object and set initial value\nint sem_wait sem_t sem i.e. wait try to decrement block if sem 0\ntry to decrement block if sem 0\nint sem_post sem_t sem i.e. signal increment the value of semaphore sem\nincrement the value of semaphore sem\nint sem_destroy sem_t sem free all memory associated with semaphore sem\nfree all memory associated with semaphore sem","create a semaphore object and set initial value","create a semaphore object and set initial value","try to decrement block if sem 0","try to decrement block if sem 0","increment the value of semaphore sem","increment the value of semaphore sem","free all memory associated with semaphore sem","free all memory associated with semaphore sem","source process sends a message to a target process","target process uses message to invoke appropriate code","may send a reply message containing the computed result","source process sends a message to a target process\ntarget process uses message to invoke appropriate code\nmay send a reply message containing the computed result","data is passed by copying value into a message cf. parameters","particularly effective for concurrent distributed systems","data is passed by copying value into a message cf. parameters\nparticularly effective for concurrent distributed systems","synchronous sender transmits message waits for response familiar programming model like a remote function call","sender transmits message waits for response","familiar programming model like a remote function call","asynchronous sender transmits message continues with own task reponse arrival eventually interrupts original sender","sender transmits message continues with own task","reponse arrival eventually interrupts original sender","synchronous sender transmits message waits for response familiar programming model like a remote function call\nsender transmits message waits for response\nfamiliar programming model like a remote function call\nasynchronous sender transmits message continues with own task reponse arrival eventually interrupts original sender\nsender transmits message continues with own task\nreponse arrival eventually interrupts original sender","sender transmits message waits for response","familiar programming model like a remote function call","sender transmits message waits for response\nfamiliar programming model like a remote function call","sender transmits message continues with own task","reponse arrival eventually interrupts original sender","sender transmits message continues with own task\nreponse arrival eventually interrupts original sender","could occur on local processor or across wide-area network","could occur on local processor or across wide-area network","mpi_init .. ... initialises message passing environment","mpi_send .. ... send a message synchronous","mpi_recv .. ... send a message synchronous","mpi_init .. ... initialises message passing environment\nmpi_send .. ... send a message synchronous\nmpi_recv .. ... send a message synchronous","goroutines ... concurrently executing functions","channels ... communication pipes between goroutines","select ... manage multiple channels","goroutines ... concurrently executing functions\nchannels ... communication pipes between goroutines\nselect ... manage multiple channels","signals kill wait signal handlers","accessing the same resource e.g. writing onto the same file","pipes stdout of process a goes into stdin of process b","message queues passing data between each other","sockets client-server style interaction","signals kill wait signal handlers\naccessing the same resource e.g. writing onto the same file\npipes stdout of process a goes into stdin of process b\nmessage queues passing data between each other\nsockets client-server style interaction","two processes writing to same file simultaneously","order of output depends on actions of opaque scheduler","two processes writing to same file simultaneously\norder of output depends on actions of opaque scheduler","controls access to shared files note files not fds","possible operations lock_sh ... acquire shared lock lock_ex ... acquire exclusive lock lock_un ... unlock lock_nb ... operation fails rather than blocking","lock_sh ... acquire shared lock","lock_ex ... acquire exclusive lock","lock_un ... unlock","lock_nb ... operation fails rather than blocking","in blocking mode flock does not return until lock available","only works correctly if all processes accessing file use locks","return value 0 in success -1 on failure","controls access to shared files note files not fds\npossible operations lock_sh ... acquire shared lock lock_ex ... acquire exclusive lock lock_un ... unlock lock_nb ... operation fails rather than blocking\nlock_sh ... acquire shared lock\nlock_ex ... acquire exclusive lock\nlock_un ... unlock\nlock_nb ... operation fails rather than blocking\nin blocking mode flock does not return until lock available\nonly works correctly if all processes accessing file use locks\nreturn value 0 in success -1 on failure","lock_sh ... acquire shared lock","lock_ex ... acquire exclusive lock","lock_un ... unlock","lock_nb ... operation fails rather than blocking","lock_sh ... acquire shared lock\nlock_ex ... acquire exclusive lock\nlock_un ... unlock\nlock_nb ... operation fails rather than blocking","if file not locked or other shared locks ok","if file has exclusive lock blocked","if file not locked or other shared locks ok\nif file has exclusive lock blocked","if file is not locked ok","if any locks shared or exclusive on file blocked","if file is not locked ok\nif any locks shared or exclusive on file blocked","flock returns 0 if lock was acquired","flock returns -1 if process would have been blocked","flock returns 0 if lock was acquired\nflock returns -1 if process would have been blocked","producer process writes to byte stream cf. stdout","consumer process reads from same byte stream","producer process writes to byte stream cf. stdout\nconsumer process reads from same byte stream","producer blocks when buffer full consumer blocks when buffer empty","producer blocks when buffer full consumer blocks when buffer empty","open two file descriptors to be shared by processes","fd 0 is opened for reading fd 1 is opened for writing","return 0 if ok otherwise return -1 and sets errno","open two file descriptors to be shared by processes\nfd 0 is opened for reading fd 1 is opened for writing\nreturn 0 if ok otherwise return -1 and sets errno","fork to create a child process","both processes have copies of fd","one can write to fd 1 the other can read from fd 0","fork to create a child process\nboth processes have copies of fd\none can write to fd 1 the other can read from fd 0","set up a pipe between parent and child","exec child to become a new process talking to parent","set up a pipe between parent and child\nexec child to become a new process talking to parent","analogous to fopen except first arg is a command","cmd is passed to shell for interpretation","returns file which be read/written depending on mode","returns null if can't establish pipe or invalid cmd","analogous to fopen except first arg is a command\ncmd is passed to shell for interpretation\nreturns file which be read/written depending on mode\nreturns null if can't establish pipe or invalid cmd","processes come initially from parent/child pair fork","connection established via shared file descriptions","processes come initially from parent/child pair fork\nconnection established via shared file descriptions","for unrelated processes to pass information","along a buffered channel shared by many processes","for unrelated processes to pass information\nalong a buffered channel shared by many processes","mq names look like /somecharacters no slash chars","mq names look like /somecharacters no slash chars","create a new message queue or open existing one","flags are like those for fopen e.g. o_rdonly","create a new message queue or open existing one\nflags are like those for fopen e.g. o_rdonly","finish accessing message queue mq","the message queue continues to exist cf. fclose","finish accessing message queue mq\nthe message queue continues to exist cf. fclose","adds message msg to message queue mq","prio gives priority determines order of messages on mq","if mq is full ... blocks until mq space available if o_nonblock is set fails and returns error","blocks until mq space available","if o_nonblock is set fails and returns error","also mq_timedsend which waits for specified time if mq full fails if still no space on mq after timeout","waits for specified time if mq full","fails if still no space on mq after timeout","adds message msg to message queue mq\nprio gives priority determines order of messages on mq\nif mq is full ... blocks until mq space available if o_nonblock is set fails and returns error\nblocks until mq space available\nif o_nonblock is set fails and returns error\nalso mq_timedsend which waits for specified time if mq full fails if still no space on mq after timeout\nwaits for specified time if mq full\nfails if still no space on mq after timeout","blocks until mq space available","if o_nonblock is set fails and returns error","blocks until mq space available\nif o_nonblock is set fails and returns error","waits for specified time if mq full","fails if still no space on mq after timeout","waits for specified time if mq full\nfails if still no space on mq after timeout","removes highest priority message from queue mq","if prio is not null receives message priority","if mq is empty ... blocks until a message is added to mq if o_nonblock is set fails and returns error","blocks until a message is added to mq","if o_nonblock is set fails and returns error","if several processes blocked on mq_receive oldest and highest priority process receives the message","oldest and highest priority process receives the message","removes highest priority message from queue mq\nif prio is not null receives message priority\nif mq is empty ... blocks until a message is added to mq if o_nonblock is set fails and returns error\nblocks until a message is added to mq\nif o_nonblock is set fails and returns error\nif several processes blocked on mq_receive oldest and highest priority process receives the message\noldest and highest priority process receives the message","blocks until a message is added to mq","if o_nonblock is set fails and returns error","blocks until a message is added to mq\nif o_nonblock is set fails and returns error","oldest and highest priority process receives the message","oldest and highest priority process receives the message","assume that both processes are on the same host","assume that both processes are on the same host","e.g. web servers networked databases networked message queues ...","e.g. web servers networked databases networked message queues ...","commonly used to construct client-server systems","either locally unix domain or network-wide internet domain","server creates a socket then ... binds to an address local or network listens for connections from clients","binds to an address local or network","listens for connections from clients","client creates a socket then ... connects to the server using known address writes to server via socket i.e. sends requests reads from server via socket i.e. receives responses","connects to the server using known address","writes to server via socket i.e. sends requests","reads from server via socket i.e. receives responses","commonly used to construct client-server systems\neither locally unix domain or network-wide internet domain\nserver creates a socket then ... binds to an address local or network listens for connections from clients\nbinds to an address local or network\nlistens for connections from clients\nclient creates a socket then ... connects to the server using known address writes to server via socket i.e. sends requests reads from server via socket i.e. receives responses\nconnects to the server using known address\nwrites to server via socket i.e. sends requests\nreads from server via socket i.e. receives responses","binds to an address local or network","listens for connections from clients","binds to an address local or network\nlistens for connections from clients","connects to the server using known address","writes to server via socket i.e. sends requests","reads from server via socket i.e. receives responses","connects to the server using known address\nwrites to server via socket i.e. sends requests\nreads from server via socket i.e. receives responses","requires include","creates a socket using ... domain ... communications domain af_local ... on the local host unix domain af_inet ... over the network internet domain type ... semantics of communication sock_stream ... sequenced reliable communications stream sock_dgram ... connectionless unreliable packet transfer protocol ... communication protocol many exist see /etc/protocols e.g. ip tcp udp ...","domain ... communications domain af_local ... on the local host unix domain af_inet ... over the network internet domain","af_local ... on the local host unix domain","af_inet ... over the network internet domain","type ... semantics of communication sock_stream ... sequenced reliable communications stream sock_dgram ... connectionless unreliable packet transfer","sock_stream ... sequenced reliable communications stream","sock_dgram ... connectionless unreliable packet transfer","protocol ... communication protocol many exist see /etc/protocols e.g. ip tcp udp ...","many exist see /etc/protocols e.g. ip tcp udp ...","returns a socket descriptor small int or -1 on error","requires include\ncreates a socket using ... domain ... communications domain af_local ... on the local host unix domain af_inet ... over the network internet domain type ... semantics of communication sock_stream ... sequenced reliable communications stream sock_dgram ... connectionless unreliable packet transfer protocol ... communication protocol many exist see /etc/protocols e.g. ip tcp udp ...\ndomain ... communications domain af_local ... on the local host unix domain af_inet ... over the network internet domain\naf_local ... on the local host unix domain\naf_inet ... over the network internet domain\ntype ... semantics of communication sock_stream ... sequenced reliable communications stream sock_dgram ... connectionless unreliable packet transfer\nsock_stream ... sequenced reliable communications stream\nsock_dgram ... connectionless unreliable packet transfer\nprotocol ... communication protocol many exist see /etc/protocols e.g. ip tcp udp ...\nmany exist see /etc/protocols e.g. ip tcp udp ...\nreturns a socket descriptor small int or -1 on error","domain ... communications domain af_local ... on the local host unix domain af_inet ... over the network internet domain","af_local ... on the local host unix domain","af_inet ... over the network internet domain","type ... semantics of communication sock_stream ... sequenced reliable communications stream sock_dgram ... connectionless unreliable packet transfer","sock_stream ... sequenced reliable communications stream","sock_dgram ... connectionless unreliable packet transfer","protocol ... communication protocol many exist see /etc/protocols e.g. ip tcp udp ...","many exist see /etc/protocols e.g. ip tcp udp ...","domain ... communications domain af_local ... on the local host unix domain af_inet ... over the network internet domain\naf_local ... on the local host unix domain\naf_inet ... over the network internet domain\ntype ... semantics of communication sock_stream ... sequenced reliable communications stream sock_dgram ... connectionless unreliable packet transfer\nsock_stream ... sequenced reliable communications stream\nsock_dgram ... connectionless unreliable packet transfer\nprotocol ... communication protocol many exist see /etc/protocols e.g. ip tcp udp ...\nmany exist see /etc/protocols e.g. ip tcp udp ...","af_local ... on the local host unix domain","af_inet ... over the network internet domain","af_local ... on the local host unix domain\naf_inet ... over the network internet domain","sock_stream ... sequenced reliable communications stream","sock_dgram ... connectionless unreliable packet transfer","sock_stream ... sequenced reliable communications stream\nsock_dgram ... connectionless unreliable packet transfer","many exist see /etc/protocols e.g. ip tcp udp ...","many exist see /etc/protocols e.g. ip tcp udp ...","associates an open socket with an address","for unix domain address is a pathname in the file system","for internet domain address is ip address port number","associates an open socket with an address\nfor unix domain address is a pathname in the file system\nfor internet domain address is ip address port number","wait for connections on socket sockfd","allow at most backlog connections to be queued up","wait for connections on socket sockfd\nallow at most backlog connections to be queued up","sin_family ... domain af_unix or af_inet","sin_port ... port number 80 443 etc.","sin_addr ... structure containing host address","sin_zero 8 ... padding","sin_family ... domain af_unix or af_inet\nsin_port ... port number 80 443 etc.\nsin_addr ... structure containing host address\nsin_zero 8 ... padding","sockfd has been created bound and is listening","blocks until a connection request is received","sets up a connection between client/server after connect","places information about the requestor in addr","returns a new socket descriptor or -1 on error","sockfd has been created bound and is listening\nblocks until a connection request is received\nsets up a connection between client/server after connect\nplaces information about the requestor in addr\nreturns a new socket descriptor or -1 on error","connects the socket sockfd to address addr","assumes that addr contains a process listening appropriately","returns 0 on success or -1 on error","connects the socket sockfd to address addr\nassumes that addr contains a process listening appropriately\nreturns 0 on success or -1 on error","g parallelism/concurrency","parallelism/concurrency","concurrency/parallelism2/59","parallelism multiple computations executed simultaneously","both parallelism and concurrency need to deal with synchronisation.","... concurrency/parallelism3/59","example of simd parallel processing e.g. gpu","but not totally independent need to synchronise on completion","... concurrency/parallelism4/59","map-reduce is a programming model for","... concurrency/parallelism5/59","canonical example compute word frequencies","creating concurrency6/59","one method for creating concurrent tasks","fork creates a new child process","... creating concurrency7/59","alternative mechanism for concurrent tasks threads","difference between threads and processes","linux/unix threads8/59","pthreads posix implementation of threads","... linux/unix threads9/59","int pthread_create pthread_t thread pthread_attr_t attr void func void void arg","... linux/unix threads10/59","pthread_t pthread_self void","... linux/unix threads11/59","int pthread_join pthread_t t void value_ptr","concurrency12/59","the alternative to concurrency ... sequential execution","... concurrency13/59","in reality processes are often not independent","... concurrency14/59","example of problematic concurrency ... bank withdrawal","scenario two processes one account a initial balance $500","... concurrency15/59","restatement of program","possible outcome of scenario","concurrency control16/59","concurrency control aims to","... concurrency control17/59","shared memory approach","producer-consumer problem18/59","classic example for concurrency control issues","... producer-consumer problem19/59","data objects shared by two processes","functions on buffer simplified view","... producer-consumer problem20/59","producer process p","... producer-consumer problem21/59","consumer process c","... producer-consumer problem22/59","a possible scenario assumes signals only reach paused processes","semaphores23/59","semaphore operations","... semaphores24/59","using semaphores for the producer-consumer problem","the mutex semaphore ensures that","... semaphores25/59","using semaphores for the producer-consumer problem cont","... semaphores26/59","using semaphores for the producer-consumer problem cont","... semaphores27/59","semaphores on linux/unix ...","message passing28/59","message passing a method for invoking computations","... message passing29/59","message passing systems can be ...","... message passing30/59","message passing architecture","... message passing31/59","a standard message passing framework mpi has been defined","bindings exist for many languages e.g. c c java python ...","other languages have message passing built in","... message passing32/59","example of message passing with language support google's go","... message passing33/59","bank withdrawal example using go","for more info on go see https //tour.golang.org/","process interaction","interacting processes35/59","processes can interact via","... interacting processes36/59","example of problematic process interaction","could control access to file via semaphores","an alternative less general mechanism file locking","file locking37/59","int flock int filedesc int operation","... file locking38/59","if a process tries to acquire a shared lock ...","pipes39/59","a common style of process interaction communication","a pipe provides buffered i/o between producer and consumer","... pipes40/59","int pipe int fd 2","... pipes41/59","creating a pipe ...","... pipes42/59","example setting up a pipe","... pipes43/59","a common pattern in pipe usage","file popen char cmd char mode","... pipes44/59","example of popen","message queues45/59","pipes operate between two processes on same host","... message queues46/59","message queue architecture","... message queues47/59","requires include giving mqd_t","mqd_t mq_open char name int flags","int mq_close mqd_t mq","... message queues48/59","int mq_send mqd_t mq char msg int size uint prio","... message queues49/59","int mq_receive mqd_t mq char msg int size uint prio","... message queues50/59","pseudo-code showing structure of a mq server program","... message queues51/59","pseudo-code showing structure of a mq client program","sockets52/59","inter-process communication ipc mechanisms considered so far","... sockets53/59","socket an end-point of an ipc channel","... sockets54/59","int socket int domain int type int protocol","... sockets55/59","int bind int sockfd sockaddr addr socklen_t addrlen","... sockets56/59","sockaddr struct sockaddr_in","... sockets57/59","int accept int sockfd sockaddr addr socklen_t addrlen","... sockets58/59","pseudo-code showing structure of a simple client program","see http //www.linuxhowtos.org/c_c /socket.htm","... sockets59/59","pseudo-code showing structure of a server program","produced 2 may 2018","comp1521 18s2, spim instruction set, computer system fundamentals","reg, name, description","$0, zero, the value 0 not changeable","$1, $at, assembler temporary reserved for assembler use","$2 $3, $v0 $v1, value from expression evaluation or function return","$4..$7, $a0..$a3, first four arguments to a function/subroutine if needed","$8..$15, $t0..$t7, temporary must be saved by caller to subroutine subroutine can overwrite","$16..$23, $s0..$s7, safe function variable must not be overwritten by called subroutine","$24..$25, $t8..$t9, temporary must be saved by caller to subroutine subroutine can overwrite","$26..$27, $k0..$k1, for kernel use may change unexpectedly","$28, $gp, global pointer address of global area","$29, $sp, stack pointer top of stack","$30, $fp, frame pointer bottom of current stack frame","$31, $ra, return address of most recent caller","reg, description","$f0..$f2, value floating-point expression evaluation or function return","$f4..$f10, temporary must be saved by caller to subroutine subroutine can overwrite","$f12..$f14, first two double-precision function arguments","$f16..$f18, temporary registers used for expression evaluation","$f20..$f30, safe function variables must be preserved across function calls","operand, description","rn, a register rs and rt are sources and rd is a destination","imm, a constant value a literal constant in decimal or hexadecimal format","label, a symbolic name which is associated with a memory address","addr, a memory address in one of the formats described below","format, address","label, the address associated with the label","rn, the value stored in register rn indirect address","imm rn, the sum of imm and the value stored in register rn","label rn, the sum of label's address and the value stored in register rn","label imm, the sum of label's address and imm","label imm rn, the sum of label's address imm and the value stored in register rn",", instruction, description",", add, rd rs rt, rd rs rt signed",", addu, rd rs rt, rd rs rt unsigned",", addi, rd rs imm, rd rs imm signed",", sub, rd rs rt, rd rs - rt signed",", subu, rd rs rt, rd rs - rt unsigned",", div, rs rt, lo rs / rt hi rs rt int division signed",", divu, rs rt, lo rs / rt hi rs rt int division unsigned",", div, rd rs rt, rd rs / rt int division signed",", divu, rd rs rt, rd rs / rt int division unsigned",", rem, rd rs rt, rd rs rt modulo signed",", remu, rd rs rt, rd rs rt modulo unsigned",", mul, rd rs rt, rd rs rt signed",", mult, rs rt, hi lo rs rt lo bits 0..31 hi bits 32..63 signed",", multu, rs rt, hi lo rs rt lo bits 0..31 hi bits 32..63 unsigned","",", and, rd rs rt, rd rs rt",", and, rd rs imm, rd rs imm",", neg, rd rs, rd rs",", nor, rd rs rt, rd rs rt",", not, rd rs, rd rs",", or, rd rs rt, rd rs rt",", ori, rd rs imm, rd rs imm",", xor, rd rs rt, rd rs rt",", xori, rd rs imm, rd rs imm",", sll, rd rt imm, rd rt imm",", sllv, rd rs rt, rd rt rs",", srl, rd rt imm, rd rt imm",", srlv, rd rs rt, rd rt rs","",", move, rd rs, rd rs",", mfhi, rd, rd hi",", mflo, rd, rd lo",", la, rd addr, rd addr",", li, rd imm, rd imm",", lui, rd imm, rd 0..15 0 rd 16..31 imm",", lb, rd addr, rd byte at mem addr sign extended addr could be label rt",", lw, rd addr, rd word at mem addr addr could be label rt",", sb, rs addr, mem addr rs sign extended addr could be label rt",", sw, rs addr, mem addr rs addr could be label rt","",", slt, rd rs rt, rd 1 if rs rt rd 0 otherwise signed",", slti, rd rs imm, rd 1 if rs imm rd 0 otherwise signed",", sltu, rd rs rt, rd 1 if rs rt rd 0 otherwise unsigned","",", beq, rs rt label, branch to label if rs rt signed",", beqz, rs label, branch to label if rs 0 signed",", bge, rs rt label, branch to label if rs rt signed",", bgez, rs label, branch to label if rs 0 signed",", bgezal, rs label, branch to label and and $ra pc 8 if rs 0 signed",", bgt, rs rt label, branch to label if rs rt signed",", bgtu, rs rt label, branch to label if rs rt unsigned",", bgtz, rs label, branch to label if rs 0 signed",", blt, rs rt label, branch to label if rs rt signed",", bltu, rs rt label, branch to label if rs rt unsigned",", bltz, rs label, branch to label if rs 0 signed",", bltzl, rs label, branch to label and $ra pc 8 if rs 0 signed",", bne, rs rt label, branch to label if rs rt",", bnez, rs label, branch to label if rs 0","",", j, label, jump to label pc label",", jal, label, jump to label and link $ra pc 8 pc label",", jr, rs, jump to location in rs",", jalr, rs, jump to location in rs and link $ra pc 8 pc label",", syscall, , invoke system service service given in $v0","service, code, arguments, result","print_int, 1, $a0 integer, ","print_float, 2, $f12 float, ","print_double, 3, $f12 double, ","print_string, 4, $a0 char, ","read_int, 5, , integer in $v0","read_float, 6, , float in $v0","read_double, 7, , double in $v0","read_string, 8, $a0 buffer $a1 length, string in buffer","sbrk, 9, $a0 bytes, extend data segment","exit, 10, , program exits","print_char, 11, $a0 char, ","directive, description",".text, the instructions following this directive are placed in the text segment of memory",".data, the data defined following this directive is placed in the data segment of memory",".space n, allocate n unitialised bytes of space in the data segment of memory",".word val1 val2 ..., store values in successive words in the data segment of memory",".byte val1 val2 ..., store values in succesive bytes in the data segment of memory",".asciiz string, store ' 0'-terminated string in the data segment of memory","an overview of the instruction set in the spim mips emulator. based on a document from the university of stuttgart.","the spim emulator implements instructions from the mips32 instruction set as well as pseudo-instructions which look like mips instrcutions but are not actually provided on the mips32 hardware .","mips has 32 32-bit general purpose registers and 16 64-bit floating point registers as well a two special registers hi and lo for manipulating 64-bit integer quantities. in addition it has a memory which is partitioned as follows","the 32 general purpose registers can be referenced as $0..$31 or by symbolic names and are used as follows","the 16 floating point registers are referenced in pairs each pair is 64-bits.","each instruction is written on a single line and has the general format","some instructions have only one operand others have two and many have three.","the following notation is used in describing operands in the description of instructions below.","many instructions have one operand which is an address. addresses can be written in a number of formats","real mips instructions are marked with a . all other instructions are pseudoinstructions special to the spim emulator. operators in expressions have the same meaning as their c counterparts.","the spim emulator provides a number of mechanisms for interacting with the host system. these services are invoked via the syscall pseudo-instruction after storing the service code in the register $v0.","the spim assembler supports a number of directives which allow things to be specified at assembly time.","comp1521 18s2, installing spim, computer system fundamentals","how to install the spim command-line interface to the spim emulator.","there's a copy of the spim source code from sourceforge in the file /home/cs1521/web/18s2/docs/spim.zip. download this to your laptop and unzip","change into the spim/ directory and change the following lines in the makefile","you can install spim and the exceptions code anywhere you like. i changed these lines to","the directories do not need to exist yet the intsallation process will create them if needed.","now still in the spim/ directory compile spim","you may get one warning which you can ignore or fix if you're pedantic .","if you don't have bison and flex installed on your machine you'll get errors in the step above. since bison and flex are programs that generate other c programs you might be able to get away with grabbing the already created version of parser_yacc.cpp and lex.yy.cpp from the directory cs1521/spim/spim on the cse machines putting them in the spim directory touching them to fool make and then trying the make step again.","now install spim in the specified directories","once you've done this you should be able to run spim. i would do","assuming that i had a file called xxx.s in the current directory. naturally you would use the name of the directory where you placed the spim executable and not /home/jas/bin.","if you'd rather type just spim instead of the full path name fix your command path by putting the following line in your /.profile file","except of course use your own directory name not mine."]}