{"posts":[null,{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" When I try to fscanf in from the history file, I have bits of the previously scanned line or am missing parts of the new line. How do I avoid this? I am currently placing the scanned string into a buffer char[] of length 100 (a chosen buffer length) and reusing that char for each scanf. ","answers":[" Don't use fscanf() . Use fgets() to read each line into a buffer and then use sscanf() to parse the text in the buffer. ",[" Thank you! "]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" What is this memory leak? On line 299 the code I have on mymysh.c is : if (strcmp(args[i], \"&lt;\") == EQUAL) { (my code doesn't even go to 299 on history.c) ","answers":[" at the moment all I can tell is that you are calling strdup in findExecutable() and never freeing the result. "," its line 299 in the malloc.c file. You don't appear to be compiling with the -g flag so it's not giving very good info. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Is it ok if our child processes have memory leaks when exiting? My parent program has none but I find if I exit out of my child one when it's not 'ready' eg because it has an error or w/e, it has memory leaks. But when it exits into the parent one, the parent one doesn't have any. I've been trying to fix this 'bug' for hours and I'm not sure if I could ","answers":[]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" I was hoping someone could explain why 'showCommandHistory' is supposed to take a file input in the history scaffold. The parameter has two different names: In history.h: void showCommandHistory(FILE *histFile); In history.c: void showCommandHistory(FILE *outf) {} I thought it might be to redirect output, but displaying history shouldn't ever redirect (going by the example program). The other option would be to read in the history from the history file, but the history is already loaded into the 'CommandHistory' struct, and that is all I use to display the command history. Am I missing something obvious or is this parameter useless? ","answers":[" The parameter makes the SaveCommandHistory function easier to write ",[" Ahh ok thank you! "]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" \"cd\" is not working when I input \"cd\" by itself, and then cd'ing into another folder I know I have. cd works when I am in ~cs1521 folder, but not when I'm in my home directory. I am wondering if it is a permission issue, or my code's issue. Anyone else? ","answers":[" Does cd ~/KnownFolder work? When you use cd by itself, what do you see if the next command is pwd or ls ? ",[" All 3 of your suggestions work - it is only when I try to cd \"file\" when it does not work. The error is triggered by chdir() returning -1. ",[" You can't cd to a file, if that's what your comment meant. And if you're putting quotes around the directory name that you want to cd to, that won't work either. Have a read of man 2 chdir ... do any of the errors mentioned there apply in your case? ",[" Sorry I phrased that very carelessly, I meant directory and the quotations weren't part of input. I've looked up chdir, but am unsure how to check the error output except for the fact chdir() returns -1 if it fails (which I've used to print \"no such file or directory\". How do I print errno to output so I can find out which error I am facing? Thanks Edit: worked it out by passing absolute path to chdir, instead of just relative path before. ",[" perror() will tell you which error "]]]]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hi, I'm currently trying to add an extra element onto my tokens[] array to implement glob() properly. Assuming that it was tokenised to have 2 elements: - ls - *.c How would I create a new one so that I can include the wildcard returns from *.c? I've tried things such as the following: i = 3; tokens[i++] = strdup(gl_pathc[i]); But I receive an illegal array pointer. I thought that strdup would allocate the memory for me. Thanks for any help. ","answers":[" First off, gl_pathc is an int. gl_pathv is the array you want. Secondly, you will need to realloc the tokens array to its current size plus gl_argc-1. If you take this approach. Both of there problems will cause an illegal array error. To fix this you could realloc like I mentioned above or you could use GLOB_NOCHECK as a flag to glob and call glob on all elements of the tokens array in order. This will give you back a gl_pathv array that you can use as your new tokens array, without needing to strdup every element. ",[" Ahhh. Finally got it! Thank you Dylan. The only thing is, I'm not sure whether I should tokenise this gl_pathv array or not. I'm currently returning gl_pathv but it sometimes works and then sometimes SegFaults. I assume this has to do with running out of memory (maybe?) I can return gl_pathv but then I'm not able to free it at the end of my program because it's not recognised as a glob_t anymore. Alternatively, I could tokenise it and send this back but I'm not sure what I would pass as the second argument of tokenise. There is no string that separates each token. Have I missed something? EDIT: I should also mention that I'm using the GLOB_APPEND flag. ",[" gl_pathv is a tokenised array. You can free it with freeTokens. ",[" OK thank you for that. Do you know why I would be getting this error message then when I input: ls ~ It seems to be intermittent and I can't figure out why. It goes away when I create a debug loop printing out all the gl_pathv strings and then comes back when I delete this loop. I can't figure out why this would be happening. mymysh.c:234 runtime error - illegal array, pointer or other operation Execution stopped here in fileNameExpand(tokens=0x60300000c850) in mymysh.c at line 234: int i; for(i=0; tokens[i] !=NULL; i++){ --&gt; glob(tokens[i], GLOB_TILDE|GLOB_NOCHECK|GLOB_APPEND, 0, &amp;result); } Values when execution stopped: i = 0 tokens[i] = \"ls\" Let me know if it's easier if I email my code. ",[" The first call to glob shouldn't have GLOB_APPEND only on subsequent calls. Also the second last argument should be NULL not 0. ",[" Thank you so much Dylan! "]]]]]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hello, I am confused as to how far back our code should go with this input 'ls /*' - my ref imp is functioning for \"ls /*/*\" but breaking on \"ls /*/*/*\" - my implementation works up to /*/*/* but is snail pace on /*/*/*/* - also the actual bash on cse says argument list is too long if you try to do this outside the mymysh How far back do we have to do? Thanks ","answers":[" As far as the example goes. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" No such File/ directory error: I keep getting this error when I do \"cat &lt; xyx.txt\" even though it does execute the command and print the contents of the file to the terminal. I cant seem to figure out where I'm going wrong, because the error isn't any of the ones I'v set up using perror. Any ideas where I should be checking? ","answers":[" you're passing &lt; as an argument to cat , you need to remove &lt; and the file name after you do the redirection and before you execve . ",[" Fixed! Thank you so much! "]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" I understand when you call execve and it succeeds, it throws away the child process after the execution. However, if it fails, the child process is still running. How do I close the child process? My issue is, when I type the command ./nonexec execve fails but it doesn't close the forked shelled. Therefore, I have to type exit 2 times instead of 1 ","answers":[" Put a call to the exit() function after you print the error message for execve() failing ",[" Thank you. I was trying kill ( 0 , SIGTERM ); and kill ( 0 , SIGKILL ); and it wasn't giving the same output, but exit(1) did it. Thanks. "]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" If we were to run an invalid command such as \"cat &lt;\" , is it necessary to print an error message and then proceed to ask for input (prompt) ? ","answers":[" Go by what the example does. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Do we have any guarantees on the maximum size of the expanded form of the string \"$HOME/.mymysh_history\"? ","answers":[" $HOME wont be longer than MAX_PATH The whole thing shouldn't be longer than MAX_PATH but that's not entirely guaranteed. ",[" Where's MAX_PATH defined? ",[" #include &lt;linux/limits.h&gt; Although it is probably better to just use strlen() on the return of getenv(\"HOME\") "]]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hi, In the suggestions for testing, how is this particular error message generated? I'm asking because the error message that my program produces is different. I don't get \"./nonexec: unknown type of executable\" ","answers":[" What error message do you get? This issue was discussed in another Comments thread . ",[" The error message that I get is \"./nonexec: Exec format error\". I used perror and exit(255) but the message is different. The thread that you linked said that the error was manually printed, does that refer to the \"unknown type of executable part\"? ",[" Clearly mymysh doesn't use perror() ... just copy what mymysh does. ",[" Yes, thank you :) "]]]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" I have a problem with isExecutable() function even though it wasn't modified in any way. I haven't had this error message until today. ","answers":[" nvm i forgot a curly brace somewhere lmao "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Regarding printing errors to stderr or the current output stream, a number of answers already have indicated that when printing our own errors, our choice doesn't matter. However, this creates a functional difference with the reference program. In the tests released today, trying to run the non-executable file nonexec with \"./nonexec\" printed an error message \"./nonexec: unknown type of executable\". If we run with \"./nonexec &gt; ne.out\", the error message gets printed to the ne.out file instead. However, printing the error to stderr in our own programs causes it to be printed to the terminal, rather than the file. Can we assume that the autotests used for marking won't be redirecting commands with error messages? If we can't, can we have a list of when the reference uses stderr and when it uses the current output stream to ensure that our functionality is the same? ","answers":[" We will try to fiddle the output to ensure consistent output whether to stderr/stdout. I'm sure we'll be able to filter the output from your program to knock it into canonical form. If we can't work out how to do it, then we won't use that test, and we can manually check whether you've handled non-executable objects appropriately. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hi, Quick question about the ~cs1521/bin/mymysh : Given a clean history, if 'h' is the first command typed the response is: My current code does this instead: Is the sample solution bugged? Or should we try to follow that? Thanks! ","answers":[" This isn't what I see. When you say \"clean history\", what precisely does that mean? Remove the history file? Make it zero length? Edit it and have a single newline? ",[" Ah I think it was the edit with single new line causing this. Thanks! One more quick question, should sequence numbers begin at 0 or 1? ",[" They begin at 1. "]]," Mine shows nothing with clean history. Hope this may helps :) "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hi, When creating the string \"path\" for opening ~/.mymysh_history, HOME is being changed to the assignment 2 directory. After this code, printf(\"%s\\n\", getenv(\"HOME\"); and printf(\"%s\\n\", path); are the same output. Thanks. ","answers":[" Your declaration of path doesn't allocate any memory. The getenv() function returns a pointer to the string in the environment array. The strcat() function will then try to append the name of the history file to this element in the environment array. The elements in the env array are fixed size; it doesn't make sense to concatenate something onto the end of a full fixed-size array. Define path[] as a large array. Copy the environment string into that array. The append HISTFILE. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Should I add the function to the history if there is an fopen error when I try and redirect stdout (say I do \"ls *.txt &gt;\"), so normally it wouldn't output to a file anything since there is invalid file redirection, but running execve would still return 0 so it is technically a success? My current output is mymysh$ ls *.txt&gt; ls.out Running /bin/ls ... -------------------- fopen failure: Bad address -------------------- Returns 0 Is this acceptable or should I just make it terminate upon an error? ","answers":[" This should result in no execve happening and the command shouldn't be added to the history. The running... should only be printed if you are going to execve and all checks for a valid command should happen first. But the line given should work. ",[" Ok thanks something must be wrong, I'll give it a go "]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hello, When I do something like cat file.txt &gt; test.txt The result in my text.txt is: https://pastebin.com/eK0sJ4nM The content of file.txt is: https://pastebin.com/BvRik5RQ I am unsure of how I am suppose to get rid of the unwanted parts in text.txt ","answers":[" Don't use pastebin. All of those crap ads it spews at you obscure the text. You can paste images into your post using the little mountain icon on the command line just above. ",[" test.txt after running the cat command: file.txt So there s a bunch of unwanted text in test.txt. It should just say: This is the contents of file.txt ",[" looks like your dup2()ing too early in the program. The dup2()s should be inside the child part of the fork. ",[" I think you were right. I added my redirection code in my child process if statement if (pid == 0) , which got rid of the ending divider and return value. However, it is still putting in the top part of the content in my test.txt file. ",[" It still looks like you're dup2 is too early, or at least the Running... is to late. The Running... should be right before the fork. ",[" Hmm... what I am doing is 1. Forking 2. If statement to check if I am in the child. 3. In that if statement in the child, I print \"running\" 4. Execute 5. In parent I print the ending divider ",[" move 3 to before the fork. ",[" Thank you! I fixed it. I just forgot to move the dup2 part again! "],[" 1. Print out \"running\" 2. Forking 3. If statement to check I am in the child 4. In child I execute 5. Print out divider outside the if statement Output of text.txt "]]]]]]]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hi, I'm getting this error everytime i use my file card expansion twice. \"free(): invalid next size (normal) Aborted\". This occurs on the line that I call \"glob(wildcard_s,GLOB_NOCHECK|GLOB_TILDE, 0, &amp;glob_struct);\". what does this mean and how would i fix it? (p.s. it works perfectly fine the first time) ","answers":[" sorry, didn't see the rest. Its because you don't have the GLOB_APPEND flag on your glob call. ",[" I added GLOB_APPEND but that didn't solve anything. I noticed something else though: In this loop args[0] (originally \"ls\") changes midway through the loop. Is there something wrong with the way I'm mallocing? while(j &lt; glob_struct.gl_pathc){ printf(\"args[0] = %s\\n\",args[0]); if(args[i] == NULL){ printf(\"i = %d\\n\",i); args[i] = malloc(sizeof(char)*MAXLINE); } strcpy(args[i],glob_struct.gl_pathv[j]); printf(\"%s\\n\",args[i]); i++; j++; args[i] = NULL; } ",[" Is the args array malloced large enough? The last line sets args[i] to null. If i is 0 this will be bad. "]]," your freeing something that isn't malloced. Run with valgrind or gdb to find out where. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hello can we make the assumption, that the correct usage of '~', will always be as the first letter in a command? What I mean: valid: cd ~/me.txt cd ~cs1521 ls ~ Invalid (I can't think of any examples): ls root/~ ","answers":[" Follow what the example does. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hi, I'm unable to unzip /home/cs1521/web/18s2/assignments/assign2/files.zip, I'm not sure why. Am I doing something wrong? Thanks. ","answers":[" Now fixed. Try again. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" In ~cs1521/bin/mymysh mymysh$ &lt; asdf will print \"Invalid i/o redirection\" Shouldn't it print \"'&lt;: Command not found\"? ","answers":[" That's one way you could do it. ~cs1521/bin/ mymysh does it another (equally valid) way. Copy what the reference solution does. "," This really just has to do with the order that things are checked in. Try to recreate this error. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" In a directory with a file named cd, the provided solution executes the built-in cd command upon the input: *cd &lt;some_filename&gt; Moreover, it does not execute the built-in history command on a similar corresponding setup. Does this constitute a bug, or should we replicate this behaviour? ","answers":[" In a directory with a file named cd, the provided solution executes the built-in cd command This is what I'd expect it to do. I'm not sure what the precise problem is here? If mymysh sees a built-in like cd and h, it processes that and doesn't bother looking for a command with that name in the PATH. A file with the name cd would never be executed, even if the x flag was on. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Just poking this question, will any auto tests be available before the due time? Thanks! _____________________________ Yinan Feng 10 days ago Hi, I wonder can we have some autotest to make sure we do not have silly mistakes including format(\\n,space...) Thank you in advance! &lt;header&gt; John Shepherd 10 days ago &lt;/header&gt;Once I've finished writing an assignment for my other course, I'll put up some testing stuff.However, but this stage, you ought to be able to do testing yourself ...E.g. write a sequence of shell commands in a file, then do something like: ./mymysh &lt; FileOfCommands &gt; out.obs ~cs1521/bin/mymysh &lt; FileOfCommands &gt; out.exp diff out.obs out.exp After all, this is what we do for auto-testing.&lt;footer&gt; &lt;/footer&gt; ","answers":[" Some testing suggestions are now available. Auto-testing, no. See the Notice. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" My output the correct outpu i cant figure out how to get the error names correct and still have them launch to the correct directories. do you have any suggestions? ","answers":[" your code: Execve(tokens[0], tokens, envp) Example code: Execve(command, tokens, envp) The example doesn't modify the tokens array with the full path but creates a new variable, while you are modifying the tokens array. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Several questions: 1. In both redirects, it is written: \"tokens [' &gt;' | '&lt;'] and a filename as the last two tokens\" does it mean that we can treat both cases separately (we can ignore the possibility of input and output in the same command line, example: $ ./executable &lt; input.txt &gt; output.txt) ? 2. In the history part, what does it mean by: \"an executable for the command (first token) actually exists\" isn't all executable counted as valid command? or am I getting it wrong (?) ","answers":[" 1. Getting both an input and output redirection is an error, only one is allowed at a time. 2. If the user enters a command that doesn't exists, eg cta instead of cat then cta isn't added to the history. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hi, Should I be concerned that my program works but I haven't used pipe() anywhere? Thanks, Liz. ","answers":[" You don't necessarily need the pipe function, it would be useful in the challenge though! ",[" Thanks! "]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" When I run my code through valgrind, I get a few of the follow errors: \"Uninitialised value was created by a stack allocation\" \"Conditional jump or move depends on uninitialised values\" \"Uninitialised value was created by a heap allocation\" \"Use of uninitialised value of size 4\" \"Invalid write of size 1\" \"Address 0xsome_address is 0 bytes after a block of size 200 was alloc'd\" However, my code seems to work fine, no compile warnings or errors, and valgrind doesn't report any memory leaks with memcheck. Do I need to be concerned about these errors? What causes them and how can I fix them? ","answers":[" This means that you are using a piece of memory as a condition, probably in a loop or if , before you assign a value. It's a good idea to fix this issue, even more than memory leaks as the memory you're using could have any value stored in it. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" When running the commands: ~cs1521/bin/mymysh&lt;command.txt&gt;exp ./mymysh &lt;command.txt&gt;exp2 I notice that the outputted files have different values, however when output is directly in the shell they are the same. I understand that this is due to stderr when there is an error, however based on the above output I'm not sure what is in stderr?When I run ~cs1521/bin/mymysh&lt;command.txt&gt;exp I get When I run ./mymysh &lt;command.txt&gt;exp2 I get Why would the given shell not output the '-----', below the error message './cat: unknown type of executable'? (cat is just an empty file) ","answers":[" Try doing your redirection using ./mymysh &lt; command.txt &gt; output.txt 2&gt;&amp;1 ",[" Hello, I checked using your command, however it still gives the same output? "]," Your output is more correct, it has to do with the order of error checking in the example i believe. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hi! I have some questions about this assignment. 1. Will our program be tested under some special conditions like $HOME is not set or being provided an invalid .mymysh_history (random order or invalid sequence number, invalid line, ...)? 2. I notice that ~/cs1521/bin/mymysh will also tokenise '\\t', which is the horizontal tab. Are there any other characters that need to be used in tokenise? 3. If I interrupt a command, for example, run `sleep 10' then immediately press Ctrl + c, both sleep and ~cs1521/bin/mymysh will exit. Are we supposed to keep myshsh running when it is running a command and we press Ctrl + c? 4. For the redirection, should we treat the commands like \"cat &lt; *.c\" valid or not if *.c matches exactly 1 file? 5. If I run a command like \"echo abcd &gt; *.txt\" and \"*.txt\" does not match and files, with GLOB_NOCHECK, glob will preserve exactly \"*.txt\" and ~cs1521/bin/mymysh will actually create a file called \"*.txt\". Is this correct or not? 6. Should we print \"Running xxxx ... -------------------- -------------------- Returns xx\" to stdout or stderr? 7. Should the error message printed by our myshsh matches exactly what ~cs1521/bin/mymysh prints? If so, what should be printed if fork(), execve(), malloc(), wait(), etc... fail, since these errors rarely occur. Thanks a lot! ","answers":[" Some of these questions can be answered by \"Do what ~cs1521/bin/mymysh\"does. For those questions, I'll just say \"Follow ~cs1521/bin/mymysh\". 1. Will our program be tested under some special conditions like $HOME is not set or being provided an invalid .mymysh_history (random order or invalid sequence number, invalid line, ...)? No ... they'll be tested under \"normal conditions\". And we're not mean or stupid. If we find that everyone's prrogram is failing because of some assumption we've made, we'll change the tests. 2. I notice that ~/cs1521/bin/mymysh will also tokenise '\\t', which is the horizontal tab. Are there any other characters that need to be used in tokenise? No. It used to tokenise on \" and ' as well, but we stopped doing that a while ago. 3. If I interrupt a command, for example, run `sleep 10' then immediately press Ctrl + c, both sleep and ~cs1521/bin/mymysh will exit. Are we supposed to keep myshsh running when it is running a command and we press Ctrl + c? Follow ~cs1521/bin/mymysh. 4. For the redirection, should we treat the commands like \"cat &lt; *.c\" valid or not if *.c matches exactly 1 file? Follow ~cs1521/bin/mymysh. 5. If I run a command like \"echo abcd &gt; *.txt\" and \"*.txt\" does not match and files, with GLOB_NOCHECK, glob will preserve exactly \"*.txt\" and ~cs1521/bin/mymysh will actually create a file called \"*.txt\". Is this correct or not? Follow ~cs1521/bin/mymysh. 6. Should we print \"Running xxxx ... -------------------- -------------------- Returns xx\" to stdout or stderr? stdout (i.e. Follow ~cs1521/bin/mymysh) 7. Should the error message printed by our myshsh matches exactly what ~cs1521/bin/mymysh prints? If so, what should be printed if fork(), execve(), malloc(), wait(), etc... fail, since these errors rarely occur. You can assume that fork(), malloc(), wait() won't fail. They won't fail during our testing. You can test an execve() failure easily enough, to see what ~cs1521/bin/mymysh does. It would have been useful to ask these kinds of questions two weeks ago, in the period when we were tightening the spec. Too late to change it now. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Do we need to handle '&gt;' and '&lt;' in the command? something like &lt; command.txt &gt; output.txt? In the spec it says having &gt; or &lt; anywhere but the 2nd last token in the line should result in an error but I've been seeing posts that include it. ","answers":[" No command to mymysh should contain both &lt; and &gt; The posts you've been seeing are talking about running mymysh from bash (the real shell) and capturing mymysh 's output. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" when i used the glob() to do the file expansion, i don't know why sometimes an empty space or a messy code start on my buffer[MAXLINE]. Please help me to find out . Thank you ","answers":[" It is impossible to diagnose your problem effectively with this much information. Note that the expanded filenames don't need to go into the command line buffer anyway. They should be added as extra tokens into your tokens array. The *.c should remain in the command like buffer and be stored in the history list. Perhaps you could use gdb to track how the values of tokens[0] (or whatever you call you array of tokens) changes during the execution of your code that does the glob() expansion. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hi! Should we get rid of the if DEBUG region in the base code for the assignment? ","answers":[" Edit the Makefile and use a version of CFLAGS that doesn't have -DDBUG in it. And then ... make clean; make ",[" But for final submission, does it matter whether we keep the debug portion in, or should we remove it? ",[" We're suppliying the Makefile for auto-testing. We won't run with debugging on. If you add your own debugging output, remove it before submission, or wrap it in #ifdef DBUG ... #endif "]]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hi, I'm experiencing issues with the cat command printing output in different order When I run the command \"cat *.h &gt;&gt; abc\" using ~cs1521/bin/mymysh I get this: However, when I run using ./mymysh i get: The two lines \"cat: &gt;&gt;: No such file or directory\" and \"cat: abc: No such file or directory\" are being printed before the .h file in my program but after the .h file in the sample shell. Is there any way to fix this? ","answers":[" mymysh doesn't handle &gt;&gt; It's producing the correct response in this case. "," It looks like you convert “cat *.h &gt;&gt; abc” to “cat &gt;&gt; abc history.h”. When you expand wildcards, you should expand in place. Hence it should be converted to “cat history.h &gt;&gt; abc” "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hey. I was wondering why my file name expansion function did not expand the tilde wild card properly. All the other wildcards seem to work. Thanks. ","answers":[" This is what my program/terminal displays: ",[" The man page for glob explains the different options that can be used with it. I think you'll find your answer there. ",[" Yep consider what Simon said and also consider the hint in the assignment “(hint: use GLOB_NOCHECK|GLOB_TILDE as the second parameter of the glob() function)”” "]]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hello, As per the spec, I am compiling under dcc. I have compiled the provided (template) mymysh.c file and receive the following error during runtime: mymysh.c:59 runtime error - illegal array, pointer or other operation Execution stopped here in main() in mymysh.c at line 59: //if (envp[0] != NULL) //{ --&gt;for (i = 0; envp[i] != NULL; i++) { if (strncmp(envp[i], \"PATH=\", 5) == 0) break; } Values when execution stopped: i = 0 envp[i] = \"\" This error does not happen with gcc. Is there a workaround for this? Thanks, ","answers":[" As per the spec, I am compiling under dcc. That was a typo in the spec. It should have been gcc . And the Makefile uses gcc . I can't see why dcc should be complaining. I'd need to see the rest of your code. ",[" I have the same issue but it occurs when i run the shell. I've tried recompiling using both dcc and gcc but same error occurs ",[" As I said, I'd need to see the rest of the code to see what you've done wrong with envp[ ], which is the most likely cause of such an error. "]]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hi, I'm currently trying to replace the ~ token with the result from glob(). EDIT : Removed code. Left what was most needed for the question. glob_t result; int i; printf(\"Found a tilde\\n\"); printf(\"Corresponds to: %s\\n\", *result.gl_pathv); strcpy(tokens[i], *result.gl_pathv); I had thought that a simple strcpy(tokens[i], *result.gl_pathv) would be fine to pass the value across to replace the tilde with the path to the home directory. I had thought this would be fine as the space has already been malloced from the tokenise() function. However, I'm receiving errors related to illegal array, pointer or other operation. Could someone please explaing to me what I'm not understanding here. I have also tried using array elements. E.g. strcpy(tokens[0], result.gl_pathv[0]); strcpy(&amp;tokens[0], result.gl_pathv[0]) Thank you for any help. ","answers":[" Hey Joe, not sure but maybe when tokens was malloc'd the amount of space allocated is less than you need to copy the expanded HOME directory into the same location. You could maybe create your own char ** array and malloc it to copy the strings from result.gl_pathv or maybe pass the actual result struct itself back to main and read through the expanded paths in result.gl_pathv. This would require a bit of tweaking though as the result.gl_pathv array doesn't hold the executable name and any of switches that execve needs so it needs to be massaged a bit to work. Using GLOB_DOOFFS with glob allows x number of slots to be left available at the beginning where other strings could be copied to. i.e. executable name. ",[" Thanks for that Simon. "]," Please remove your code from the forum. If you need to share code please do it by email. The problem is size expanding a ~ results in a much larger string than what you started with and tokens[0] hasn't got the space for it. You could either: 1. Realloc tokens[0] 2. Free tokens[0] then strdup into it 3. Free tokens[0] then assign it as a pointer. ",[" Sorry Dylan. Have removed the code and left what is needed for the question to make sense. Let me know if I need to remove that too. I'll give your suggestions a try. Thanks "]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hi, I am having trouble with the char **glob_command array I am using within the fileNameExpand() function to hold the (possibly larger) list of tokens to return back to main for execution. I can't seem to populate it with more than two string elements. I malloc the array as below based on the number of expanded paths in the paths struct after globbing plus the number of switch arguments identified in tokens (args starting with '-') plus an extra element to hold the command being executed. I have confirmed the values used to calculate glob_command_size are correct while debugging this. char **glob_command; glob_command_size = paths.gl_pathc + switch_count + 1; glob_command = malloc(glob_command_size*sizeof(char *)); I am testing with a command such as \"ls -l -a *\" (intentionally with multiple switch arguments) and I am able to copy the first string (the command) from tokens to glob_command strcpy(glob_command[0], tokens[0]); Debugging output from above command was: glob_command[0] is now ls But when I then use a loop to copy all switch arguments starting with '-' from tokens to glob_command I can only copy one string before the function breaks: for ( i = 1 , j = 1 ; tokens[i] != NULL ; i++){ printf(\"Current j is %d and i is %d\\n\", j , i); printf(\"Current tokens[%d] %s\\n\", i,tokens[i]); if (tokens[i][0] == '-'){ printf(\" Found switch\\n\"); strcpy(glob_command[j], tokens[i]); printf(\" Copied switch %s\\n\", tokens[i]); printf(\" glob_command[%d] is now %s\\n\", i , glob_command[i]); j++; } } I have performed debugging by adding print statements and can confirm the second switch (-a) argument in the command \"ls -l -a *\" is matched by the the line \"if (tokens[i][0] == '-')\" but the strcpy function following that condition statement fails. glob_command[0] is now ls Current j is 1 and i is 1 Current tokens[1] -l Found switch Copied switch -l glob_command[1] is now -l Current j is 2 and i is 2 Current tokens[2] -a Found switch -------------------- Returns 0 mymysh$ As part of my troubleshooting after mallocing glob_command I printed its content expecting all strings in the array to be (null) but found the first two seemed to hold garbage as shown below and I am not sure if this is related to why I can only copy two strings (the command to execute and the first matched switch argument) to it or not: glob_command[0] is hD X X X à'w÷à'w÷è'w÷è'w÷ð'w÷ð'w÷ø'w÷ø'w÷ glob_command[1] is hD X X X à'w÷à'w÷è'w÷è'w÷ð'w÷ð'w÷ø'w÷ø'w÷ glob_command[2] is (null) glob_command[3] is (null) glob_command[4] is (null) glob_command[5] is (null) glob_command[6] is (null) glob_command[7] is (null) glob_command[8] is (null) glob_command[9] is (null) glob_command[10] is (null) glob_command[11] is (null) glob_command[12] is (null) glob_command[13] is (null) glob_command[14] is (null) glob_command[15] is (null) glob_command[16] is (null) glob_command[17] is (null) glob_command[18] is (null) glob_command[19] is (null) I think the issue has something to do with memory allocation but I can't work out why the above for loop fails when trying to added a third element to the glob_command array. Can anyone shed any light on this for me? ","answers":[" The problem your having is how to alloc a 2D array. Glob_commands is an array of pointers but but each element of the array also needs to be alloced as an array of chars. Now fileNameExpand() takes a char** so you can pass tokens directly into it, and if you give glob the GLOB_NOCHECK flag glob will do all if this for you as glob mallocs the strings it returns. ",[" So do I need to malloc within a loop? First mallocing the outer array and then traversing through it to malloc each inner array? ",[" For a array of strings, normally, yes. but the strings returned from glob are already malloced so you shouldnt need to. ",[" Thanks Dylan, I was original using the array within the glob struct but it seemed a bit fiddly as I needed to use realloc to get it working properly so I decided to rewrite this section by copying the content out of the glob output into a char ** array. I seemed to have got it working now though. Thanks for your help. "]]]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Permission denied with open( , O_CREAT) Hi, I was trying to use open(\"outputFileName\", O_CREAT) to have a output file to redirect. But by perror, it showed \"Permission denied\". The file was created, but showed \"Permission denied\" again when using cat command to inspect this file. How could this be solved? Thank you in advance!!! ","answers":[" I am still trying to perfect file output redirection myself but I think you'll find you need to tweak your permission flags when calling open(). have a look at 'man 2 open' and there are a bunch of options you can use with O_CREATE to set the permissions on the file you create. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" When I run the special notation for re-executes the previous command with additional strings behind (for example: \"!!sfihkdff\" ) in the ~cs1521/bin/mymysh shell, it still re-executes the previous command. However from the linux bash command, it doesn't execute the previous coommand and shows \"bash: sfihkdff: command not found\". So for this assignment which spec should I follow? ","answers":[" mymysh isn't bash, you should stick with the example and just ignore everythong folloing \"!!\". "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" When I run ~cs1521/bin/mymysh with \"cd\" it automatically cd home, but this feature is not the spec, should we modify this feature in our code? ","answers":[" Your shell should do this yes. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" For some reason the return status of my child process is always 256 times larger than that of the reference soln. Is it safe to just divide mine by 256 or will that potentially cause problems later? Reference soln My soln ","answers":[" you need to use the WEXITSTATUS function described by man 2 wait ",[" Ahh I see. Thanks "]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Is cleanCommandHistory() needed if I free() allocated memory as I go along in my other history functions? Or is it recommended to write the free()s for cleanCommandHistory() to make it easier when marking memory leaks? ","answers":[]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hi, The example mymysh returns No command X for X at a sequence number 20 less than the highest sequence number. However, for my history file, I have saved all historical commands such that !1 to !999 can all be accessed providing they exist. Do I have to make them not exist for MAX - 20. Furthermore, is it possible to create a differently named history file such as .mymysh_history New so that if prior versions of the history file with invalid syntax exists, it does not effect your code? Thanks. ","answers":[" The internal history and the history file should both only have a max of MAXHIST(20) items in them. history shouldn't stop at 999 either, any positive integer should work. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hi, I keep getting this error. I've commented some parts of my code out and it runs fine if i comment out my initcommandhistory function. ","answers":[" You are trying to free unallocated memory. run gdb or valgrind to find where. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hi, When I was running ~cs1521/bin/mymysh &lt; command.txt &gt; exp , for (wc *.*) command I found error message \"Input redirection: No such file or directory\" will be printed in terminal but not exp file, all other message printed in file except this I have no idea about when it should be printed in terminal rather than in file, can I get some hint about it? ","answers":[" If you want to capture all of the output from mymysh , try the command: ~cs1521/bin/mymysh &lt; command.txt &gt; exp 2&gt;&amp;1 "," Looks like that message is being printed to stderr not stdout. This is because this error is produced by perror not printf. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" When I run ./mymysh &lt; test0 &gt; myout where test0 has cat &lt; doesntexist.c My program will have \"Input redirection: No such file or directory\" in the myout file. With the sample solution, the out file doesn't have it, but instead prints it to stdout. I have tried moving the printing of the error message inside the fork and outside but still doesn't reproduce the output of the sample solution. Also, When I run cd ~ On my solution I get: /import/glass/2/z5112735 On the sample solution I get: /tmp_amd/glass/export/glass/2/z5112735 Is this difference significant? ","answers":[" On my solution I get: /import/glass/2/z5112735 On the sample solution I get: /tmp_amd/glass/export/glass/2/z5112735 Is this difference significant? Did you run both commands on the same machine? ",[" I ran it on the same machine but I had opened two terminal windows ",[" Were the shells in both windows running on the same machine? In any case, the difference doesn't matter. ",[" Yes, the shells were running on the same machine. I tried it again with just one terminal and ran the same tests. The only difference was once again the result of cd ~. Surprisingly, when I cd ~ in my own shell, and then pwd, the directory printed is /tmp_amd/glass/export/glass/2/z5112735. So the only time I get the weird /import/glass/2/z5112735 is the result after calling the cd ~ command I assume from what you're saying that this difference won't affect the autotesting of my shell then? "]]]," If the redirect isn't working on the sample then the sample is printing to stderr. You should end up in the same place. How are you getting the home directory? ",[" They both seem to be the home directory (ls providers the same result) . i used the following command to goto home Chdir(getenv(\"HOME\")) "]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Running make produces very strange errors which I don't understand nor know how to fix: The white text is a CSE machine and the green text is my mac. I have #included history.h in mymysh.c and in history.c, so I am not sure what the issue is. PLS help ","answers":[" Why do you have a main() function in history.o ? To me, it looks like an issue with your history.o Have you tried make clean and then make ? ",[" I had copy and pasted mymysh.c into history.c ... (*facepalm*) "]," #include \"history.h\" included in both files mymysh.c &amp; history.c // Otherwise, you might need to download all the new files again. Hope it helps mate. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Couple question about the sample shell： 1. Redirect input/output is not working for the build-in command (pwd, history) in the sample shell, but it is working for the normal shell in the linux system. So I choose to stick with the normal shell of Linux, Is that ok? 2. In the sample shell provided, for command like ls &gt; abc, since the stdout is redirect to the file, part of command like \"Running xxxxxxx... ---------------------------\" is also being redirected to the file as well, so the stdout of the command left to be half of the \"-------------------\" line and the return value, which looks weird to me. So instead, in my own shell, I preserve the whole \"running----\" part , and only redirect the part that is produced by the command to the file, is it okay to do that? ","answers":[" So I choose to stick with the normal shell of Linux, Is that ok? No. The spec asked you to implement a clone of the reference shell, not a clone of the real shell. "," redirection should not work for Inbuilts, it's in the spec. Only the outup of the command itself should be redirected, that's a bug in the example. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hi, My code works well on terminal, but when I am trying to put the output to file(out.obs), it have different output from what I have in terminal, I can not figure out why. Can I get some hint on that? ","answers":[" ls output output one file per line when not outputting to a terminal. This is intended behavior. The order is wrong because of buffering but this is the correct output for this assessment and the example program does the same. ",[" This is what my program ptint ",[" But my file even not print Running /bin/ls ... -------------------- Makefile b.txt cmd.txt history.h mymysh mymysh.o out.obs a.txt c.txt history.c history.o mymysh.c out.exp these lines which suppose to be printed. It works well in terminal I have no idea why it does not work when print to a file "]],[" But my file even not print Running /bin/ls ... -------------------- Makefile b.txt cmd.txt history.h mymysh mymysh.o out.obs a.txt c.txt history.c history.o mymysh.c out.exp these lines which suppose to be printed. It works well in terminal I have no idea why it does not work when print to a file ",[" ok so only two lines are missing Running... And --------------------- This could be because your printing this inside the fork not before it. Other than that I would need to see your code. ",[" Yes I do it inside the fork, so we must do it before the fork? But these things listed must be inside the fork(print by execve function) Makefile b.txt cmd.txt history.h mymysh mymysh.o out.obs a.txt c.txt history.c history.o mymysh.c out.exp So how can we print that before fork()? I miss them as well ",[" That is printed by ls and is being printed. At the top of the file, one line for each item. And that is expected. ",[" Thank you very much Dylan. I just have another 2 questions. 1.when we use history command the definitly $ ~cs1521/bin/mymysh will behave different from our owns. since the command stored in txt file is different. And that does not matter right?? 2. the struct returned in glob() function are different for mac and cse serve one(according to man), I search on google, almost all answers follows the mac one rather than cse one, do we need to use the cse one and will the test run in this environment? ",[" I don't quite understand your first question. You program needs to run on cse. Use man in the cse server as your guide to glob(). ",[" when we use ./mymysh &lt; command.txt &gt; out.obs ~cs1521/bin/mymysh &lt; command.txt &gt; out.exp diff out.obs out.exp command to check whether out output is same as the ~cs1521/bin/mymysh, all other command will be fine exccept the \"h\" or \"history\" command, The output for these two will be different since they have different history and create .mymysh_history file in different place so that is supposed to happen and does not matter right? Thank you in advance! ",[" The history file is the same so that's not a problem, the shell never prints its own path so that shouldn't be a problem either. ",[" but when testing by ./mymysh &lt; command.txt &gt; out.obs ~cs1521/bin/mymysh &lt; command.txt &gt; out.exp diff out.obs out.exp they will not run at the same time, so when we first run ./mymysh some history recorded and when we start to run ~cs1521/bin/mymysh, some history have already recorded in the history file, so if we run \"h\" command, will we have different result? Thank you in advance "]]]]]]]]]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" when i run ./mymysh on terminal it returns No such file or directory can someone tell me why that happened please? ","answers":[" you need to run make first. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" For redirect part, we only need to handle \"&lt;\" and \"&gt;\" (write to/read from) We do not need to handle something like \"&gt;&gt;\"(append) right? Thank you in advance! ","answers":[" you don't need to handle append no. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Can we make a copy of the trim () function in history.c? ","answers":[" Definitely. Although as the history lines are in a known format you don't necessarily need it. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" When I type into the given mymysh: I get the .c files printed to terminal as well as some random symbols. I'm assuming this is a bug, so should the correct output be 'Invalid i/o redirection'? ","answers":[" &gt;&gt; isn't a recognized symbol so it is just passed to cat as a file name. ",[" O, Thank you ! "]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Should the sequence number still increment with an invalid command, even if it is not saved to history? I had assumed not but have just realised I'm not sure, and this would definitely cause problems with my current implementation. ","answers":[" I believe an invalid command does not increment the sequence number as it's not placed into history. You can check with the testing shell at ~cs1521/bin/mymysh "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" what would be the directory that contains the \".mymysh_history\" file, i tried using \"$HOME/HISTFILE\" but nothing seems to be created after i used the \"ls -a\" command in the home directory. are we supposed to use \"~/HISTFILE\" or something else instead? Thanks! ","answers":[" in your cse terminal, type cd , then pwd , that should be your HOME directory. Otherwise, you can use this command to print out your HOME directory printf(\"your $HOME is : %s\\n\", getenv(\"HOME\")); ",[" Got it, thanks!! "]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" When I try to run my shell with an input redirection (these problems don't exist when I run the shell and type commands in), e.g. ./mymysh &lt; test The shell prompt gets randomly printed as seen in the mymysh$ right before the second set of lines for each call (I read something online about needing to fflush stdout before forking to fix this). Furthermore, when I try to then output redirect e.g. ./mymysh &lt; test &gt; a Not only are the lines jumbled (similar to a previous forum post) but I'm also missing the \"mymysh$ Running xxx...\" as well as the first set of \"--------\". Any help on this problem would be much appreciated. ","answers":[" are you printing Running ... and --------- inside your fork? If so then that's your second problem. Moving all prints before the fork will probably fix the first problem too. ",[" yep that fixed it, why does it not work as expected when we print inside the fork? "]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" For the read and write execute commands section, the spec says \"Before the command it should show the full pathname of the command executable\" For a relative path ie ./test, should it show that, or the absolute path? ","answers":[" If it requires a PATH search then you print the full path. if you are given a relative path, ie. starts with \"~\", \".\", or \"/\", then just print it as is. ",[" Just on this point, wouldn't something starting with \"/\" be an absolute path, not a relative path. Would it be more correct to say that in the case of this particular requirement of the assignment that a relative path is something that either starts with \".\" or \"~\" or contains, but doesn't start with, an \"/\"? I am trying to clarify this so also I can be sure I achieve the correct outcome here. Thanks ",[" True. If you are given a relative or absolute path, print what your given. If you need to search PATH, ie you'r given a command name only eg 'cat' then print the full path. ",[" Thanks for the clarification. "]]]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hi, is there some simple way to make execve function fail? I want to test that case. ","answers":[" Try to run a normal text file with the executable bit set. chmod u+x file.txt ",[" Do you mean this? It seems like running well. ",[" Dylan meant ... try to execute the file whose mode you changed ... try running file.txt ",[" Hi, when I run that, mysh got error message \"Exec format error\", but sample got \"unknow type of executable\" I got the message from errno, I have no idea about how to get the same error as sample ",[" By the way, what number should I return when execve fail? I did exit(errno), should I do this? ",[" The error is manually printed. exit(255) "]]],[" Oh yeah, I got it!! Thank you! "]]]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hi. When I run command such as \"ls *c\" or \"ls *.c\", print out also \"ls: cannot access *.c: no such file or dicrectory\". Can anyone help me please? picture below. Thanks ","answers":[" are you using the glob() function to expand *.c ? ",[" yes Dylan, ",[" Are you inserting the expanded file names back into the token string in place of *c and *.c before execve 'ing the ls command? ",[" I have inserted the expanded file name command after execve the ls command. But I still get the same problem. Thank you. :) ",[" You're clearly not inserting the glob results into the token string, because the command line arg you pass to ls is *.c What you should be passing as args to ls is glob.c history.c mymysh.c ... etc. "]]]]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" For history.c, are we allowed to change the arguments for some functions? Since if I change the arguments for some functions, I need to change the history.h file as well. Is that allowed? Thanks in advance! ","answers":[" As you give history.h you can modify anything in either file. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hi, I get something like this in $ ~cs1521/bin/mymysh as well as my own program. So this is acceptance right? (If there is no '\\n' at the end of the file it will looks like it) ","answers":[" this just means the file is incorrectly formatted. This is the intended output. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" When running the reference solution and redirecting the output to a file, should the order of the output be changed? ","answers":[" are you outputting anything to stderr? sorry this is the referance. Idealy this probably shouldn't happen. It has to do with buffering. 'ls' is smart and knows then its outputting to a file and changes how it outputs, mymysh isn't that smart. There is a work around but it's complicated and uncomfortable. ",[" Hey I'm still confused about what is expected for testing. For example: test02 ls &gt; xyz cat &lt; xyz rm xyz On cse machine: $ ./mymysh &lt; test02 &gt; myout $ ~cs1521/bin/mymysh &lt; test02 &gt; theirout myout: mymysh$ Running /bin/ls ... -------------------- -------------------- Returns 0 mymysh$ Running /bin/cat ... -------------------- Makefile history.c history.h history.o mymysh mymysh.c mymysh.o myout test01 test02 test02&amp; testdir testhist testhist.c theirout xyz -------------------- Returns 0 mymysh$ Running /bin/rm ... -------------------- -------------------- Returns 0 mymysh$ mymysh$ theirout: Makefile history.c history.h history.o mymysh mymysh.c mymysh.o myout test01 test02 test02&amp; testdir testhist testhist.c theirout xyz mymysh$ Running /bin/ls ... -------------------- -------------------- Returns 0 mymysh$ Running /bin/cat ... -------------------- -------------------- Returns 0 mymysh$ Running /bin/rm ... -------------------- -------------------- Returns 0 mymysh$ mymysh$ As you can see the output of ls is written to the file at different times. Does this mean I'll lose marks on the autotests? Should I change my program so that it behaves the same as the model solution shell at all times, include output redirection of this form? ",[" Your output is in the correct place so you won't lose marks. The example output is what I would expect because of buffering, how did you fix that issue? ",[" I got this output by using fflush(stdout) immediately after any text is written to stdout during the execution of main(). Is that OK? ",[" Don't fflush. You are circumventing the buffering being done. The out of order order of output is expected when mymysh is redirected to a file. ",[" Gotcha, thanks "]]]]],[" Also not that 'ls' has different formatting when redirection to a file as well. "],[" A fix for this on your end it to run: stdbuf -i0 -o0 -e0 ~cs1521/bin/mymysh &lt;etc&gt; ",[" Should we use this to run both the reference and our solution when redirecting the output to a file for testing? ",[" If your running for testing don't use it. If your savings a session for debugging or just to look at then do. "]]],[" only if malloc/fopen fails etc ",[" see my edit. "]]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hi, The trim() function is currently breaking when I enter no text (i.e. no characters or a string of spaces) as the last value moves to an illegal array index, i.e. last = -1. I should mention that this only occurs when compiling with DCC. GCC does not pick this up. I should note that I'm running DCC locally rather than on the CSE machines due to the issue with the new C libraries breaking DCC. My question is, is this considered acceptable behaviour seeing as GCC allows it and I get the desired outcome? Or should I be editing the provided trim() function to check for this? Alternatively, should I be checking for this before the trim() function is called. Ideally I would like the trim function to deal with all of this. EDIT: I would like to keep using DCC as its error checking is really useful so I would ideally like to resolve this within the code. Thanks, Joe ","answers":[" This is a bug with trim(). You can fix the trim() function in your code to keep dcc quiet. That won't break auto-testing after you submit. ",[" Thank you. "]]},null,null,null,null,null,null,null,null,null,null,null,null,null,{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Is it okay to leave cleanCommandHistory empty as it doesn't need to be freed? ","answers":[" clearCommandHistory needs to be implemented. ",[" but what should i put in if the data structure i implemented doesn't need to be freed? ",[" the data structure will need to be freed as you are storing strings. ",[" but since u offered MAXSTR so it can be declare in fixed size as a global temporary variable, like this: typedef struct _history_entry { int seqNumber; char commandLine[MAXSTR]; } HistoryEntry; typedef struct _history_list { int nEntries; int end; HistoryEntry commands[MAXHIST]; } HistoryList; HistoryList CommandHistory; ",[" ok, in that case you don't need a clearCommandHistory. ",[" thanks! i'll just leave a comment then "]]]]]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hi, did we have to implement a way to directly call \"clearCommandHistory\"? ","answers":[" clear command history is only used to free the memory used by the history struct just before exit. ",[" So we didn't have toimplement a way for the user to clear the mymysh_history file? ",[" if the user wants to clear the file they can rm it. No call to clearCommandHistory can be made by the user. "]]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" How to pass command to execve's second parameter? Hi, I'm trying to solve !SeqNo with execve, hisArg here is the corresponding history command. But execve seems only start another mymysh process, which doesn't take in hisArg as the command. So how could I let mymysh in the execve function run the command I specified (hisArg)? If this is not the way we handle !, may I have a hint about it? Thanks in advance!!! ","answers":[" The command you want to execve is hisArg[0] as that is the name of the program. Also there are two errors in the tokens line you need to fix. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hey. I was wondering whether it is 'ohkay' for my history entries to start from 0 instead of 1. thanks. ","answers":[" No "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hello, I think give cs1521 ass2 mymysh.c history.h history.c has a typo - from what I see it that should say assign2 ","answers":[" Yep should be give cs1521 assign2 mymysh.c history.h history.c "," Yes I just had the same thought this afternoon. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" File not saving Hi, the assignment spec says to save the history into a file $HOME/.mymysh_history, however, when I try to use ~./mymysh_history as the filename, fopen is returning NULL. I am not sure why this is the case. How should I be creating/saving the file? ","answers":[" You can't use \"~\" inside C programs. It is interpreted by the shell. You'll need to work out the full path name of the directory using the HOME environment variable. (It's in envp[ ] or you can read up on the getenv() library function). You can assume that this environment variable always has a value. ",[" Ahh I see, thank you I didn't know that. I tried to get the full path name and then append .mymysh_history onto it using strcat(strcpy(fileName, getenv(\"HOME\")), HISTFILE) but I was still receiving NULL which is why I resorted to trying to use ~. Am I using the function incorrectly? ",[" As long as fileName is malloced large enough that looks correct. ",[" I increased the size of my char buffer however it still doesn't seem to be working The print statement for the path prints: /import/glass/2/z5025097.mymysh_history and the \"Saved\" message doesn't print so I believe the file isn't being created. Any suggestions on what else might have gone wrong? ",[" The problem is that you haven't got a '/' between the path and the file. ",[" Thank you so much! "]]]]]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" What error message shall I print if the first command ever exit is a !! ","answers":[" Check the example, rm ~/.mymysh_history start 1521 mymysh and run !! As the first command. ",[" Shall I include the space in the ~/(space).mymysh_history ? ",[" I don't think I added a space, but no there shouldn't be a space. "]]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" I have been reading previous posts about the showCommandHistory and saveCommandHistory functions and am still somewhat confused. I know we can use these or write our own if we want but given they are in the skeleton program files I figure I should try and use them unless I come up with a reason why not to. Maybe my confusion is around their names. Unintuitively to me, the showCommandHistory function takes a FD to output/save to where the saveCommandHistory function does not though it seems to be it should the other way around based on the function names. Previous posts mention showCommandHistory should be called from saveCommandHistory but the assignment specs to me imply the saveCommandHistory function is only called on exiting the shell to write the history to file. showCommandHistory on the other hand could need to be called many times (when h/history is typed into the shell) before exit so calling it from saveCommandHistory on exit doesn't seem logical. Is there something I am missing with my understanding of these two functions as at the moment I am not any clearer on their interaction and operation. Thanks ","answers":[" SaveCommandHistory can save by showing the command history to a file instead of the stdout. ",[" Thanks Dylan, so it would seem to me that the prototype for SaveCommandHistory would need to be modified to receive input to indicate if it should save to file or call showCommandHistory and have it output to stdout. The original function it doesn't take an argument but I think that would need to change to work as describe. ",[" saveCommandHistory() always writes to ~/.mymysh_history, which is why it doesn't need an argument. showCommandHistory() sends the history list \"somewhere\" ... the somewhere has to be indicated via an argument. Maybe the name showCommandHistory() suggests that it's going to display it to the screen, but that's not the intention. Maybe the name writeCommandHistory() would have been better ... or not ... then you'd probably complain that it gave the impression that it was meant to go to a file ... ",[" \"then you'd probably complain\"? It was a question, not a complaint, and I think a valid one. ",[" Hi Simon, jas was just giving a catch 22 statement :P Basically, the showCommandHistory() function puts its output into the file pointer argument it was given "]]]]]},null,null,{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" cmdNo = initCommandHistory(); I am not quite sure about the purpose of cmdNo variable in main(). Which int Value the initCommandHistory() should return? And what is cmdNo used for? Can someone explain about it for me? Thanks ","answers":[" initCommandHistory() returns the smallest number greater than any previous history number. Eg. If you have a history file that has 12 commands numbered 1-12 then 13 will be returned. If you load a history file that has 20 commands numbered 46-65 then 66 will be returned. If no history file is found then 1 is returned. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Do we need to handle \" symbols? The sample seems to separate tokens on \" as well as space. ","answers":[" Dylan's right. Quotes are not treated specially. I'm sure I addressed this somewhere (maybe another comment thread, but I'm surprised it's not somewhere in the spec). ",[" The problem is that quotes are treated special, they are removed. Entering mymysh$ cat \"text file\" Will actually run cat text file "]," I believe the sample is incorrect. The spec doesn't note any special behavior for \" or ' So \" is handled like any other character. "]},null,null,null,null,null,null,null,{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" For saving history part, we are asked to save the history in $HOME/.mymysh_history. I'm quite confused about the dot after '/'. What does that dot stand for? I made a small program trying to create a file without the dot and it works, and the file can't be created if the file name starting with a dot. ","answers":[" You might think it didn't work because it's hidden: run 'ls -A' to view hidden files as well. "," A dot file is a hidden file on a linux system. A file starting with a dot definitely can be created in c. ",[" Ok, that makes sense. Thank you very much! "]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Are we allowed to modify the provided function prototypes? ","answers":[" There are no mandatory functions in the spec, go for it. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hi, I'm a bit confused about error handling. It says that, If the file does not exist, or is not readable, that is an error. Having &lt; as the last token, or elsewhere in the command-line is also an error. So if there is an error, should we just print the error message and continue the while loop or just stop the mymysh? If print message, what function should we use? perror? Thank you!! ","answers":[" Unless you encounter an unrecoverable error, like malloc running out of memory, you should continue the while loop, but print an message. You can only use perrot is a syscall fails, otherwise use fprintf. ",[" Why should we use fprintf? Can we just use printf? ",[" If you want to output to stderr then you need to use fprintf. It's not mandatory but in extream debugging cases it can help having errors separate. "]],[" Hi, I wonder if we can use perror. If not, why? ",[" perror reports an error if errno is set. Errno is set by a failed system call. A System call is anything in man 2. Read the man page of functions and if they say \"on error return -1 and set errno.\" Then you can use perror immediately after to report an error. Otherwise use fprintf. "]]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Just in case anyone else freaks out, I think dcc might be segfaulting everything at the moment? ","answers":[" yes as well as valgrind. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Is the valgrind (as well as dcc and dcc --leak-check) in vlab broken? Now even when I try to printf(\"hello\\n\"). when I run valgrind ./hello it says some uninitialized memory access. ","answers":[" don't use valgrind and dcc together they do the same thing. Use dcc for run time checks then gcc and valgrind for a final profiling. ",[" But I still believe something wrong with valgrind, since when I run this simple program with gcc + valgrind the reaction is unbelievable. And now when I run all my previous programs with valgrind the same error message will occur "]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" for pwd, can we assume the cwd is MAXLINE (200 chars) long? ","answers":[" Read the man page on getcwd. It tells you about size. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" I've been stuck on this error when I compile. I'm not quite sure what the error is telling me. ","answers":[" You have included unistd.h in mymysh.c but using chdir in history.c so it needs to be included there too. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Do the errors we create (such as \"Invalid i/o redirection\" and \"Command not found\") go to stdout or stderr? I believe the model solution sends them to stdout so that's what I've done, but I feel like they should go to stderr. ","answers":[" As long as the error is the same the output stream dosen't matter, stdout and steer can be merged later. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hi this is about displaying the history of file expansion, my code displayed: The official code displays: Does this count as inconsistent output? ","answers":[" If the example saves the command as it was before globbing so should you. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" In a dir with multiple .c files I execute the following with the model solution shell: mymysh$ wc *.c &gt; xyz Invalid i/o redirection Is this intended behaviour? Confused because the model shell doesn't complain about this: mymysh$ wc mymysh.c testhist.c &gt; xyz Running /usr/bin/wc ... -------------------- -------------------- Returns 0 ","answers":[" A glob pattern before a redirection is allowed. The model solution is incorrect. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Do we get marked down if we got memory leaks? ","answers":[" Only if the reference mymysh has no memory leaks. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hi I also wonder if there is a error why sometimes the program return 1 and sometimes the program return 2. what is the difference between them? Thanks! ","answers":[" The printed return value should be returned by the executing process. What the actual values is changes depending on the program. ",[" Is the value get from wait()? But my program get different value to the ~cs1521/bin/mymysh one. it will have some value like 11 or 512 rather than 1 or 2 ",[" The spec tells you how to do this (WEXITSTATUS) ",[" Thank you very much and I have another question. For redirect files,If we have a pattern match (eg cat &lt; *.txt) As I was told before it should return an error message, but I have tried the ~cs1521/bin/mymysh it will not return an error but process it with the file file matched So should we print a error message or not. If so, what message should we print ",[" If *.txt expands to more than one file name, it should complain. ~cs1521/bin/mymysh is currently doing it wrong. It should be treated as if you had done cat &lt; a.txt b.txt The error message should be \"Invalid i/o redirection\" ",[" so will it(eg. cat&lt;*.txt) be recorded in history or not ",[" only valid commands are recorded. 'Cat &lt; *.txt' Is valid if it expands to only one file, and is invalid if it expands to multiple. "]]]]]]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hi, I wonder can we have some autotest to make sure we do not have silly mistakes including format(\\n,space...) Thank you in advance! ","answers":[" Once I've finished writing an assignment for my other course, I'll put up some testing stuff. However, but this stage, you ought to be able to do testing yourself ... E.g. write a sequence of shell commands in a file, then do something like: ./mymysh &lt; FileOfCommands &gt; out.obs~cs1521/bin/mymysh &lt; FileOfCommands &gt; out.expdiff out.obs out.exp After all, this is what we do for auto-testing. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hello, two relatively generic questions this time (not asking for details at this stage). 1. Is the I/O redirection any different to the method covered here? https://webcms3.cse.unsw.edu.au/COMP1521/18s2/reso... 2. Seeing as though the command output is only worth 1 mark, is there really any major difference between that and the input case? Thanks in advance ","answers":[" Output redirection is very similar to input redirection, a more accurate marking guild would be 2 marks for either input or output redirection and an additional 1 mark for the other. There is a small difference as you are redirecting from a file to a process not from a process to another process. because of this you don't need pipe()s only dup2()s ",[" Cool, thanks Dylan. Although the spec seems to hint at pipe() (as well as dup2()) though. Was that bit extra or was it for something else? ",[" pipe is only needed for the challenge. ",[" So to clarify do you need to pipe at all or only for output redirection? Oliver. ",[" Pipe is not needed for in/output redirection. "]],[" Ah right. Thanks again for all the hard work answering these questions "]]]," Sorry also: 3. For our purposes, shell commands will never be I/O redirected right? ",[" Inbuilts like cd, history, and pwd will never be redirected. "]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" I think I've gotten my history implementation working, except that when I call getenv(\"HOME\") for a second time (eg to save to the mymysh_history file) it returns a different path to the first time I call it. I use the following code: and call it when opening and when saving the command history file. The first time I run this, homedir is \"/import/ravel/4/zXXXXXXX/\". The second time (when trying to write to history file), homedir is \"/import/ravel/4/zXXXXXXX/.mymysh_history/\". How the heck is that possible? It's almost as if the home environment is being modified during my code execution to become... a random file? Is there any way that could happen? ","answers":[" It's not a random file, that Is the history file. If you are modifying the return of getenv() in place then the next time getenv() is called your modification stays. ",[" So if I change the string that getenv gives to me, it'll change the HOME path too? ",[" Concatenate the history file name on a copy of the HOME env var. ",[" Is there a better way to do that than mallocing a string and strcpy(newString, getenv(\"HOME\"))? Also, when I try to \"cd\" to the HOME, I get a problem that my directory is set at the HOME for the rest of the shell run, regardless of me running \"cd SomewhereElse\". Would that be caused by the same issue of not using a copy of the getenv(\"HOME\") string? ",[" Is there a better way to do that than mallocing a string and strcpy(newString, getenv(\"HOME\"))? No. Why do you think that's not a good way to do it? Assuming you make the buffer big enough (which means malloc'ing strlen + enough to append the name of the history file. ",[" I'm still not used to C string manipulation, so everything looks messy and horrible, and I usually assume there's a better way to do it than I do it. "]]]],[" not quite. The memory location used as the return of getenv() is always the same. If you modify what's at that location you modify what you get back next time. "]]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Extra feature: I've implemented both input and output redirection, however I've also handled the case of both input and output redirection in the same command, e.g wc &lt; infile &gt; outfile . This is how bash/dash etc behave, and more than the spec asks for, will that be a problem? Thanks in advance. ","answers":[" [deleted] ",[" No problem, thanks ",[" It will be a problem if one of our test cases checks for this and expects to see an error. Submit a version that precisely meets the spec. Anything beyond this is a private thing that you can use to impress your tutor. "]]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" HI, is the sequence number and the command number the same thing? or whats the difference between them? Also, initcommandhistory returns an integer, what would it be? Thanks! ","answers":[" Yep, they're the same. InitCommandHistory() returns the first sequence number greater than any already used. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hello, Any advice on testing filename expansion? I know I can do cd ~, ls *.c and ls * on the sample solution but that's the extent of my knowledge. Thanks ","answers":[" have a look at 'man 7 glob' all the examples should work as you are using the glob() function. Also try ~/filename and ~username/filename. "]},null,null,null,null,null,null,{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" clang: error: unable to execute command: Executable \"ld\" doesn't exist! clang: error: linker command failed with exit code 1 (use -v to see invocation) make: *** [mymysh] Error 1 I get this error when i want to submit it, but when i make the file on my own computer it compiles properly. What is this trying to say? ","answers":[" Nothing is wrong with your code. Just wait for the submission to be fixed. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Can we assume the \"&gt;\" or \"&lt;\" is not a valid file name? ","answers":[" You can, yes. "]},null,null,{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hello, Is there some special catering we must do if for some reason our history goes past the 999th command (i.e. into 4 digit numbers)? Thanks in advance ","answers":[" No. Amway use the same format. I doubt that testing will go on long enough for this to matter. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Why doesnt .mymysh_history act like a proper file, i cant fscanf from it or fgets from it even though i cat it, i see theres content ive written on it ","answers":[" the .mymysh_history file needs to be in your home directory as given by the HOME environment variable, if the file is at $HOME/.mymysh_history it also needs to be opened with fopen(\"$HOME/.mymysh_history\", \"r\") BUT $HOME needs to be expanded into a path first. ",[" Where does $HOME come from? What is it? I assume it's some sort of absolute path to the current user's home file, but I don't remember it being covered yet. ",[" You can find it in the environment. ",[" I haven't seen week 9's lectures yet, are environment variables covered there, or somewhere else? ",[" Not sure. They were covered in week08 lab and tute. ",[" IIRC our tute mostly skimmed over them, since we could just pass in the envps we got from main. Is there another source of info for the 1521 course you know of that I could look through? ",[" not really sure, chech week07/08 lecture notes. And also the answers to the week08 tute. Also 'man getenv'. "]]]]]]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" how many of these cd variants do we need to code? I know chdir handles .. for you but some of the others behave rather strangely, cd ~username and straight cd for example. Oliver. ","answers":[" Try them on the provided executable at '1521 mymysh' and see what works and what doesn't. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hello, I deleted a comment on an old post I made because I realised that it doesn't bump it back to the top, so I'm just making a new post. Original discussion: &lt;header&gt; Rui Tong 4 days ago , last modified 4 days ago &lt;/header&gt; I'm currently looking at the showCommandHistory function, and basically I gather that I'm reading from a file pointer (to the .mymysh_history file). Is there really any purpose for doing this? Because when I look at the assignment, I feel like it'd be much simpler to just store everything in the already defined global struct variable \"CommandHistory\", and then read from that instead for the show function. And then call saveCommandHistory before the program quits. Whereas from what I see, in this current implementation every time I want to add to my history, I need to always store it in CommandHistory, and then write it out to .mymysh_history. Which feels like I always need to write to 2 different places at once: the struct AND the file. Thanks. &lt;header&gt; John Shepherd 4 days ago , last modified 4 days ago &lt;/header&gt;showCommandHistory writes to the file handle.This allows you to double up using it interactively (for the h command) and to save the command history to the .mymysh_history fiile.&lt;footer&gt; Reply &lt;/footer&gt; &lt;header&gt; Rui Tong 4 days ago &lt;/header&gt;Hang on, sorry about this Jas but in that case what's the distinguishing factor between showCommandHistory and saveCommandHistory?&lt;footer&gt; Reply Edit Delete &lt;/footer&gt; &lt;header&gt; John Shepherd 4 days ago &lt;/header&gt;saveCommandHistory() could be implemented very easily using showCommandHistory()&lt;footer&gt; Reply &lt;/footer&gt; Deleted reply (sort of): Thanks Jas, Although I'm now wondering about this. From my understanding, I may have misinterpreted, but my understanding is that saveCommandHistory call s showCommandHistory to ensure that showCommandHistory does the writing for me. But if my shell wants to exit now, this is going to be problematic, because the last thing I want is for my shell to print out a history log right before it exits. Is there any way I can overcome this? Thanks ","answers":[" And to clarify any and all functions can be edited, added or removed. Its recommended to call ShowCommandHistory from saveCommandHistory but you don't need to. ",[" Ahh I see your point now. We can send it to stdout or send it to some FILE* we made in save. Thanks Dylan "]," ShowCommandHistory() only outputs to one place. The place given by the FILE* argument. "]},null,null,null,null,null,null,null,null,{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hi! I wonder for void showCommandHistory(FILE *outf) function, if the outs already open? And is what this function does quite similar to void saveCommandHistory Both these 2 functions do is to write the content to the file? Thank you in advance! ","answers":[" void saveCommandHistory() saves the contents of the history structure to the file $HOME/.mymysh_history. This can be done with a call to showCommandHistory void showCommandHistory(FILE *outf) prints the contents of the history structure to a specified file stream outf. ",[" So the file stream 'outf ' have already been opened before it is passed into the function? All I need is to write things to the function? And I do not need to close the file stream inside the function void showCommandHistory(FILE *outf) ? Thank you in advance! ",[" It needs to be opened before the function call, yes. ShowCommandHistory uses the file stream only. "]]," And the contents are the same? ",[" Yes "]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Does the ordering of the commands in the mymysh_history file have to exactly match the ordering when history is displayed? Although individual commands are stored in the same format as when displayed, they happen to be ordered in the reverse order. ","answers":[" The file should be in ascending order, the same as the history command. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Hi! I also wonder what should be returned by int initCommandHistory() is that int nEntries inside the struct? ","answers":[" As I was told the other day, it returns nEntries + 1 , ie. the sequence number of the next command. Thats why its return value is assigned to the variable cmdNo in main(). "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Will ! command change internal order of history? For example, if I have a history recording: 0, cd; 1, ls; 2, cat xxxxx; Then I used !1, which corresponds to 0, cd. Will cd enter the queue so that it looks like: 0,cd; 1, cd ... or keep consistent as before? Thanks in advance!!! ","answers":[" What does ~cs1521/bin/mymysh do? ",[" Sorry, didn't fully read the specification! :( "]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" I have a problem about give why when I run give, it says that Executable 'ld' doesn't exit? I can guarant my code could complie with make. ","answers":[" 'ld' is the program used to combine .o files in your submission by clang. This isn't a problem with your code. It will be fixed soon. ",[" Thanks. "]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" I have a question about the mode of open(*path, MODE). In the redirection part of the assignment if I want to write to a file how can I guarant that I can overwrite everything in the file not just the first few lines ? ","answers":[" open is actually open(*path, flags, mode) read 'man 2 open' for the full list of flags, but the O_TRUNC is one of the flags you need. ",[" Thanks "]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" I have a problem about the execve command. Why after I try to redirect a command I suddenly blow up the disk quota of Vlab. ","answers":[" What command? ",[" execve(ls) and redirect to hello ",[" and after that the folder occupy 60%of my total memory ",[" Any increase in ram should only last for the duration of the ls command, and it should only be a small increase. "]],[" if you don't close() after dup2() correctly then all output can start going to your file. ",[" can the fork blow up memory? I only fork before the actull exe ",[" a fork-bomb can blow up memory, but that requires each forked process to also call fork(). ",[" Yes, I've just fixed the bug which is a fork bomb this morning. But how can I reduce the memory? Currently there's only 1.6 MB in that folder. But the quota is still reach the limit. ",[" memory(ram) or storage(disk)? ",[" I ‘ve already clean up the file during help sessions.thankyou "]]]],[" a fork() will at most double the memory(ram) used. after the exec then you have the memory of that new process instead of a second copy of your own program. "]]]]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" I'm currently looking at the showCommandHistory function, and basically I gather that I'm reading from a file pointer (to the .mymysh_history file). Is there really any purpose for doing this? Because when I look at the assignment, I feel like it'd be much simpler to just store everything in the already defined global struct variable \"CommandHistory\", and then read from that instead for the show function. And then call saveCommandHistory before the program quits. Whereas from what I see, in this current implementation every time I want to add to my history, I need to always store it in CommandHistory, and then write it out to .mymysh_history. Which feels like I always need to write to 2 different places at once: the struct AND the file. Thanks. ","answers":[" showCommandHistory writes to the file handle. This allows you to double up using it interactively (for the h command) and to save the command history to the .mymysh_history fiile. ",[" Hang on, sorry about this Jas but in that case what's the distinguishing factor between showCommandHistory and saveCommandHistory? ",[" saveCommandHistory() could be implemented very easily using showCommandHistory() "]]]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" how can I create the history file in the HOME. Currently when I try open or fopen (HOME/.history) will always fail and error says no such file or director ","answers":[" $HOME is an environment variable that needs to be expanded, either with getenv() or by a search of *envp[]. "]},null,null,null,null,null,null,null,null,null,null,null,null,{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" Should we be using the same error messages provided in the sample program? Or will it be fine if we type our own error messages? ","answers":[" Use the same messages. Including the same spacing and upper/lower-case characters. You can use your own error messages if you don't care about failing auto-testing. "]},{"tags":[{"name":"Forums"},{"name":"Assignments"},{"name":"Assignment 2"},{"name":"Assignment 2 Specification "}],"question":" How should we get the return value from sub-processes? I used WEXITSTATUS on the wstatus given by wait, but this gave 1 for the command \"cat xyz\" (where the file xyz doesn't exist) whereas the sample output and sample executable both show 256 as the output. Should I multiply all return values by 256? ","answers":[" I didn't use WEXITSTATUS ... but I think I should have ... I'll change the executable and the spec to reflect this. "]},null,null,null,null,null,null,null,null,null]}